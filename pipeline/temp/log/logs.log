2025-06-07 06:27:25,057 - INFO - ==================================STARTING EXTRACT DATA=======================================
2025-06-07 06:27:25,384 - INFO - EXTRACT 'public.geolocation' - SUCCESS.
2025-06-07 06:27:25,404 - INFO - EXTRACT 'public.product_category_name_translation' - SUCCESS.
2025-06-07 06:27:25,437 - INFO - EXTRACT 'public.sellers' - SUCCESS.
2025-06-07 06:27:26,277 - INFO - EXTRACT 'public.customers' - SUCCESS.
2025-06-07 06:27:26,840 - INFO - EXTRACT 'public.products' - SUCCESS.
2025-06-07 06:27:28,142 - INFO - EXTRACT 'public.orders' - SUCCESS.
2025-06-07 06:27:29,602 - INFO - EXTRACT 'public.order_items' - SUCCESS.
2025-06-07 06:27:30,512 - INFO - EXTRACT 'public.order_payments' - SUCCESS.
2025-06-07 06:27:31,615 - INFO - EXTRACT 'public.order_reviews' - SUCCESS.
2025-06-07 06:27:31,615 - INFO - Extract All Tables From Sources - SUCCESS
2025-06-07 06:27:31,631 - INFO - ==================================ENDING EXTRACT DATA=======================================
2025-06-07 06:27:31,650 - INFO - [pid 19900] Worker Worker(salt=9829329693, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) done      Extract()
2025-06-07 06:27:31,653 - DEBUG - 1 running tasks, waiting for next task to finish
2025-06-07 06:27:31,655 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2025-06-07 06:27:31,657 - DEBUG - Asking scheduler for work...
2025-06-07 06:27:31,659 - DEBUG - Done
2025-06-07 06:27:31,663 - DEBUG - There are no more tasks to run at this time
2025-06-07 06:27:31,666 - INFO - Worker Worker(salt=9829329693, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) was stopped. Shutting down Keep-Alive thread
2025-06-07 06:27:31,666 - INFO - 
===== Luigi Execution Summary =====

Scheduled 1 tasks of which:
* 1 ran successfully:
    - 1 Extract()

This progress looks :) because there were no failed tasks or missing dependencies

===== Luigi Execution Summary =====

2025-06-07 06:35:51,689 - INFO - logging already configured
2025-06-07 06:35:51,693 - DEBUG - Checking if Load() is complete
2025-06-07 06:35:51,696 - DEBUG - Checking if Extract() is complete
2025-06-07 06:35:51,699 - INFO - Informed scheduler that task   Load__99914b932b   has status   PENDING
2025-06-07 06:35:51,701 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2025-06-07 06:35:51,702 - INFO - Done scheduling tasks
2025-06-07 06:35:51,704 - INFO - Running Worker with 1 processes
2025-06-07 06:35:51,704 - DEBUG - Asking scheduler for work...
2025-06-07 06:35:51,705 - DEBUG - Pending tasks: 1
2025-06-07 06:35:51,707 - INFO - [pid 19900] Worker Worker(salt=6731208716, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) running   Load()
2025-06-07 06:35:51,786 - INFO - Read Load Query - SUCCESS
2025-06-07 06:35:53,737 - INFO - Read Extracted Data - SUCCESS
2025-06-07 06:35:53,738 - INFO - Connect to olist-dwh - SUCCESS
2025-06-07 06:35:53,899 - INFO - Truncate `public` Schema in olist-dwh - SUCCESS
2025-06-07 06:35:53,900 - INFO - ==================================STARTING LOAD DATA=======================================
2025-06-07 06:36:01,456 - ERROR - LOAD All Tables To olist-dwh-public - FAILED
2025-06-07 06:36:01,460 - ERROR - LOAD All Tables To DWH - FAILED
2025-06-07 06:36:01,460 - ERROR - [pid 19900] Worker Worker(salt=6731208716, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) failed    Load()
Traceback (most recent call last):
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 2118, in _exec_insertmany_context
    dialect.do_execute(
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedColumn: column "product_name_lenght" of relation "products" does not exist
LINE 1: ...blic.products (product_id, product_category_name, product_na...
                                                             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\LENOVO THINKPAD\AppData\Local\Temp\ipykernel_19900\3125753500.py", line 198, in run
    products.to_sql('products',
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\pandas\util\_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\pandas\core\generic.py", line 3087, in to_sql
    return sql.to_sql(
           ^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\pandas\io\sql.py", line 842, in to_sql
    return pandas_sql.to_sql(
           ^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\pandas\io\sql.py", line 2018, in to_sql
    total_inserted = sql_engine.insert_records(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\pandas\io\sql.py", line 1567, in insert_records
    raise err
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\pandas\io\sql.py", line 1558, in insert_records
    return table.insert(chunksize=chunksize, method=method)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\pandas\io\sql.py", line 1119, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\pandas\io\sql.py", line 1010, in _execute_insert
    result = conn.execute(self.table.insert(), data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1418, in execute
    return meth(
           ^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\sql\elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1844, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 2126, in _exec_insertmany_context
    self._handle_dbapi_exception(
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 2118, in _exec_insertmany_context
    dialect.do_execute(
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedColumn) column "product_name_lenght" of relation "products" does not exist
LINE 1: ...blic.products (product_id, product_category_name, product_na...
                                                             ^

[SQL: INSERT INTO public.products (product_id, product_category_name, product_name_lenght, product_description_lenght, product_photos_qty, product_weight_g, product_length_cm, product_height_cm, product_width_cm) VALUES (%(product_id__0)s, %(product_catego ... 259872 characters truncated ... _weight_g__999)s, %(product_length_cm__999)s, %(product_height_cm__999)s, %(product_width_cm__999)s)]
[parameters: {'product_description_lenght__0': 287.0, 'product_photos_qty__0': 1.0, 'product_name_lenght__0': 40.0, 'product_height_cm__0': 10.0, 'product_weight_g__0': 225.0, 'product_width_cm__0': 14.0, 'product_category_name__0': 'perfumaria', 'product_id__0': '1e9e8ef04dbcff4541ed26657ea517e5', 'product_length_cm__0': 16.0, 'product_description_lenght__1': 276.0, 'product_photos_qty__1': 1.0, 'product_name_lenght__1': 44.0, 'product_height_cm__1': 18.0, 'product_weight_g__1': 1000.0, 'product_width_cm__1': 20.0, 'product_category_name__1': 'artes', 'product_id__1': '3aa071139cb16b67ca9e5dea641aaa2f', 'product_length_cm__1': 30.0, 'product_description_lenght__2': 250.0, 'product_photos_qty__2': 1.0, 'product_name_lenght__2': 46.0, 'product_height_cm__2': 9.0, 'product_weight_g__2': 154.0, 'product_width_cm__2': 15.0, 'product_category_name__2': 'esporte_lazer', 'product_id__2': '96bd76ec8810374ed1b65e291975717f', 'product_length_cm__2': 18.0, 'product_description_lenght__3': 261.0, 'product_photos_qty__3': 1.0, 'product_name_lenght__3': 27.0, 'product_height_cm__3': 4.0, 'product_weight_g__3': 371.0, 'product_width_cm__3': 26.0, 'product_category_name__3': 'bebes', 'product_id__3': 'cef67bcfe19066a932b7673e239eb23d', 'product_length_cm__3': 26.0, 'product_description_lenght__4': 402.0, 'product_photos_qty__4': 4.0, 'product_name_lenght__4': 37.0, 'product_height_cm__4': 17.0, 'product_weight_g__4': 625.0, 'product_width_cm__4': 13.0, 'product_category_name__4': 'utilidades_domesticas', 'product_id__4': '9dc1a7de274444849c219cff195d0b71', 'product_length_cm__4': 20.0, 'product_description_lenght__5': 745.0, 'product_photos_qty__5': 1.0, 'product_name_lenght__5': 60.0, 'product_height_cm__5': 5.0, 'product_weight_g__5': 200.0 ... 8900 parameters truncated ... 'product_weight_g__994': 1588.0, 'product_width_cm__994': 44.0, 'product_category_name__994': 'cama_mesa_banho', 'product_id__994': 'a93ad122024312ca432da7f7b32474b4', 'product_length_cm__994': 48.0, 'product_description_lenght__995': 287.0, 'product_photos_qty__995': 6.0, 'product_name_lenght__995': 40.0, 'product_height_cm__995': 16.0, 'product_weight_g__995': 1400.0, 'product_width_cm__995': 22.0, 'product_category_name__995': 'pet_shop', 'product_id__995': '98bf9f3941be6afbca9ea37f8eb0c466', 'product_length_cm__995': 20.0, 'product_description_lenght__996': 797.0, 'product_photos_qty__996': 5.0, 'product_name_lenght__996': 58.0, 'product_height_cm__996': 7.0, 'product_weight_g__996': 1100.0, 'product_width_cm__996': 38.0, 'product_category_name__996': 'automotivo', 'product_id__996': '1fd95182c672cf5b10c82207ca5dab97', 'product_length_cm__996': 23.0, 'product_description_lenght__997': 250.0, 'product_photos_qty__997': 2.0, 'product_name_lenght__997': 29.0, 'product_height_cm__997': 6.0, 'product_weight_g__997': 800.0, 'product_width_cm__997': 28.0, 'product_category_name__997': 'moveis_decoracao', 'product_id__997': 'ac01b71ddb644fe8806e71a6030accf9', 'product_length_cm__997': 32.0, 'product_description_lenght__998': 1134.0, 'product_photos_qty__998': 1.0, 'product_name_lenght__998': 45.0, 'product_height_cm__998': 15.0, 'product_weight_g__998': 867.0, 'product_width_cm__998': 18.0, 'product_category_name__998': 'esporte_lazer', 'product_id__998': '35e26f65c3f380cfe6257d771fb067d2', 'product_length_cm__998': 26.0, 'product_description_lenght__999': 999.0, 'product_photos_qty__999': 3.0, 'product_name_lenght__999': 32.0, 'product_height_cm__999': 5.0, 'product_weight_g__999': 225.0, 'product_width_cm__999': 20.0, 'product_category_name__999': 'informatica_acessorios', 'product_id__999': '089cc17c8bf2226d13648392e33dabd7', 'product_length_cm__999': 17.0}]
(Background on this error at: https://sqlalche.me/e/20/f405)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\LENOVO THINKPAD\AppData\Local\Temp\ipykernel_19900\3125753500.py", line 232, in run
    raise Exception('Failed Load Tables To olist-dwh-public')
Exception: Failed Load Tables To olist-dwh-public

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 210, in run
    new_deps = self._run_get_new_deps()
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 138, in _run_get_new_deps
    task_gen = self.task.run()
               ^^^^^^^^^^^^^^^
  File "C:\Users\LENOVO THINKPAD\AppData\Local\Temp\ipykernel_19900\3125753500.py", line 300, in run
    raise Exception('Failed Load Tables To DWH')
Exception: Failed Load Tables To DWH
2025-06-07 06:36:01,680 - DEBUG - 1 running tasks, waiting for next task to finish
2025-06-07 06:36:01,687 - INFO - Informed scheduler that task   Load__99914b932b   has status   FAILED
2025-06-07 06:36:01,688 - DEBUG - Asking scheduler for work...
2025-06-07 06:36:01,691 - DEBUG - Done
2025-06-07 06:36:01,694 - DEBUG - There are no more tasks to run at this time
2025-06-07 06:36:01,697 - DEBUG - There are 1 pending tasks possibly being run by other workers
2025-06-07 06:36:01,698 - DEBUG - There are 1 pending tasks unique to this worker
2025-06-07 06:36:01,700 - DEBUG - There are 1 pending tasks last scheduled by this worker
2025-06-07 06:36:01,709 - INFO - Worker Worker(salt=6731208716, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) was stopped. Shutting down Keep-Alive thread
2025-06-07 06:36:01,726 - INFO - 
===== Luigi Execution Summary =====

Scheduled 2 tasks of which:
* 1 complete ones were encountered:
    - 1 Extract()
* 1 failed:
    - 1 Load()

This progress looks :( because there were failed tasks

===== Luigi Execution Summary =====

2025-06-07 06:44:30,321 - INFO - logging already configured
2025-06-07 06:44:30,324 - DEBUG - Checking if Load() is complete
2025-06-07 06:44:30,327 - INFO - Informed scheduler that task   Load__99914b932b   has status   DONE
2025-06-07 06:44:30,328 - INFO - Done scheduling tasks
2025-06-07 06:44:30,330 - INFO - Running Worker with 1 processes
2025-06-07 06:44:30,330 - DEBUG - Asking scheduler for work...
2025-06-07 06:44:30,332 - DEBUG - Done
2025-06-07 06:44:30,333 - DEBUG - There are no more tasks to run at this time
2025-06-07 06:44:30,335 - INFO - Worker Worker(salt=2385189402, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) was stopped. Shutting down Keep-Alive thread
2025-06-07 06:44:30,340 - INFO - 
===== Luigi Execution Summary =====

Scheduled 1 tasks of which:
* 1 complete ones were encountered:
    - 1 Load()

Did not run any tasks
This progress looks :) because there were no failed tasks or missing dependencies

===== Luigi Execution Summary =====

2025-06-07 06:45:00,713 - INFO - logging already configured
2025-06-07 06:45:00,716 - DEBUG - Checking if Load() is complete
2025-06-07 06:45:00,719 - INFO - Informed scheduler that task   Load__99914b932b   has status   DONE
2025-06-07 06:45:00,720 - INFO - Done scheduling tasks
2025-06-07 06:45:00,721 - INFO - Running Worker with 1 processes
2025-06-07 06:45:00,722 - DEBUG - Asking scheduler for work...
2025-06-07 06:45:00,724 - DEBUG - Done
2025-06-07 06:45:00,725 - DEBUG - There are no more tasks to run at this time
2025-06-07 06:45:00,727 - INFO - Worker Worker(salt=9617467259, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) was stopped. Shutting down Keep-Alive thread
2025-06-07 06:45:00,731 - INFO - 
===== Luigi Execution Summary =====

Scheduled 1 tasks of which:
* 1 complete ones were encountered:
    - 1 Load()

Did not run any tasks
This progress looks :) because there were no failed tasks or missing dependencies

===== Luigi Execution Summary =====

2025-06-07 06:45:37,026 - INFO - logging already configured
2025-06-07 06:45:37,032 - DEBUG - Checking if Load() is complete
2025-06-07 06:45:37,034 - INFO - Informed scheduler that task   Load__99914b932b   has status   DONE
2025-06-07 06:45:37,035 - INFO - Done scheduling tasks
2025-06-07 06:45:37,037 - INFO - Running Worker with 1 processes
2025-06-07 06:45:37,038 - DEBUG - Asking scheduler for work...
2025-06-07 06:45:37,040 - DEBUG - Done
2025-06-07 06:45:37,041 - DEBUG - There are no more tasks to run at this time
2025-06-07 06:45:37,042 - INFO - Worker Worker(salt=835441830, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) was stopped. Shutting down Keep-Alive thread
2025-06-07 06:45:37,049 - INFO - 
===== Luigi Execution Summary =====

Scheduled 1 tasks of which:
* 1 complete ones were encountered:
    - 1 Load()

Did not run any tasks
This progress looks :) because there were no failed tasks or missing dependencies

===== Luigi Execution Summary =====

2025-06-07 06:45:49,812 - INFO - logging already configured
2025-06-07 06:45:49,819 - DEBUG - Checking if Extract() is complete
2025-06-07 06:45:49,821 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2025-06-07 06:45:49,822 - DEBUG - Checking if Load() is complete
2025-06-07 06:45:49,825 - INFO - Informed scheduler that task   Load__99914b932b   has status   DONE
2025-06-07 06:45:49,827 - INFO - Done scheduling tasks
2025-06-07 06:45:49,828 - INFO - Running Worker with 1 processes
2025-06-07 06:45:49,830 - DEBUG - Asking scheduler for work...
2025-06-07 06:45:49,831 - DEBUG - Done
2025-06-07 06:45:49,833 - DEBUG - There are no more tasks to run at this time
2025-06-07 06:45:49,834 - INFO - Worker Worker(salt=4621627886, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) was stopped. Shutting down Keep-Alive thread
2025-06-07 06:45:49,840 - INFO - 
===== Luigi Execution Summary =====

Scheduled 2 tasks of which:
* 2 complete ones were encountered:
    - 1 Extract()
    - 1 Load()

Did not run any tasks
This progress looks :) because there were no failed tasks or missing dependencies

===== Luigi Execution Summary =====

2025-06-07 06:46:44,680 - INFO - logging already configured
2025-06-07 06:46:44,685 - DEBUG - Checking if Extract() is complete
2025-06-07 06:46:44,689 - INFO - Informed scheduler that task   Extract__99914b932b   has status   PENDING
2025-06-07 06:46:44,691 - DEBUG - Checking if Load() is complete
2025-06-07 06:46:44,693 - DEBUG - Checking if Extract() is complete
2025-06-07 06:46:44,695 - INFO - Informed scheduler that task   Load__99914b932b   has status   PENDING
2025-06-07 06:46:44,696 - INFO - Informed scheduler that task   Extract__99914b932b   has status   PENDING
2025-06-07 06:46:44,697 - INFO - Done scheduling tasks
2025-06-07 06:46:44,698 - INFO - Running Worker with 1 processes
2025-06-07 06:46:44,699 - DEBUG - Asking scheduler for work...
2025-06-07 06:46:44,701 - DEBUG - Pending tasks: 2
2025-06-07 06:46:44,702 - INFO - [pid 19900] Worker Worker(salt=8563541089, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) running   Extract()
2025-06-07 06:46:44,703 - ERROR - [pid 19900] Worker Worker(salt=8563541089, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) failed    Extract()
Traceback (most recent call last):
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 210, in run
    new_deps = self._run_get_new_deps()
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 138, in _run_get_new_deps
    task_gen = self.task.run()
               ^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\Documents\Github\Pacmann---Data-Storage_-Warehouse--Mart---Lake\mentoring 2\olist-dwh-project\pipeline\extract.py", line 43, in run
    os.makedirs(os.path.dirname(self.output().path), exist_ok=True)
                                ^^^^^^^^^^^^^^^^^^
AttributeError: 'list' object has no attribute 'path'
2025-06-07 06:46:44,709 - DEBUG - 1 running tasks, waiting for next task to finish
2025-06-07 06:46:44,715 - INFO - Informed scheduler that task   Extract__99914b932b   has status   FAILED
2025-06-07 06:46:44,717 - DEBUG - Asking scheduler for work...
2025-06-07 06:46:44,718 - DEBUG - Done
2025-06-07 06:46:44,720 - DEBUG - There are no more tasks to run at this time
2025-06-07 06:46:44,721 - DEBUG - There are 2 pending tasks possibly being run by other workers
2025-06-07 06:46:44,722 - DEBUG - There are 2 pending tasks unique to this worker
2025-06-07 06:46:44,725 - DEBUG - There are 2 pending tasks last scheduled by this worker
2025-06-07 06:46:44,726 - INFO - Worker Worker(salt=8563541089, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) was stopped. Shutting down Keep-Alive thread
2025-06-07 06:46:44,732 - INFO - 
===== Luigi Execution Summary =====

Scheduled 2 tasks of which:
* 1 failed:
    - 1 Extract()
* 1 were left pending, among these:
    * 1 had failed dependencies:
        - 1 Load()

This progress looks :( because there were failed tasks

===== Luigi Execution Summary =====

2025-06-07 06:48:36,425 - INFO - logging already configured
2025-06-07 06:48:36,429 - DEBUG - Checking if Extract() is complete
2025-06-07 06:48:36,432 - INFO - Informed scheduler that task   Extract__99914b932b   has status   PENDING
2025-06-07 06:48:36,434 - DEBUG - Checking if Load() is complete
2025-06-07 06:48:36,437 - DEBUG - Checking if Extract() is complete
2025-06-07 06:48:36,438 - INFO - Informed scheduler that task   Load__99914b932b   has status   PENDING
2025-06-07 06:48:36,440 - INFO - Informed scheduler that task   Extract__99914b932b   has status   PENDING
2025-06-07 06:48:36,440 - INFO - Done scheduling tasks
2025-06-07 06:48:36,442 - INFO - Running Worker with 1 processes
2025-06-07 06:48:36,443 - DEBUG - Asking scheduler for work...
2025-06-07 06:48:36,445 - DEBUG - Pending tasks: 2
2025-06-07 06:48:36,446 - INFO - [pid 19900] Worker Worker(salt=7460370573, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) running   Extract()
2025-06-07 06:48:36,448 - ERROR - [pid 19900] Worker Worker(salt=7460370573, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) failed    Extract()
Traceback (most recent call last):
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 210, in run
    new_deps = self._run_get_new_deps()
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 138, in _run_get_new_deps
    task_gen = self.task.run()
               ^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\Documents\Github\Pacmann---Data-Storage_-Warehouse--Mart---Lake\mentoring 2\olist-dwh-project\pipeline\extract.py", line 43, in run
    os.makedirs(os.path.dirname(self.output().path), exist_ok=True)
                                ^^^^^^^^^^^^^^^^^^
AttributeError: 'list' object has no attribute 'path'
2025-06-07 06:48:36,452 - DEBUG - 1 running tasks, waiting for next task to finish
2025-06-07 06:48:36,459 - INFO - Informed scheduler that task   Extract__99914b932b   has status   FAILED
2025-06-07 06:48:36,460 - DEBUG - Asking scheduler for work...
2025-06-07 06:48:36,462 - DEBUG - Done
2025-06-07 06:48:36,463 - DEBUG - There are no more tasks to run at this time
2025-06-07 06:48:36,464 - DEBUG - There are 2 pending tasks possibly being run by other workers
2025-06-07 06:48:36,465 - DEBUG - There are 2 pending tasks unique to this worker
2025-06-07 06:48:36,467 - DEBUG - There are 2 pending tasks last scheduled by this worker
2025-06-07 06:48:36,469 - INFO - Worker Worker(salt=7460370573, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) was stopped. Shutting down Keep-Alive thread
2025-06-07 06:48:36,475 - INFO - 
===== Luigi Execution Summary =====

Scheduled 2 tasks of which:
* 1 failed:
    - 1 Extract()
* 1 were left pending, among these:
    * 1 had failed dependencies:
        - 1 Load()

This progress looks :( because there were failed tasks

===== Luigi Execution Summary =====

2025-06-07 06:48:38,206 - INFO - logging already configured
2025-06-07 06:48:38,210 - DEBUG - Checking if Extract() is complete
2025-06-07 06:48:38,213 - INFO - Informed scheduler that task   Extract__99914b932b   has status   PENDING
2025-06-07 06:48:38,214 - DEBUG - Checking if Load() is complete
2025-06-07 06:48:38,218 - DEBUG - Checking if Extract() is complete
2025-06-07 06:48:38,219 - INFO - Informed scheduler that task   Load__99914b932b   has status   PENDING
2025-06-07 06:48:38,221 - INFO - Informed scheduler that task   Extract__99914b932b   has status   PENDING
2025-06-07 06:48:38,222 - INFO - Done scheduling tasks
2025-06-07 06:48:38,224 - INFO - Running Worker with 1 processes
2025-06-07 06:48:38,225 - DEBUG - Asking scheduler for work...
2025-06-07 06:48:38,227 - DEBUG - Pending tasks: 2
2025-06-07 06:48:38,228 - INFO - [pid 19900] Worker Worker(salt=812434900, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) running   Extract()
2025-06-07 06:48:38,231 - ERROR - [pid 19900] Worker Worker(salt=812434900, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) failed    Extract()
Traceback (most recent call last):
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 210, in run
    new_deps = self._run_get_new_deps()
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 138, in _run_get_new_deps
    task_gen = self.task.run()
               ^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\Documents\Github\Pacmann---Data-Storage_-Warehouse--Mart---Lake\mentoring 2\olist-dwh-project\pipeline\extract.py", line 43, in run
    os.makedirs(os.path.dirname(self.output().path), exist_ok=True)
                                ^^^^^^^^^^^^^^^^^^
AttributeError: 'list' object has no attribute 'path'
2025-06-07 06:48:38,238 - DEBUG - 1 running tasks, waiting for next task to finish
2025-06-07 06:48:38,244 - INFO - Informed scheduler that task   Extract__99914b932b   has status   FAILED
2025-06-07 06:48:38,246 - DEBUG - Asking scheduler for work...
2025-06-07 06:48:38,247 - DEBUG - Done
2025-06-07 06:48:38,248 - DEBUG - There are no more tasks to run at this time
2025-06-07 06:48:38,249 - DEBUG - There are 2 pending tasks possibly being run by other workers
2025-06-07 06:48:38,251 - DEBUG - There are 2 pending tasks unique to this worker
2025-06-07 06:48:38,252 - DEBUG - There are 2 pending tasks last scheduled by this worker
2025-06-07 06:48:38,253 - INFO - Worker Worker(salt=812434900, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) was stopped. Shutting down Keep-Alive thread
2025-06-07 06:48:38,259 - INFO - 
===== Luigi Execution Summary =====

Scheduled 2 tasks of which:
* 1 failed:
    - 1 Extract()
* 1 were left pending, among these:
    * 1 had failed dependencies:
        - 1 Load()

This progress looks :( because there were failed tasks

===== Luigi Execution Summary =====

2025-06-07 06:48:38,640 - INFO - logging already configured
2025-06-07 06:48:38,643 - DEBUG - Checking if Extract() is complete
2025-06-07 06:48:38,646 - INFO - Informed scheduler that task   Extract__99914b932b   has status   PENDING
2025-06-07 06:48:38,648 - DEBUG - Checking if Load() is complete
2025-06-07 06:48:38,650 - DEBUG - Checking if Extract() is complete
2025-06-07 06:48:38,653 - INFO - Informed scheduler that task   Load__99914b932b   has status   PENDING
2025-06-07 06:48:38,654 - INFO - Informed scheduler that task   Extract__99914b932b   has status   PENDING
2025-06-07 06:48:38,656 - INFO - Done scheduling tasks
2025-06-07 06:48:38,657 - INFO - Running Worker with 1 processes
2025-06-07 06:48:38,658 - DEBUG - Asking scheduler for work...
2025-06-07 06:48:38,660 - DEBUG - Pending tasks: 2
2025-06-07 06:48:38,661 - INFO - [pid 19900] Worker Worker(salt=2885590894, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) running   Extract()
2025-06-07 06:48:38,663 - ERROR - [pid 19900] Worker Worker(salt=2885590894, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) failed    Extract()
Traceback (most recent call last):
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 210, in run
    new_deps = self._run_get_new_deps()
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 138, in _run_get_new_deps
    task_gen = self.task.run()
               ^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\Documents\Github\Pacmann---Data-Storage_-Warehouse--Mart---Lake\mentoring 2\olist-dwh-project\pipeline\extract.py", line 43, in run
    os.makedirs(os.path.dirname(self.output().path), exist_ok=True)
                                ^^^^^^^^^^^^^^^^^^
AttributeError: 'list' object has no attribute 'path'
2025-06-07 06:48:38,668 - DEBUG - 1 running tasks, waiting for next task to finish
2025-06-07 06:48:38,674 - INFO - Informed scheduler that task   Extract__99914b932b   has status   FAILED
2025-06-07 06:48:38,676 - DEBUG - Asking scheduler for work...
2025-06-07 06:48:38,678 - DEBUG - Done
2025-06-07 06:48:38,680 - DEBUG - There are no more tasks to run at this time
2025-06-07 06:48:38,681 - DEBUG - There are 2 pending tasks possibly being run by other workers
2025-06-07 06:48:38,683 - DEBUG - There are 2 pending tasks unique to this worker
2025-06-07 06:48:38,684 - DEBUG - There are 2 pending tasks last scheduled by this worker
2025-06-07 06:48:38,685 - INFO - Worker Worker(salt=2885590894, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) was stopped. Shutting down Keep-Alive thread
2025-06-07 06:48:38,690 - INFO - 
===== Luigi Execution Summary =====

Scheduled 2 tasks of which:
* 1 failed:
    - 1 Extract()
* 1 were left pending, among these:
    * 1 had failed dependencies:
        - 1 Load()

This progress looks :( because there were failed tasks

===== Luigi Execution Summary =====

2025-06-07 06:48:38,858 - INFO - logging already configured
2025-06-07 06:48:38,861 - DEBUG - Checking if Extract() is complete
2025-06-07 06:48:38,865 - INFO - Informed scheduler that task   Extract__99914b932b   has status   PENDING
2025-06-07 06:48:38,865 - DEBUG - Checking if Load() is complete
2025-06-07 06:48:38,868 - DEBUG - Checking if Extract() is complete
2025-06-07 06:48:38,869 - INFO - Informed scheduler that task   Load__99914b932b   has status   PENDING
2025-06-07 06:48:38,869 - INFO - Informed scheduler that task   Extract__99914b932b   has status   PENDING
2025-06-07 06:48:38,871 - INFO - Done scheduling tasks
2025-06-07 06:48:38,872 - INFO - Running Worker with 1 processes
2025-06-07 06:48:38,872 - DEBUG - Asking scheduler for work...
2025-06-07 06:48:38,874 - DEBUG - Pending tasks: 2
2025-06-07 06:48:38,875 - INFO - [pid 19900] Worker Worker(salt=6047969316, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) running   Extract()
2025-06-07 06:48:38,877 - ERROR - [pid 19900] Worker Worker(salt=6047969316, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) failed    Extract()
Traceback (most recent call last):
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 210, in run
    new_deps = self._run_get_new_deps()
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 138, in _run_get_new_deps
    task_gen = self.task.run()
               ^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\Documents\Github\Pacmann---Data-Storage_-Warehouse--Mart---Lake\mentoring 2\olist-dwh-project\pipeline\extract.py", line 43, in run
    os.makedirs(os.path.dirname(self.output().path), exist_ok=True)
                                ^^^^^^^^^^^^^^^^^^
AttributeError: 'list' object has no attribute 'path'
2025-06-07 06:48:38,881 - DEBUG - 1 running tasks, waiting for next task to finish
2025-06-07 06:48:38,886 - INFO - Informed scheduler that task   Extract__99914b932b   has status   FAILED
2025-06-07 06:48:38,887 - DEBUG - Asking scheduler for work...
2025-06-07 06:48:38,889 - DEBUG - Done
2025-06-07 06:48:38,891 - DEBUG - There are no more tasks to run at this time
2025-06-07 06:48:38,892 - DEBUG - There are 2 pending tasks possibly being run by other workers
2025-06-07 06:48:38,893 - DEBUG - There are 2 pending tasks unique to this worker
2025-06-07 06:48:38,894 - DEBUG - There are 2 pending tasks last scheduled by this worker
2025-06-07 06:48:38,895 - INFO - Worker Worker(salt=6047969316, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) was stopped. Shutting down Keep-Alive thread
2025-06-07 06:48:38,901 - INFO - 
===== Luigi Execution Summary =====

Scheduled 2 tasks of which:
* 1 failed:
    - 1 Extract()
* 1 were left pending, among these:
    * 1 had failed dependencies:
        - 1 Load()

This progress looks :( because there were failed tasks

===== Luigi Execution Summary =====

2025-06-07 06:48:39,037 - INFO - logging already configured
2025-06-07 06:48:39,043 - DEBUG - Checking if Extract() is complete
2025-06-07 06:48:39,045 - INFO - Informed scheduler that task   Extract__99914b932b   has status   PENDING
2025-06-07 06:48:39,046 - DEBUG - Checking if Load() is complete
2025-06-07 06:48:39,049 - DEBUG - Checking if Extract() is complete
2025-06-07 06:48:39,051 - INFO - Informed scheduler that task   Load__99914b932b   has status   PENDING
2025-06-07 06:48:39,052 - INFO - Informed scheduler that task   Extract__99914b932b   has status   PENDING
2025-06-07 06:48:39,054 - INFO - Done scheduling tasks
2025-06-07 06:48:39,055 - INFO - Running Worker with 1 processes
2025-06-07 06:48:39,057 - DEBUG - Asking scheduler for work...
2025-06-07 06:48:39,059 - DEBUG - Pending tasks: 2
2025-06-07 06:48:39,060 - INFO - [pid 19900] Worker Worker(salt=2985560429, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) running   Extract()
2025-06-07 06:48:39,063 - ERROR - [pid 19900] Worker Worker(salt=2985560429, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) failed    Extract()
Traceback (most recent call last):
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 210, in run
    new_deps = self._run_get_new_deps()
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 138, in _run_get_new_deps
    task_gen = self.task.run()
               ^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\Documents\Github\Pacmann---Data-Storage_-Warehouse--Mart---Lake\mentoring 2\olist-dwh-project\pipeline\extract.py", line 43, in run
    os.makedirs(os.path.dirname(self.output().path), exist_ok=True)
                                ^^^^^^^^^^^^^^^^^^
AttributeError: 'list' object has no attribute 'path'
2025-06-07 06:48:39,068 - DEBUG - 1 running tasks, waiting for next task to finish
2025-06-07 06:48:39,076 - INFO - Informed scheduler that task   Extract__99914b932b   has status   FAILED
2025-06-07 06:48:39,077 - DEBUG - Asking scheduler for work...
2025-06-07 06:48:39,078 - DEBUG - Done
2025-06-07 06:48:39,080 - DEBUG - There are no more tasks to run at this time
2025-06-07 06:48:39,081 - DEBUG - There are 2 pending tasks possibly being run by other workers
2025-06-07 06:48:39,082 - DEBUG - There are 2 pending tasks unique to this worker
2025-06-07 06:48:39,083 - DEBUG - There are 2 pending tasks last scheduled by this worker
2025-06-07 06:48:39,084 - INFO - Worker Worker(salt=2985560429, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) was stopped. Shutting down Keep-Alive thread
2025-06-07 06:48:39,090 - INFO - 
===== Luigi Execution Summary =====

Scheduled 2 tasks of which:
* 1 failed:
    - 1 Extract()
* 1 were left pending, among these:
    * 1 had failed dependencies:
        - 1 Load()

This progress looks :( because there were failed tasks

===== Luigi Execution Summary =====

2025-06-07 06:48:39,287 - INFO - logging already configured
2025-06-07 06:48:39,292 - DEBUG - Checking if Extract() is complete
2025-06-07 06:48:39,295 - INFO - Informed scheduler that task   Extract__99914b932b   has status   PENDING
2025-06-07 06:48:39,297 - DEBUG - Checking if Load() is complete
2025-06-07 06:48:39,298 - DEBUG - Checking if Extract() is complete
2025-06-07 06:48:39,300 - INFO - Informed scheduler that task   Load__99914b932b   has status   PENDING
2025-06-07 06:48:39,302 - INFO - Informed scheduler that task   Extract__99914b932b   has status   PENDING
2025-06-07 06:48:39,302 - INFO - Done scheduling tasks
2025-06-07 06:48:39,303 - INFO - Running Worker with 1 processes
2025-06-07 06:48:39,305 - DEBUG - Asking scheduler for work...
2025-06-07 06:48:39,306 - DEBUG - Pending tasks: 2
2025-06-07 06:48:39,306 - INFO - [pid 19900] Worker Worker(salt=1615502854, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) running   Extract()
2025-06-07 06:48:39,308 - ERROR - [pid 19900] Worker Worker(salt=1615502854, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) failed    Extract()
Traceback (most recent call last):
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 210, in run
    new_deps = self._run_get_new_deps()
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 138, in _run_get_new_deps
    task_gen = self.task.run()
               ^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\Documents\Github\Pacmann---Data-Storage_-Warehouse--Mart---Lake\mentoring 2\olist-dwh-project\pipeline\extract.py", line 43, in run
    os.makedirs(os.path.dirname(self.output().path), exist_ok=True)
                                ^^^^^^^^^^^^^^^^^^
AttributeError: 'list' object has no attribute 'path'
2025-06-07 06:48:39,313 - DEBUG - 1 running tasks, waiting for next task to finish
2025-06-07 06:48:39,319 - INFO - Informed scheduler that task   Extract__99914b932b   has status   FAILED
2025-06-07 06:48:39,320 - DEBUG - Asking scheduler for work...
2025-06-07 06:48:39,321 - DEBUG - Done
2025-06-07 06:48:39,322 - DEBUG - There are no more tasks to run at this time
2025-06-07 06:48:39,323 - DEBUG - There are 2 pending tasks possibly being run by other workers
2025-06-07 06:48:39,324 - DEBUG - There are 2 pending tasks unique to this worker
2025-06-07 06:48:39,325 - DEBUG - There are 2 pending tasks last scheduled by this worker
2025-06-07 06:48:39,327 - INFO - Worker Worker(salt=1615502854, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) was stopped. Shutting down Keep-Alive thread
2025-06-07 06:48:39,332 - INFO - 
===== Luigi Execution Summary =====

Scheduled 2 tasks of which:
* 1 failed:
    - 1 Extract()
* 1 were left pending, among these:
    * 1 had failed dependencies:
        - 1 Load()

This progress looks :( because there were failed tasks

===== Luigi Execution Summary =====

2025-06-07 06:48:39,635 - INFO - logging already configured
2025-06-07 06:48:39,640 - DEBUG - Checking if Extract() is complete
2025-06-07 06:48:39,644 - INFO - Informed scheduler that task   Extract__99914b932b   has status   PENDING
2025-06-07 06:48:39,646 - DEBUG - Checking if Load() is complete
2025-06-07 06:48:39,647 - DEBUG - Checking if Extract() is complete
2025-06-07 06:48:39,649 - INFO - Informed scheduler that task   Load__99914b932b   has status   PENDING
2025-06-07 06:48:39,650 - INFO - Informed scheduler that task   Extract__99914b932b   has status   PENDING
2025-06-07 06:48:39,652 - INFO - Done scheduling tasks
2025-06-07 06:48:39,652 - INFO - Running Worker with 1 processes
2025-06-07 06:48:39,654 - DEBUG - Asking scheduler for work...
2025-06-07 06:48:39,654 - DEBUG - Pending tasks: 2
2025-06-07 06:48:39,655 - INFO - [pid 19900] Worker Worker(salt=6831809324, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) running   Extract()
2025-06-07 06:48:39,658 - ERROR - [pid 19900] Worker Worker(salt=6831809324, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) failed    Extract()
Traceback (most recent call last):
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 210, in run
    new_deps = self._run_get_new_deps()
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 138, in _run_get_new_deps
    task_gen = self.task.run()
               ^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\Documents\Github\Pacmann---Data-Storage_-Warehouse--Mart---Lake\mentoring 2\olist-dwh-project\pipeline\extract.py", line 43, in run
    os.makedirs(os.path.dirname(self.output().path), exist_ok=True)
                                ^^^^^^^^^^^^^^^^^^
AttributeError: 'list' object has no attribute 'path'
2025-06-07 06:48:39,663 - DEBUG - 1 running tasks, waiting for next task to finish
2025-06-07 06:48:39,663 - INFO - Informed scheduler that task   Extract__99914b932b   has status   FAILED
2025-06-07 06:48:39,669 - DEBUG - Asking scheduler for work...
2025-06-07 06:48:39,669 - DEBUG - Done
2025-06-07 06:48:39,669 - DEBUG - There are no more tasks to run at this time
2025-06-07 06:48:39,669 - DEBUG - There are 2 pending tasks possibly being run by other workers
2025-06-07 06:48:39,669 - DEBUG - There are 2 pending tasks unique to this worker
2025-06-07 06:48:39,669 - DEBUG - There are 2 pending tasks last scheduled by this worker
2025-06-07 06:48:39,669 - INFO - Worker Worker(salt=6831809324, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) was stopped. Shutting down Keep-Alive thread
2025-06-07 06:48:39,678 - INFO - 
===== Luigi Execution Summary =====

Scheduled 2 tasks of which:
* 1 failed:
    - 1 Extract()
* 1 were left pending, among these:
    * 1 had failed dependencies:
        - 1 Load()

This progress looks :( because there were failed tasks

===== Luigi Execution Summary =====

2025-06-07 06:48:39,889 - INFO - logging already configured
2025-06-07 06:48:39,893 - DEBUG - Checking if Extract() is complete
2025-06-07 06:48:39,897 - INFO - Informed scheduler that task   Extract__99914b932b   has status   PENDING
2025-06-07 06:48:39,899 - DEBUG - Checking if Load() is complete
2025-06-07 06:48:39,899 - DEBUG - Checking if Extract() is complete
2025-06-07 06:48:39,903 - INFO - Informed scheduler that task   Load__99914b932b   has status   PENDING
2025-06-07 06:48:39,903 - INFO - Informed scheduler that task   Extract__99914b932b   has status   PENDING
2025-06-07 06:48:39,903 - INFO - Done scheduling tasks
2025-06-07 06:48:39,903 - INFO - Running Worker with 1 processes
2025-06-07 06:48:39,903 - DEBUG - Asking scheduler for work...
2025-06-07 06:48:39,903 - DEBUG - Pending tasks: 2
2025-06-07 06:48:39,910 - INFO - [pid 19900] Worker Worker(salt=3230217994, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) running   Extract()
2025-06-07 06:48:39,910 - ERROR - [pid 19900] Worker Worker(salt=3230217994, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) failed    Extract()
Traceback (most recent call last):
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 210, in run
    new_deps = self._run_get_new_deps()
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 138, in _run_get_new_deps
    task_gen = self.task.run()
               ^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\Documents\Github\Pacmann---Data-Storage_-Warehouse--Mart---Lake\mentoring 2\olist-dwh-project\pipeline\extract.py", line 43, in run
    os.makedirs(os.path.dirname(self.output().path), exist_ok=True)
                                ^^^^^^^^^^^^^^^^^^
AttributeError: 'list' object has no attribute 'path'
2025-06-07 06:48:39,917 - DEBUG - 1 running tasks, waiting for next task to finish
2025-06-07 06:48:39,921 - INFO - Informed scheduler that task   Extract__99914b932b   has status   FAILED
2025-06-07 06:48:39,921 - DEBUG - Asking scheduler for work...
2025-06-07 06:48:39,921 - DEBUG - Done
2025-06-07 06:48:39,926 - DEBUG - There are no more tasks to run at this time
2025-06-07 06:48:39,926 - DEBUG - There are 2 pending tasks possibly being run by other workers
2025-06-07 06:48:39,926 - DEBUG - There are 2 pending tasks unique to this worker
2025-06-07 06:48:39,931 - DEBUG - There are 2 pending tasks last scheduled by this worker
2025-06-07 06:48:39,932 - INFO - Worker Worker(salt=3230217994, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) was stopped. Shutting down Keep-Alive thread
2025-06-07 06:48:39,937 - INFO - 
===== Luigi Execution Summary =====

Scheduled 2 tasks of which:
* 1 failed:
    - 1 Extract()
* 1 were left pending, among these:
    * 1 had failed dependencies:
        - 1 Load()

This progress looks :( because there were failed tasks

===== Luigi Execution Summary =====

2025-06-07 06:48:50,322 - INFO - logging already configured
2025-06-07 06:48:50,329 - DEBUG - Checking if Extract() is complete
2025-06-07 06:48:50,357 - INFO - Informed scheduler that task   Extract__99914b932b   has status   PENDING
2025-06-07 06:48:50,359 - DEBUG - Checking if Load() is complete
2025-06-07 06:48:50,361 - DEBUG - Checking if Extract() is complete
2025-06-07 06:48:50,366 - INFO - Informed scheduler that task   Load__99914b932b   has status   PENDING
2025-06-07 06:48:50,377 - INFO - Informed scheduler that task   Extract__99914b932b   has status   PENDING
2025-06-07 06:48:50,377 - INFO - Done scheduling tasks
2025-06-07 06:48:50,377 - INFO - Running Worker with 1 processes
2025-06-07 06:48:50,390 - DEBUG - Asking scheduler for work...
2025-06-07 06:48:50,401 - DEBUG - Pending tasks: 2
2025-06-07 06:48:50,403 - INFO - [pid 19900] Worker Worker(salt=7188998938, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) running   Extract()
2025-06-07 06:48:50,403 - ERROR - [pid 19900] Worker Worker(salt=7188998938, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) failed    Extract()
Traceback (most recent call last):
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 210, in run
    new_deps = self._run_get_new_deps()
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 138, in _run_get_new_deps
    task_gen = self.task.run()
               ^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\Documents\Github\Pacmann---Data-Storage_-Warehouse--Mart---Lake\mentoring 2\olist-dwh-project\pipeline\extract.py", line 43, in run
    os.makedirs(os.path.dirname(self.output().path), exist_ok=True)
                                ^^^^^^^^^^^^^^^^^^
AttributeError: 'list' object has no attribute 'path'
2025-06-07 06:48:50,410 - DEBUG - 1 running tasks, waiting for next task to finish
2025-06-07 06:48:50,428 - INFO - Informed scheduler that task   Extract__99914b932b   has status   FAILED
2025-06-07 06:48:50,428 - DEBUG - Asking scheduler for work...
2025-06-07 06:48:50,438 - DEBUG - Done
2025-06-07 06:48:50,440 - DEBUG - There are no more tasks to run at this time
2025-06-07 06:48:50,440 - DEBUG - There are 2 pending tasks possibly being run by other workers
2025-06-07 06:48:50,443 - DEBUG - There are 2 pending tasks unique to this worker
2025-06-07 06:48:50,443 - DEBUG - There are 2 pending tasks last scheduled by this worker
2025-06-07 06:48:50,443 - INFO - Worker Worker(salt=7188998938, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) was stopped. Shutting down Keep-Alive thread
2025-06-07 06:48:50,448 - INFO - 
===== Luigi Execution Summary =====

Scheduled 2 tasks of which:
* 1 failed:
    - 1 Extract()
* 1 were left pending, among these:
    * 1 had failed dependencies:
        - 1 Load()

This progress looks :( because there were failed tasks

===== Luigi Execution Summary =====

2025-06-07 06:49:48,470 - INFO - logging already configured
2025-06-07 06:49:48,473 - DEBUG - Checking if Extract() is complete
2025-06-07 06:49:48,475 - INFO - Informed scheduler that task   Extract__99914b932b   has status   PENDING
2025-06-07 06:49:48,476 - DEBUG - Checking if Load() is complete
2025-06-07 06:49:48,479 - DEBUG - Checking if Extract() is complete
2025-06-07 06:49:48,481 - INFO - Informed scheduler that task   Load__99914b932b   has status   PENDING
2025-06-07 06:49:48,482 - INFO - Informed scheduler that task   Extract__99914b932b   has status   PENDING
2025-06-07 06:49:48,482 - INFO - Done scheduling tasks
2025-06-07 06:49:48,484 - INFO - Running Worker with 1 processes
2025-06-07 06:49:48,486 - DEBUG - Asking scheduler for work...
2025-06-07 06:49:48,487 - DEBUG - Pending tasks: 2
2025-06-07 06:49:48,487 - INFO - [pid 19900] Worker Worker(salt=8329747368, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) running   Extract()
2025-06-07 06:49:48,489 - ERROR - [pid 19900] Worker Worker(salt=8329747368, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) failed    Extract()
Traceback (most recent call last):
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 210, in run
    new_deps = self._run_get_new_deps()
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 138, in _run_get_new_deps
    task_gen = self.task.run()
               ^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\Documents\Github\Pacmann---Data-Storage_-Warehouse--Mart---Lake\mentoring 2\olist-dwh-project\pipeline\extract.py", line 43, in run
    os.makedirs(os.path.dirname(self.output().path), exist_ok=True)
                                ^^^^^^^^^^^^^^^^^^
AttributeError: 'list' object has no attribute 'path'
2025-06-07 06:49:48,493 - DEBUG - 1 running tasks, waiting for next task to finish
2025-06-07 06:49:48,499 - INFO - Informed scheduler that task   Extract__99914b932b   has status   FAILED
2025-06-07 06:49:48,500 - DEBUG - Asking scheduler for work...
2025-06-07 06:49:48,502 - DEBUG - Done
2025-06-07 06:49:48,503 - DEBUG - There are no more tasks to run at this time
2025-06-07 06:49:48,505 - DEBUG - There are 2 pending tasks possibly being run by other workers
2025-06-07 06:49:48,506 - DEBUG - There are 2 pending tasks unique to this worker
2025-06-07 06:49:48,507 - DEBUG - There are 2 pending tasks last scheduled by this worker
2025-06-07 06:49:48,508 - INFO - Worker Worker(salt=8329747368, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) was stopped. Shutting down Keep-Alive thread
2025-06-07 06:49:48,514 - INFO - 
===== Luigi Execution Summary =====

Scheduled 2 tasks of which:
* 1 failed:
    - 1 Extract()
* 1 were left pending, among these:
    * 1 had failed dependencies:
        - 1 Load()

This progress looks :( because there were failed tasks

===== Luigi Execution Summary =====

2025-06-07 06:50:19,316 - INFO - logging already configured
2025-06-07 06:50:19,319 - DEBUG - Checking if Extract() is complete
2025-06-07 06:50:19,323 - INFO - Informed scheduler that task   Extract__99914b932b   has status   PENDING
2025-06-07 06:50:19,324 - INFO - Done scheduling tasks
2025-06-07 06:50:19,326 - INFO - Running Worker with 1 processes
2025-06-07 06:50:19,326 - DEBUG - Asking scheduler for work...
2025-06-07 06:50:19,327 - DEBUG - Pending tasks: 1
2025-06-07 06:50:19,329 - INFO - [pid 19900] Worker Worker(salt=3147536204, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) running   Extract()
2025-06-07 06:50:19,332 - INFO - ==================================STARTING EXTRACT DATA=======================================
2025-06-07 06:50:19,616 - INFO - EXTRACT 'public.geolocation' - SUCCESS.
2025-06-07 06:50:19,628 - INFO - EXTRACT 'public.product_category_name_translation' - SUCCESS.
2025-06-07 06:50:19,656 - INFO - EXTRACT 'public.sellers' - SUCCESS.
2025-06-07 06:50:20,673 - INFO - EXTRACT 'public.customers' - SUCCESS.
2025-06-07 06:50:21,242 - INFO - EXTRACT 'public.products' - SUCCESS.
2025-06-07 06:50:22,406 - INFO - EXTRACT 'public.orders' - SUCCESS.
2025-06-07 06:50:23,710 - INFO - EXTRACT 'public.order_items' - SUCCESS.
2025-06-07 06:50:24,611 - INFO - EXTRACT 'public.order_payments' - SUCCESS.
2025-06-07 06:50:25,668 - INFO - EXTRACT 'public.order_reviews' - SUCCESS.
2025-06-07 06:50:25,668 - INFO - Extract All Tables From Sources - SUCCESS
2025-06-07 06:50:25,668 - INFO - ==================================ENDING EXTRACT DATA=======================================
2025-06-07 06:50:25,685 - INFO - [pid 19900] Worker Worker(salt=3147536204, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) done      Extract()
2025-06-07 06:50:25,694 - DEBUG - 1 running tasks, waiting for next task to finish
2025-06-07 06:50:25,698 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2025-06-07 06:50:25,701 - DEBUG - Asking scheduler for work...
2025-06-07 06:50:25,703 - DEBUG - Done
2025-06-07 06:50:25,705 - DEBUG - There are no more tasks to run at this time
2025-06-07 06:50:25,705 - INFO - Worker Worker(salt=3147536204, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) was stopped. Shutting down Keep-Alive thread
2025-06-07 06:50:25,713 - INFO - 
===== Luigi Execution Summary =====

Scheduled 1 tasks of which:
* 1 ran successfully:
    - 1 Extract()

This progress looks :) because there were no failed tasks or missing dependencies

===== Luigi Execution Summary =====

2025-06-07 06:50:49,467 - INFO - logging already configured
2025-06-07 06:50:49,471 - DEBUG - Checking if Extract() is complete
2025-06-07 06:50:49,474 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2025-06-07 06:50:49,475 - DEBUG - Checking if Load() is complete
2025-06-07 06:50:49,478 - DEBUG - Checking if Extract() is complete
2025-06-07 06:50:49,480 - INFO - Informed scheduler that task   Load__99914b932b   has status   PENDING
2025-06-07 06:50:49,481 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2025-06-07 06:50:49,483 - INFO - Done scheduling tasks
2025-06-07 06:50:49,484 - INFO - Running Worker with 1 processes
2025-06-07 06:50:49,485 - DEBUG - Asking scheduler for work...
2025-06-07 06:50:49,486 - DEBUG - Pending tasks: 1
2025-06-07 06:50:49,488 - INFO - [pid 19900] Worker Worker(salt=4164087605, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) running   Load()
2025-06-07 06:50:49,516 - INFO - Read Load Query - SUCCESS
2025-06-07 06:50:51,650 - INFO - Read Extracted Data - SUCCESS
2025-06-07 06:50:51,651 - INFO - Connect to olist-dwh - SUCCESS
2025-06-07 06:50:51,838 - INFO - Truncate `public` Schema in olist-dwh - SUCCESS
2025-06-07 06:50:51,838 - INFO - ==================================STARTING LOAD DATA=======================================
2025-06-07 06:51:28,925 - ERROR - LOAD All Tables To olist-dwh-public - FAILED
2025-06-07 06:51:28,928 - ERROR - LOAD All Tables To DWH - FAILED
2025-06-07 06:51:28,928 - ERROR - [pid 19900] Worker Worker(salt=4164087605, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) failed    Load()
Traceback (most recent call last):
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 2118, in _exec_insertmany_context
    dialect.do_execute(
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedColumn: column "False" of relation "order_reviews" does not exist
LINE 1: INSERT INTO public.order_reviews ("False", review_id, order_...
                                          ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\LENOVO THINKPAD\AppData\Local\Temp\ipykernel_19900\3125753500.py", line 222, in run
    order_reviews.to_sql('order_reviews',
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\pandas\util\_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\pandas\core\generic.py", line 3087, in to_sql
    return sql.to_sql(
           ^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\pandas\io\sql.py", line 842, in to_sql
    return pandas_sql.to_sql(
           ^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\pandas\io\sql.py", line 2018, in to_sql
    total_inserted = sql_engine.insert_records(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\pandas\io\sql.py", line 1567, in insert_records
    raise err
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\pandas\io\sql.py", line 1558, in insert_records
    return table.insert(chunksize=chunksize, method=method)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\pandas\io\sql.py", line 1119, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\pandas\io\sql.py", line 1010, in _execute_insert
    result = conn.execute(self.table.insert(), data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1418, in execute
    return meth(
           ^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\sql\elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1844, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 2126, in _exec_insertmany_context
    self._handle_dbapi_exception(
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 2118, in _exec_insertmany_context
    dialect.do_execute(
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedColumn) column "False" of relation "order_reviews" does not exist
LINE 1: INSERT INTO public.order_reviews ("False", review_id, order_...
                                          ^

[SQL: INSERT INTO public.order_reviews ("False", review_id, order_id, review_score, review_comment_title, review_comment_message, review_creation_date) VALUES (%(False__0)s, %(review_id__0)s, %(order_id__0)s, %(review_score__0)s, %(review_comment_title__0) ... 174031 characters truncated ... 99)s, %(review_comment_title__999)s, %(review_comment_message__999)s, %(review_creation_date__999)s)]
[parameters: {'review_id__0': '7bc2406110b926393aa56f80a40eba40', 'review_comment_title__0': None, 'review_score__0': 4, 'order_id__0': '73fc7af87114b39712e6da79b0a377eb', 'review_comment_message__0': None, 'review_creation_date__0': '2018-01-18 21:46:59', 'False__0': 0, 'review_id__1': '80e641a11e56f04c1ad469d5645fdfde', 'review_comment_title__1': None, 'review_score__1': 5, 'order_id__1': 'a548910a1c6147796b98fdf73dbeba33', 'review_comment_message__1': None, 'review_creation_date__1': '2018-03-11 03:05:13', 'False__1': 1, 'review_id__2': '228ce5500dc1d8e020d8d1322874b6f0', 'review_comment_title__2': None, 'review_score__2': 5, 'order_id__2': 'f9e4b658b201a9f2ecdecbb34bed034b', 'review_comment_message__2': None, 'review_creation_date__2': '2018-02-18 14:36:24', 'False__2': 2, 'review_id__3': 'e64fb393e7b32834bb789ff8bb30750e', 'review_comment_title__3': None, 'review_score__3': 5, 'order_id__3': '658677c97b385a9be170737859d3511b', 'review_comment_message__3': 'Recebi bem antes do prazo estipulado.', 'review_creation_date__3': '2017-04-21 22:02:06', 'False__3': 3, 'review_id__4': 'f7c4243c7fe1938f181bec41a392bdeb', 'review_comment_title__4': None, 'review_score__4': 5, 'order_id__4': '8e6bfb81e283fa7e4f11123a3fb894f1', 'review_comment_message__4': 'Parabns lojas lannister adorei comprar pela Internet seguro e prtico Parabns a todos feliz Pscoa', 'review_creation_date__4': '2018-03-02 10:26:53', 'False__4': 4, 'review_id__5': '15197aa66ff4d0650b5434f1b46cda19', 'review_comment_title__5': None, 'review_score__5': 1, 'order_id__5': 'b18dcdf73be66366873cd26c5724d1dc', 'review_comment_message__5': None, 'review_creation_date__5': '2018-04-16 00:39:37', 'False__5': 5, 'review_id__6': '07f9bee5d1b850860defd761afa7ff16', 'review_comment_title__6': None, 'review_score__6': 5, 'order_id__6': 'e48aa0d2dcec3a2e87348811bcfdf22b', 'review_comment_message__6': None, 'review_creation_date__6': '2017-07-18 19:30:34', 'False__6': 6, 'review_id__7': '7c6400515c67679fbee952a7525281ef' ... 6900 parameters truncated ... 'False__992': 992, 'review_id__993': '6e6dbad466c0eef2b679927dfe89c052', 'review_comment_title__993': None, 'review_score__993': 4, 'order_id__993': '9d244b9671e094280e0da0b5edec38bb', 'review_comment_message__993': None, 'review_creation_date__993': '2018-04-13 13:03:21', 'False__993': 993, 'review_id__994': '0a354009b25a2fbe0b25a6dd5c2a00ac', 'review_comment_title__994': None, 'review_score__994': 5, 'order_id__994': '3b42ad87f3292fab60e143988d332da1', 'review_comment_message__994': None, 'review_creation_date__994': '2018-03-17 12:18:46', 'False__994': 994, 'review_id__995': 'affce0d83d9e8f6af570bc097c2e424f', 'review_comment_title__995': None, 'review_score__995': 2, 'order_id__995': '286a461fcd1b94e24227817fa93f8a57', 'review_comment_message__995': 'O produto no corresponde ao que eu comprei, a pelcula  muito menor que a tela do celular e no cobre toda a tela.', 'review_creation_date__995': '2018-03-23 18:24:18', 'False__995': 995, 'review_id__996': 'ca5bc3c72f83c6fb95f7f72b290a492c', 'review_comment_title__996': None, 'review_score__996': 5, 'order_id__996': '9e7752c172e3994115a2cd609a18de29', 'review_comment_message__996': 'produto conforme anunciado, e veio antes do prazo...perfeito', 'review_creation_date__996': '2017-09-12 20:58:07', 'False__996': 996, 'review_id__997': '4d59d6249215713bfda42353af53f255', 'review_comment_title__997': 'Produto entregue', 'review_score__997': 4, 'order_id__997': '4ab8b7a8e23908984157974ae4ad6436', 'review_comment_message__997': 'Produto bom e entregue antes do previsto.', 'review_creation_date__997': '2018-06-04 19:53:33', 'False__997': 997, 'review_id__998': 'eaeafb542d4447da454cf68e302ae2bf', 'review_comment_title__998': 'Boa', 'review_score__998': 4, 'order_id__998': 'b8615aa7e6248212cab23e120279acf2', 'review_comment_message__998': 'Ainda no usei em nenhuma viagem, mas parece ser muito boa.', 'review_creation_date__998': '2018-06-17 14:05:57', 'False__998': 998, 'review_id__999': '2282d9d2a99fa789b0eb9843cfeab97e', 'review_comment_title__999': None, 'review_score__999': 4, 'order_id__999': 'e1410714b40ecb7735ebc3f823d60745', 'review_comment_message__999': None, 'review_creation_date__999': '2018-08-22 02:00:13', 'False__999': 999}]
(Background on this error at: https://sqlalche.me/e/20/f405)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\LENOVO THINKPAD\AppData\Local\Temp\ipykernel_19900\3125753500.py", line 232, in run
    raise Exception('Failed Load Tables To olist-dwh-public')
Exception: Failed Load Tables To olist-dwh-public

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 210, in run
    new_deps = self._run_get_new_deps()
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 138, in _run_get_new_deps
    task_gen = self.task.run()
               ^^^^^^^^^^^^^^^
  File "C:\Users\LENOVO THINKPAD\AppData\Local\Temp\ipykernel_19900\3125753500.py", line 300, in run
    raise Exception('Failed Load Tables To DWH')
Exception: Failed Load Tables To DWH
2025-06-07 06:51:28,943 - DEBUG - 1 running tasks, waiting for next task to finish
2025-06-07 06:51:28,953 - INFO - Informed scheduler that task   Load__99914b932b   has status   FAILED
2025-06-07 06:51:28,954 - DEBUG - Asking scheduler for work...
2025-06-07 06:51:28,957 - DEBUG - Done
2025-06-07 06:51:28,958 - DEBUG - There are no more tasks to run at this time
2025-06-07 06:51:28,961 - DEBUG - There are 1 pending tasks possibly being run by other workers
2025-06-07 06:51:28,963 - DEBUG - There are 1 pending tasks unique to this worker
2025-06-07 06:51:28,967 - DEBUG - There are 1 pending tasks last scheduled by this worker
2025-06-07 06:51:28,970 - INFO - Worker Worker(salt=4164087605, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) was stopped. Shutting down Keep-Alive thread
2025-06-07 06:51:28,975 - INFO - 
===== Luigi Execution Summary =====

Scheduled 2 tasks of which:
* 1 complete ones were encountered:
    - 1 Extract()
* 1 failed:
    - 1 Load()

This progress looks :( because there were failed tasks

===== Luigi Execution Summary =====

2025-06-07 06:54:35,752 - INFO - logging already configured
2025-06-07 06:54:35,756 - DEBUG - Checking if Extract() is complete
2025-06-07 06:54:35,759 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2025-06-07 06:54:35,761 - DEBUG - Checking if Load() is complete
2025-06-07 06:54:35,764 - INFO - Informed scheduler that task   Load__99914b932b   has status   DONE
2025-06-07 06:54:35,764 - INFO - Done scheduling tasks
2025-06-07 06:54:35,764 - INFO - Running Worker with 1 processes
2025-06-07 06:54:35,764 - DEBUG - Asking scheduler for work...
2025-06-07 06:54:35,764 - DEBUG - Done
2025-06-07 06:54:35,764 - DEBUG - There are no more tasks to run at this time
2025-06-07 06:54:35,764 - INFO - Worker Worker(salt=6204726538, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) was stopped. Shutting down Keep-Alive thread
2025-06-07 06:54:35,790 - INFO - 
===== Luigi Execution Summary =====

Scheduled 2 tasks of which:
* 2 complete ones were encountered:
    - 1 Extract()
    - 1 Load()

Did not run any tasks
This progress looks :) because there were no failed tasks or missing dependencies

===== Luigi Execution Summary =====

2025-06-07 06:54:42,205 - INFO - logging already configured
2025-06-07 06:54:42,208 - DEBUG - Checking if Extract() is complete
2025-06-07 06:54:42,211 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2025-06-07 06:54:42,212 - DEBUG - Checking if Load() is complete
2025-06-07 06:54:42,214 - INFO - Informed scheduler that task   Load__99914b932b   has status   DONE
2025-06-07 06:54:42,216 - INFO - Done scheduling tasks
2025-06-07 06:54:42,217 - INFO - Running Worker with 1 processes
2025-06-07 06:54:42,218 - DEBUG - Asking scheduler for work...
2025-06-07 06:54:42,219 - DEBUG - Done
2025-06-07 06:54:42,221 - DEBUG - There are no more tasks to run at this time
2025-06-07 06:54:42,222 - INFO - Worker Worker(salt=8394348347, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) was stopped. Shutting down Keep-Alive thread
2025-06-07 06:54:42,244 - INFO - 
===== Luigi Execution Summary =====

Scheduled 2 tasks of which:
* 2 complete ones were encountered:
    - 1 Extract()
    - 1 Load()

Did not run any tasks
This progress looks :) because there were no failed tasks or missing dependencies

===== Luigi Execution Summary =====

2025-06-07 06:54:42,688 - INFO - logging already configured
2025-06-07 06:54:42,692 - DEBUG - Checking if Extract() is complete
2025-06-07 06:54:42,693 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2025-06-07 06:54:42,695 - DEBUG - Checking if Load() is complete
2025-06-07 06:54:42,696 - INFO - Informed scheduler that task   Load__99914b932b   has status   DONE
2025-06-07 06:54:42,698 - INFO - Done scheduling tasks
2025-06-07 06:54:42,700 - INFO - Running Worker with 1 processes
2025-06-07 06:54:42,700 - DEBUG - Asking scheduler for work...
2025-06-07 06:54:42,701 - DEBUG - Done
2025-06-07 06:54:42,703 - DEBUG - There are no more tasks to run at this time
2025-06-07 06:54:42,706 - INFO - Worker Worker(salt=3126779409, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) was stopped. Shutting down Keep-Alive thread
2025-06-07 06:54:42,712 - INFO - 
===== Luigi Execution Summary =====

Scheduled 2 tasks of which:
* 2 complete ones were encountered:
    - 1 Extract()
    - 1 Load()

Did not run any tasks
This progress looks :) because there were no failed tasks or missing dependencies

===== Luigi Execution Summary =====

2025-06-07 06:54:43,362 - INFO - logging already configured
2025-06-07 06:54:43,366 - DEBUG - Checking if Extract() is complete
2025-06-07 06:54:43,369 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2025-06-07 06:54:43,370 - DEBUG - Checking if Load() is complete
2025-06-07 06:54:43,372 - INFO - Informed scheduler that task   Load__99914b932b   has status   DONE
2025-06-07 06:54:43,373 - INFO - Done scheduling tasks
2025-06-07 06:54:43,374 - INFO - Running Worker with 1 processes
2025-06-07 06:54:43,375 - DEBUG - Asking scheduler for work...
2025-06-07 06:54:43,376 - DEBUG - Done
2025-06-07 06:54:43,377 - DEBUG - There are no more tasks to run at this time
2025-06-07 06:54:43,379 - INFO - Worker Worker(salt=6578868203, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) was stopped. Shutting down Keep-Alive thread
2025-06-07 06:54:43,385 - INFO - 
===== Luigi Execution Summary =====

Scheduled 2 tasks of which:
* 2 complete ones were encountered:
    - 1 Extract()
    - 1 Load()

Did not run any tasks
This progress looks :) because there were no failed tasks or missing dependencies

===== Luigi Execution Summary =====

2025-06-07 06:54:43,539 - INFO - logging already configured
2025-06-07 06:54:43,543 - DEBUG - Checking if Extract() is complete
2025-06-07 06:54:43,545 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2025-06-07 06:54:43,546 - DEBUG - Checking if Load() is complete
2025-06-07 06:54:43,548 - INFO - Informed scheduler that task   Load__99914b932b   has status   DONE
2025-06-07 06:54:43,549 - INFO - Done scheduling tasks
2025-06-07 06:54:43,551 - INFO - Running Worker with 1 processes
2025-06-07 06:54:43,552 - DEBUG - Asking scheduler for work...
2025-06-07 06:54:43,554 - DEBUG - Done
2025-06-07 06:54:43,555 - DEBUG - There are no more tasks to run at this time
2025-06-07 06:54:43,557 - INFO - Worker Worker(salt=8166513180, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) was stopped. Shutting down Keep-Alive thread
2025-06-07 06:54:43,562 - INFO - 
===== Luigi Execution Summary =====

Scheduled 2 tasks of which:
* 2 complete ones were encountered:
    - 1 Extract()
    - 1 Load()

Did not run any tasks
This progress looks :) because there were no failed tasks or missing dependencies

===== Luigi Execution Summary =====

2025-06-07 06:54:43,724 - INFO - logging already configured
2025-06-07 06:54:43,734 - DEBUG - Checking if Extract() is complete
2025-06-07 06:54:43,739 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2025-06-07 06:54:43,739 - DEBUG - Checking if Load() is complete
2025-06-07 06:54:43,742 - INFO - Informed scheduler that task   Load__99914b932b   has status   DONE
2025-06-07 06:54:43,743 - INFO - Done scheduling tasks
2025-06-07 06:54:43,746 - INFO - Running Worker with 1 processes
2025-06-07 06:54:43,748 - DEBUG - Asking scheduler for work...
2025-06-07 06:54:43,750 - DEBUG - Done
2025-06-07 06:54:43,752 - DEBUG - There are no more tasks to run at this time
2025-06-07 06:54:43,754 - INFO - Worker Worker(salt=5648625690, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) was stopped. Shutting down Keep-Alive thread
2025-06-07 06:54:43,762 - INFO - 
===== Luigi Execution Summary =====

Scheduled 2 tasks of which:
* 2 complete ones were encountered:
    - 1 Extract()
    - 1 Load()

Did not run any tasks
This progress looks :) because there were no failed tasks or missing dependencies

===== Luigi Execution Summary =====

2025-06-07 06:54:47,060 - INFO - logging already configured
2025-06-07 06:54:47,064 - DEBUG - Checking if Extract() is complete
2025-06-07 06:54:47,066 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2025-06-07 06:54:47,068 - DEBUG - Checking if Load() is complete
2025-06-07 06:54:47,072 - INFO - Informed scheduler that task   Load__99914b932b   has status   DONE
2025-06-07 06:54:47,073 - INFO - Done scheduling tasks
2025-06-07 06:54:47,073 - INFO - Running Worker with 1 processes
2025-06-07 06:54:47,073 - DEBUG - Asking scheduler for work...
2025-06-07 06:54:47,073 - DEBUG - Done
2025-06-07 06:54:47,073 - DEBUG - There are no more tasks to run at this time
2025-06-07 06:54:47,073 - INFO - Worker Worker(salt=5793901047, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) was stopped. Shutting down Keep-Alive thread
2025-06-07 06:54:47,081 - INFO - 
===== Luigi Execution Summary =====

Scheduled 2 tasks of which:
* 2 complete ones were encountered:
    - 1 Extract()
    - 1 Load()

Did not run any tasks
This progress looks :) because there were no failed tasks or missing dependencies

===== Luigi Execution Summary =====

2025-06-07 06:54:47,689 - INFO - logging already configured
2025-06-07 06:54:47,694 - DEBUG - Checking if Extract() is complete
2025-06-07 06:54:47,698 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2025-06-07 06:54:47,699 - DEBUG - Checking if Load() is complete
2025-06-07 06:54:47,701 - INFO - Informed scheduler that task   Load__99914b932b   has status   DONE
2025-06-07 06:54:47,702 - INFO - Done scheduling tasks
2025-06-07 06:54:47,704 - INFO - Running Worker with 1 processes
2025-06-07 06:54:47,705 - DEBUG - Asking scheduler for work...
2025-06-07 06:54:47,708 - DEBUG - Done
2025-06-07 06:54:47,709 - DEBUG - There are no more tasks to run at this time
2025-06-07 06:54:47,710 - INFO - Worker Worker(salt=3572132642, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) was stopped. Shutting down Keep-Alive thread
2025-06-07 06:54:47,716 - INFO - 
===== Luigi Execution Summary =====

Scheduled 2 tasks of which:
* 2 complete ones were encountered:
    - 1 Extract()
    - 1 Load()

Did not run any tasks
This progress looks :) because there were no failed tasks or missing dependencies

===== Luigi Execution Summary =====

2025-06-07 06:54:47,952 - INFO - logging already configured
2025-06-07 06:54:47,957 - DEBUG - Checking if Extract() is complete
2025-06-07 06:54:47,961 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2025-06-07 06:54:47,963 - DEBUG - Checking if Load() is complete
2025-06-07 06:54:47,966 - INFO - Informed scheduler that task   Load__99914b932b   has status   DONE
2025-06-07 06:54:47,968 - INFO - Done scheduling tasks
2025-06-07 06:54:47,969 - INFO - Running Worker with 1 processes
2025-06-07 06:54:47,970 - DEBUG - Asking scheduler for work...
2025-06-07 06:54:47,970 - DEBUG - Done
2025-06-07 06:54:47,970 - DEBUG - There are no more tasks to run at this time
2025-06-07 06:54:47,974 - INFO - Worker Worker(salt=389317761, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) was stopped. Shutting down Keep-Alive thread
2025-06-07 06:54:47,978 - INFO - 
===== Luigi Execution Summary =====

Scheduled 2 tasks of which:
* 2 complete ones were encountered:
    - 1 Extract()
    - 1 Load()

Did not run any tasks
This progress looks :) because there were no failed tasks or missing dependencies

===== Luigi Execution Summary =====

2025-06-07 06:54:48,110 - INFO - logging already configured
2025-06-07 06:54:48,119 - DEBUG - Checking if Extract() is complete
2025-06-07 06:54:48,124 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2025-06-07 06:54:48,125 - DEBUG - Checking if Load() is complete
2025-06-07 06:54:48,128 - INFO - Informed scheduler that task   Load__99914b932b   has status   DONE
2025-06-07 06:54:48,130 - INFO - Done scheduling tasks
2025-06-07 06:54:48,131 - INFO - Running Worker with 1 processes
2025-06-07 06:54:48,133 - DEBUG - Asking scheduler for work...
2025-06-07 06:54:48,134 - DEBUG - Done
2025-06-07 06:54:48,136 - DEBUG - There are no more tasks to run at this time
2025-06-07 06:54:48,138 - INFO - Worker Worker(salt=7252796633, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) was stopped. Shutting down Keep-Alive thread
2025-06-07 06:54:48,145 - INFO - 
===== Luigi Execution Summary =====

Scheduled 2 tasks of which:
* 2 complete ones were encountered:
    - 1 Extract()
    - 1 Load()

Did not run any tasks
This progress looks :) because there were no failed tasks or missing dependencies

===== Luigi Execution Summary =====

2025-06-07 06:54:48,460 - INFO - logging already configured
2025-06-07 06:54:48,465 - DEBUG - Checking if Extract() is complete
2025-06-07 06:54:48,466 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2025-06-07 06:54:48,469 - DEBUG - Checking if Load() is complete
2025-06-07 06:54:48,471 - INFO - Informed scheduler that task   Load__99914b932b   has status   DONE
2025-06-07 06:54:48,472 - INFO - Done scheduling tasks
2025-06-07 06:54:48,472 - INFO - Running Worker with 1 processes
2025-06-07 06:54:48,472 - DEBUG - Asking scheduler for work...
2025-06-07 06:54:48,472 - DEBUG - Done
2025-06-07 06:54:48,472 - DEBUG - There are no more tasks to run at this time
2025-06-07 06:54:48,477 - INFO - Worker Worker(salt=7160007190, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) was stopped. Shutting down Keep-Alive thread
2025-06-07 06:54:48,477 - INFO - 
===== Luigi Execution Summary =====

Scheduled 2 tasks of which:
* 2 complete ones were encountered:
    - 1 Extract()
    - 1 Load()

Did not run any tasks
This progress looks :) because there were no failed tasks or missing dependencies

===== Luigi Execution Summary =====

2025-06-07 06:54:48,678 - INFO - logging already configured
2025-06-07 06:54:48,682 - DEBUG - Checking if Extract() is complete
2025-06-07 06:54:48,682 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2025-06-07 06:54:48,682 - DEBUG - Checking if Load() is complete
2025-06-07 06:54:48,682 - INFO - Informed scheduler that task   Load__99914b932b   has status   DONE
2025-06-07 06:54:48,691 - INFO - Done scheduling tasks
2025-06-07 06:54:48,691 - INFO - Running Worker with 1 processes
2025-06-07 06:54:48,693 - DEBUG - Asking scheduler for work...
2025-06-07 06:54:48,693 - DEBUG - Done
2025-06-07 06:54:48,693 - DEBUG - There are no more tasks to run at this time
2025-06-07 06:54:48,693 - INFO - Worker Worker(salt=1540900157, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) was stopped. Shutting down Keep-Alive thread
2025-06-07 06:54:48,699 - INFO - 
===== Luigi Execution Summary =====

Scheduled 2 tasks of which:
* 2 complete ones were encountered:
    - 1 Extract()
    - 1 Load()

Did not run any tasks
This progress looks :) because there were no failed tasks or missing dependencies

===== Luigi Execution Summary =====

2025-06-07 06:54:48,840 - INFO - logging already configured
2025-06-07 06:54:48,842 - DEBUG - Checking if Extract() is complete
2025-06-07 06:54:48,842 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2025-06-07 06:54:48,842 - DEBUG - Checking if Load() is complete
2025-06-07 06:54:48,849 - INFO - Informed scheduler that task   Load__99914b932b   has status   DONE
2025-06-07 06:54:48,851 - INFO - Done scheduling tasks
2025-06-07 06:54:48,852 - INFO - Running Worker with 1 processes
2025-06-07 06:54:48,854 - DEBUG - Asking scheduler for work...
2025-06-07 06:54:48,855 - DEBUG - Done
2025-06-07 06:54:48,857 - DEBUG - There are no more tasks to run at this time
2025-06-07 06:54:48,859 - INFO - Worker Worker(salt=5692974220, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) was stopped. Shutting down Keep-Alive thread
2025-06-07 06:54:48,863 - INFO - 
===== Luigi Execution Summary =====

Scheduled 2 tasks of which:
* 2 complete ones were encountered:
    - 1 Extract()
    - 1 Load()

Did not run any tasks
This progress looks :) because there were no failed tasks or missing dependencies

===== Luigi Execution Summary =====

2025-06-07 06:54:48,995 - INFO - logging already configured
2025-06-07 06:54:48,995 - DEBUG - Checking if Extract() is complete
2025-06-07 06:54:49,004 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2025-06-07 06:54:49,005 - DEBUG - Checking if Load() is complete
2025-06-07 06:54:49,007 - INFO - Informed scheduler that task   Load__99914b932b   has status   DONE
2025-06-07 06:54:49,010 - INFO - Done scheduling tasks
2025-06-07 06:54:49,010 - INFO - Running Worker with 1 processes
2025-06-07 06:54:49,013 - DEBUG - Asking scheduler for work...
2025-06-07 06:54:49,014 - DEBUG - Done
2025-06-07 06:54:49,015 - DEBUG - There are no more tasks to run at this time
2025-06-07 06:54:49,016 - INFO - Worker Worker(salt=1441657143, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) was stopped. Shutting down Keep-Alive thread
2025-06-07 06:54:49,021 - INFO - 
===== Luigi Execution Summary =====

Scheduled 2 tasks of which:
* 2 complete ones were encountered:
    - 1 Extract()
    - 1 Load()

Did not run any tasks
This progress looks :) because there were no failed tasks or missing dependencies

===== Luigi Execution Summary =====

2025-06-07 06:54:49,203 - INFO - logging already configured
2025-06-07 06:54:49,207 - DEBUG - Checking if Extract() is complete
2025-06-07 06:54:49,210 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2025-06-07 06:54:49,211 - DEBUG - Checking if Load() is complete
2025-06-07 06:54:49,214 - INFO - Informed scheduler that task   Load__99914b932b   has status   DONE
2025-06-07 06:54:49,214 - INFO - Done scheduling tasks
2025-06-07 06:54:49,215 - INFO - Running Worker with 1 processes
2025-06-07 06:54:49,217 - DEBUG - Asking scheduler for work...
2025-06-07 06:54:49,219 - DEBUG - Done
2025-06-07 06:54:49,219 - DEBUG - There are no more tasks to run at this time
2025-06-07 06:54:49,220 - INFO - Worker Worker(salt=683426956, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) was stopped. Shutting down Keep-Alive thread
2025-06-07 06:54:49,223 - INFO - 
===== Luigi Execution Summary =====

Scheduled 2 tasks of which:
* 2 complete ones were encountered:
    - 1 Extract()
    - 1 Load()

Did not run any tasks
This progress looks :) because there were no failed tasks or missing dependencies

===== Luigi Execution Summary =====

2025-06-07 06:55:08,110 - INFO - logging already configured
2025-06-07 06:55:08,115 - DEBUG - Checking if Extract() is complete
2025-06-07 06:55:08,123 - INFO - Informed scheduler that task   Extract__99914b932b   has status   PENDING
2025-06-07 06:55:08,126 - DEBUG - Checking if Load() is complete
2025-06-07 06:55:08,131 - DEBUG - Checking if Extract() is complete
2025-06-07 06:55:08,152 - INFO - Informed scheduler that task   Load__99914b932b   has status   PENDING
2025-06-07 06:55:08,154 - INFO - Informed scheduler that task   Extract__99914b932b   has status   PENDING
2025-06-07 06:55:08,156 - INFO - Done scheduling tasks
2025-06-07 06:55:08,158 - INFO - Running Worker with 1 processes
2025-06-07 06:55:08,160 - DEBUG - Asking scheduler for work...
2025-06-07 06:55:08,163 - DEBUG - Pending tasks: 2
2025-06-07 06:55:08,166 - INFO - [pid 19900] Worker Worker(salt=7572204363, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) running   Extract()
2025-06-07 06:55:08,172 - ERROR - [pid 19900] Worker Worker(salt=7572204363, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) failed    Extract()
Traceback (most recent call last):
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 210, in run
    new_deps = self._run_get_new_deps()
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 138, in _run_get_new_deps
    task_gen = self.task.run()
               ^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\Documents\Github\Pacmann---Data-Storage_-Warehouse--Mart---Lake\mentoring 2\olist-dwh-project\pipeline\extract.py", line 43, in run
    os.makedirs(os.path.dirname(self.output().path), exist_ok=True)
                                ^^^^^^^^^^^^^^^^^^
AttributeError: 'list' object has no attribute 'path'
2025-06-07 06:55:08,178 - DEBUG - 1 running tasks, waiting for next task to finish
2025-06-07 06:55:08,185 - INFO - Informed scheduler that task   Extract__99914b932b   has status   FAILED
2025-06-07 06:55:08,187 - DEBUG - Asking scheduler for work...
2025-06-07 06:55:08,189 - DEBUG - Done
2025-06-07 06:55:08,191 - DEBUG - There are no more tasks to run at this time
2025-06-07 06:55:08,193 - DEBUG - There are 2 pending tasks possibly being run by other workers
2025-06-07 06:55:08,195 - DEBUG - There are 2 pending tasks unique to this worker
2025-06-07 06:55:08,197 - DEBUG - There are 2 pending tasks last scheduled by this worker
2025-06-07 06:55:08,199 - INFO - Worker Worker(salt=7572204363, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) was stopped. Shutting down Keep-Alive thread
2025-06-07 06:55:08,205 - INFO - 
===== Luigi Execution Summary =====

Scheduled 2 tasks of which:
* 1 failed:
    - 1 Extract()
* 1 were left pending, among these:
    * 1 had failed dependencies:
        - 1 Load()

This progress looks :( because there were failed tasks

===== Luigi Execution Summary =====

2025-06-07 06:55:15,746 - INFO - logging already configured
2025-06-07 06:55:15,751 - DEBUG - Checking if Extract() is complete
2025-06-07 06:55:15,753 - INFO - Informed scheduler that task   Extract__99914b932b   has status   PENDING
2025-06-07 06:55:15,754 - DEBUG - Checking if Load() is complete
2025-06-07 06:55:15,756 - DEBUG - Checking if Extract() is complete
2025-06-07 06:55:15,757 - INFO - Informed scheduler that task   Load__99914b932b   has status   PENDING
2025-06-07 06:55:15,760 - INFO - Informed scheduler that task   Extract__99914b932b   has status   PENDING
2025-06-07 06:55:15,762 - INFO - Done scheduling tasks
2025-06-07 06:55:15,762 - INFO - Running Worker with 1 processes
2025-06-07 06:55:15,764 - DEBUG - Asking scheduler for work...
2025-06-07 06:55:15,765 - DEBUG - Pending tasks: 2
2025-06-07 06:55:15,767 - INFO - [pid 19900] Worker Worker(salt=9192871619, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) running   Extract()
2025-06-07 06:55:15,768 - ERROR - [pid 19900] Worker Worker(salt=9192871619, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) failed    Extract()
Traceback (most recent call last):
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 210, in run
    new_deps = self._run_get_new_deps()
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 138, in _run_get_new_deps
    task_gen = self.task.run()
               ^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\Documents\Github\Pacmann---Data-Storage_-Warehouse--Mart---Lake\mentoring 2\olist-dwh-project\pipeline\extract.py", line 43, in run
    os.makedirs(os.path.dirname(self.output().path), exist_ok=True)
                                ^^^^^^^^^^^^^^^^^^
AttributeError: 'list' object has no attribute 'path'
2025-06-07 06:55:15,774 - DEBUG - 1 running tasks, waiting for next task to finish
2025-06-07 06:55:15,780 - INFO - Informed scheduler that task   Extract__99914b932b   has status   FAILED
2025-06-07 06:55:15,780 - DEBUG - Asking scheduler for work...
2025-06-07 06:55:15,785 - DEBUG - Done
2025-06-07 06:55:15,785 - DEBUG - There are no more tasks to run at this time
2025-06-07 06:55:15,787 - DEBUG - There are 2 pending tasks possibly being run by other workers
2025-06-07 06:55:15,787 - DEBUG - There are 2 pending tasks unique to this worker
2025-06-07 06:55:15,787 - DEBUG - There are 2 pending tasks last scheduled by this worker
2025-06-07 06:55:15,787 - INFO - Worker Worker(salt=9192871619, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) was stopped. Shutting down Keep-Alive thread
2025-06-07 06:55:15,795 - INFO - 
===== Luigi Execution Summary =====

Scheduled 2 tasks of which:
* 1 failed:
    - 1 Extract()
* 1 were left pending, among these:
    * 1 had failed dependencies:
        - 1 Load()

This progress looks :( because there were failed tasks

===== Luigi Execution Summary =====

2025-06-07 06:55:49,860 - INFO - logging already configured
2025-06-07 06:55:49,863 - DEBUG - Checking if Extract() is complete
2025-06-07 06:55:49,866 - INFO - Informed scheduler that task   Extract__99914b932b   has status   PENDING
2025-06-07 06:55:49,868 - INFO - Done scheduling tasks
2025-06-07 06:55:49,869 - INFO - Running Worker with 1 processes
2025-06-07 06:55:49,870 - DEBUG - Asking scheduler for work...
2025-06-07 06:55:49,871 - DEBUG - Pending tasks: 1
2025-06-07 06:55:49,873 - INFO - [pid 19900] Worker Worker(salt=6444628346, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) running   Extract()
2025-06-07 06:55:49,877 - INFO - ==================================STARTING EXTRACT DATA=======================================
2025-06-07 06:55:50,215 - INFO - EXTRACT 'public.geolocation' - SUCCESS.
2025-06-07 06:55:50,229 - INFO - EXTRACT 'public.product_category_name_translation' - SUCCESS.
2025-06-07 06:55:50,257 - INFO - EXTRACT 'public.sellers' - SUCCESS.
2025-06-07 06:55:51,122 - INFO - EXTRACT 'public.customers' - SUCCESS.
2025-06-07 06:55:51,588 - INFO - EXTRACT 'public.products' - SUCCESS.
2025-06-07 06:55:52,746 - INFO - EXTRACT 'public.orders' - SUCCESS.
2025-06-07 06:55:54,064 - INFO - EXTRACT 'public.order_items' - SUCCESS.
2025-06-07 06:55:54,970 - INFO - EXTRACT 'public.order_payments' - SUCCESS.
2025-06-07 06:55:56,159 - INFO - EXTRACT 'public.order_reviews' - SUCCESS.
2025-06-07 06:55:56,159 - INFO - Extract All Tables From Sources - SUCCESS
2025-06-07 06:55:56,159 - INFO - ==================================ENDING EXTRACT DATA=======================================
2025-06-07 06:55:56,178 - INFO - [pid 19900] Worker Worker(salt=6444628346, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) done      Extract()
2025-06-07 06:55:56,181 - DEBUG - 1 running tasks, waiting for next task to finish
2025-06-07 06:55:56,185 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2025-06-07 06:55:56,187 - DEBUG - Asking scheduler for work...
2025-06-07 06:55:56,187 - DEBUG - Done
2025-06-07 06:55:56,187 - DEBUG - There are no more tasks to run at this time
2025-06-07 06:55:56,193 - INFO - Worker Worker(salt=6444628346, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) was stopped. Shutting down Keep-Alive thread
2025-06-07 06:55:56,195 - INFO - 
===== Luigi Execution Summary =====

Scheduled 1 tasks of which:
* 1 ran successfully:
    - 1 Extract()

This progress looks :) because there were no failed tasks or missing dependencies

===== Luigi Execution Summary =====

2025-06-07 06:56:06,120 - INFO - logging already configured
2025-06-07 06:56:06,124 - DEBUG - Checking if Extract() is complete
2025-06-07 06:56:06,126 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2025-06-07 06:56:06,127 - DEBUG - Checking if Load() is complete
2025-06-07 06:56:06,129 - DEBUG - Checking if Extract() is complete
2025-06-07 06:56:06,132 - INFO - Informed scheduler that task   Load__99914b932b   has status   PENDING
2025-06-07 06:56:06,132 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2025-06-07 06:56:06,134 - INFO - Done scheduling tasks
2025-06-07 06:56:06,135 - INFO - Running Worker with 1 processes
2025-06-07 06:56:06,137 - DEBUG - Asking scheduler for work...
2025-06-07 06:56:06,138 - DEBUG - Pending tasks: 1
2025-06-07 06:56:06,140 - INFO - [pid 19900] Worker Worker(salt=6486223527, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) running   Load()
2025-06-07 06:56:06,145 - INFO - Read Load Query - SUCCESS
2025-06-07 06:56:08,197 - INFO - Read Extracted Data - SUCCESS
2025-06-07 06:56:08,201 - INFO - Connect to olist-dwh - SUCCESS
2025-06-07 06:56:08,434 - INFO - Truncate `public` Schema in olist-dwh - SUCCESS
2025-06-07 06:56:08,434 - INFO - ==================================STARTING LOAD DATA=======================================
2025-06-07 06:56:52,201 - INFO - LOAD All Tables To olist-dwh-public - SUCCESS
2025-06-07 06:56:52,304 - ERROR - LOAD All Tables To DWH-Staging - FAILED
2025-06-07 06:56:52,306 - ERROR - LOAD All Tables To DWH - FAILED
2025-06-07 06:56:52,309 - ERROR - [pid 19900] Worker Worker(salt=6486223527, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) failed    Load()
Traceback (most recent call last):
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedTable: relation "public.product_name_category_translation" does not exist
LINE 7: FROM public.product_name_category_translation
             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\LENOVO THINKPAD\AppData\Local\Temp\ipykernel_19900\922383790.py", line 250, in run
    session.execute(query)
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\orm\session.py", line 2362, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\orm\session.py", line 2256, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1418, in execute
    return meth(
           ^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\sql\elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedTable) relation "public.product_name_category_translation" does not exist
LINE 7: FROM public.product_name_category_translation
             ^

[SQL: INSERT INTO stg.product_category_name_translation 
    (product_category_name, 
    product_category_name_english) 
SELECT
    product_category_name, 
    product_category_name_english
FROM public.product_name_category_translation

ON CONFLICT(product_category_name) DO NOTHING;]
(Background on this error at: https://sqlalche.me/e/20/f405)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\LENOVO THINKPAD\AppData\Local\Temp\ipykernel_19900\922383790.py", line 261, in run
    raise Exception('Failed Load Tables To DWH-Staging')
Exception: Failed Load Tables To DWH-Staging

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 210, in run
    new_deps = self._run_get_new_deps()
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 138, in _run_get_new_deps
    task_gen = self.task.run()
               ^^^^^^^^^^^^^^^
  File "C:\Users\LENOVO THINKPAD\AppData\Local\Temp\ipykernel_19900\922383790.py", line 300, in run
    raise Exception('Failed Load Tables To DWH')
Exception: Failed Load Tables To DWH
2025-06-07 06:56:52,360 - DEBUG - 1 running tasks, waiting for next task to finish
2025-06-07 06:56:52,375 - INFO - Informed scheduler that task   Load__99914b932b   has status   FAILED
2025-06-07 06:56:52,375 - DEBUG - Asking scheduler for work...
2025-06-07 06:56:52,378 - DEBUG - Done
2025-06-07 06:56:52,378 - DEBUG - There are no more tasks to run at this time
2025-06-07 06:56:52,378 - DEBUG - There are 1 pending tasks possibly being run by other workers
2025-06-07 06:56:52,382 - DEBUG - There are 1 pending tasks unique to this worker
2025-06-07 06:56:52,382 - DEBUG - There are 1 pending tasks last scheduled by this worker
2025-06-07 06:56:52,382 - INFO - Worker Worker(salt=6486223527, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) was stopped. Shutting down Keep-Alive thread
2025-06-07 06:56:52,393 - INFO - 
===== Luigi Execution Summary =====

Scheduled 2 tasks of which:
* 1 complete ones were encountered:
    - 1 Extract()
* 1 failed:
    - 1 Load()

This progress looks :( because there were failed tasks

===== Luigi Execution Summary =====

2025-06-07 07:44:33,718 - INFO - logging already configured
2025-06-07 07:44:33,720 - DEBUG - Checking if Extract() is complete
2025-06-07 07:44:33,722 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2025-06-07 07:44:33,723 - DEBUG - Checking if Load() is complete
2025-06-07 07:44:33,725 - INFO - Informed scheduler that task   Load__99914b932b   has status   DONE
2025-06-07 07:44:33,726 - INFO - Done scheduling tasks
2025-06-07 07:44:33,726 - INFO - Running Worker with 1 processes
2025-06-07 07:44:33,727 - DEBUG - Asking scheduler for work...
2025-06-07 07:44:33,728 - DEBUG - Done
2025-06-07 07:44:33,728 - DEBUG - There are no more tasks to run at this time
2025-06-07 07:44:33,728 - INFO - Worker Worker(salt=5355252032, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) was stopped. Shutting down Keep-Alive thread
2025-06-07 07:44:33,732 - INFO - 
===== Luigi Execution Summary =====

Scheduled 2 tasks of which:
* 2 complete ones were encountered:
    - 1 Extract()
    - 1 Load()

Did not run any tasks
This progress looks :) because there were no failed tasks or missing dependencies

===== Luigi Execution Summary =====

2025-06-07 07:45:13,533 - INFO - logging already configured
2025-06-07 07:45:13,535 - DEBUG - Checking if Extract() is complete
2025-06-07 07:45:13,537 - INFO - Informed scheduler that task   Extract__99914b932b   has status   PENDING
2025-06-07 07:45:13,537 - DEBUG - Checking if Load() is complete
2025-06-07 07:45:13,539 - DEBUG - Checking if Extract() is complete
2025-06-07 07:45:13,540 - INFO - Informed scheduler that task   Load__99914b932b   has status   PENDING
2025-06-07 07:45:13,541 - INFO - Informed scheduler that task   Extract__99914b932b   has status   PENDING
2025-06-07 07:45:13,541 - INFO - Done scheduling tasks
2025-06-07 07:45:13,543 - INFO - Running Worker with 1 processes
2025-06-07 07:45:13,543 - DEBUG - Asking scheduler for work...
2025-06-07 07:45:13,544 - DEBUG - Pending tasks: 2
2025-06-07 07:45:13,544 - INFO - [pid 19900] Worker Worker(salt=6623380385, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) running   Extract()
2025-06-07 07:45:13,545 - ERROR - [pid 19900] Worker Worker(salt=6623380385, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) failed    Extract()
Traceback (most recent call last):
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 210, in run
    new_deps = self._run_get_new_deps()
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 138, in _run_get_new_deps
    task_gen = self.task.run()
               ^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\Documents\Github\Pacmann---Data-Storage_-Warehouse--Mart---Lake\mentoring 2\olist-dwh-project\pipeline\extract.py", line 43, in run
    os.makedirs(os.path.dirname(self.output().path), exist_ok=True)
                                ^^^^^^^^^^^^^^^^^^
AttributeError: 'list' object has no attribute 'path'
2025-06-07 07:45:13,548 - DEBUG - 1 running tasks, waiting for next task to finish
2025-06-07 07:45:13,551 - INFO - Informed scheduler that task   Extract__99914b932b   has status   FAILED
2025-06-07 07:45:13,552 - DEBUG - Asking scheduler for work...
2025-06-07 07:45:13,553 - DEBUG - Done
2025-06-07 07:45:13,553 - DEBUG - There are no more tasks to run at this time
2025-06-07 07:45:13,554 - DEBUG - There are 2 pending tasks possibly being run by other workers
2025-06-07 07:45:13,554 - DEBUG - There are 2 pending tasks unique to this worker
2025-06-07 07:45:13,555 - DEBUG - There are 2 pending tasks last scheduled by this worker
2025-06-07 07:45:13,557 - INFO - Worker Worker(salt=6623380385, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) was stopped. Shutting down Keep-Alive thread
2025-06-07 07:45:13,560 - INFO - 
===== Luigi Execution Summary =====

Scheduled 2 tasks of which:
* 1 failed:
    - 1 Extract()
* 1 were left pending, among these:
    * 1 had failed dependencies:
        - 1 Load()

This progress looks :( because there were failed tasks

===== Luigi Execution Summary =====

2025-06-07 07:45:22,941 - INFO - logging already configured
2025-06-07 07:45:22,943 - DEBUG - Checking if Extract() is complete
2025-06-07 07:45:22,944 - INFO - Informed scheduler that task   Extract__99914b932b   has status   PENDING
2025-06-07 07:45:22,945 - INFO - Done scheduling tasks
2025-06-07 07:45:22,946 - INFO - Running Worker with 1 processes
2025-06-07 07:45:22,946 - DEBUG - Asking scheduler for work...
2025-06-07 07:45:22,947 - DEBUG - Pending tasks: 1
2025-06-07 07:45:22,948 - INFO - [pid 19900] Worker Worker(salt=8085817497, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) running   Extract()
2025-06-07 07:45:22,951 - INFO - ==================================STARTING EXTRACT DATA=======================================
2025-06-07 07:45:23,108 - INFO - EXTRACT 'public.geolocation' - SUCCESS.
2025-06-07 07:45:23,117 - INFO - EXTRACT 'public.product_category_name_translation' - SUCCESS.
2025-06-07 07:45:23,133 - INFO - EXTRACT 'public.sellers' - SUCCESS.
2025-06-07 07:45:23,717 - INFO - EXTRACT 'public.customers' - SUCCESS.
2025-06-07 07:45:23,967 - INFO - EXTRACT 'public.products' - SUCCESS.
2025-06-07 07:45:24,707 - INFO - EXTRACT 'public.orders' - SUCCESS.
2025-06-07 07:45:25,562 - INFO - EXTRACT 'public.order_items' - SUCCESS.
2025-06-07 07:45:26,135 - INFO - EXTRACT 'public.order_payments' - SUCCESS.
2025-06-07 07:45:26,788 - INFO - EXTRACT 'public.order_reviews' - SUCCESS.
2025-06-07 07:45:26,788 - INFO - Extract All Tables From Sources - SUCCESS
2025-06-07 07:45:26,789 - INFO - ==================================ENDING EXTRACT DATA=======================================
2025-06-07 07:45:26,792 - INFO - [pid 19900] Worker Worker(salt=8085817497, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) done      Extract()
2025-06-07 07:45:26,805 - DEBUG - 1 running tasks, waiting for next task to finish
2025-06-07 07:45:26,805 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2025-06-07 07:45:26,805 - DEBUG - Asking scheduler for work...
2025-06-07 07:45:26,805 - DEBUG - Done
2025-06-07 07:45:26,805 - DEBUG - There are no more tasks to run at this time
2025-06-07 07:45:26,808 - INFO - Worker Worker(salt=8085817497, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) was stopped. Shutting down Keep-Alive thread
2025-06-07 07:45:26,808 - INFO - 
===== Luigi Execution Summary =====

Scheduled 1 tasks of which:
* 1 ran successfully:
    - 1 Extract()

This progress looks :) because there were no failed tasks or missing dependencies

===== Luigi Execution Summary =====

2025-06-07 07:45:32,742 - INFO - logging already configured
2025-06-07 07:45:32,744 - DEBUG - Checking if Extract() is complete
2025-06-07 07:45:32,746 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2025-06-07 07:45:32,747 - DEBUG - Checking if Load() is complete
2025-06-07 07:45:32,748 - DEBUG - Checking if Extract() is complete
2025-06-07 07:45:32,749 - INFO - Informed scheduler that task   Load__99914b932b   has status   PENDING
2025-06-07 07:45:32,750 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2025-06-07 07:45:32,751 - INFO - Done scheduling tasks
2025-06-07 07:45:32,751 - INFO - Running Worker with 1 processes
2025-06-07 07:45:32,752 - DEBUG - Asking scheduler for work...
2025-06-07 07:45:32,753 - DEBUG - Pending tasks: 1
2025-06-07 07:45:32,753 - INFO - [pid 19900] Worker Worker(salt=3251714730, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) running   Load()
2025-06-07 07:45:32,771 - INFO - Read Load Query - SUCCESS
2025-06-07 07:45:33,894 - INFO - Read Extracted Data - SUCCESS
2025-06-07 07:45:33,895 - INFO - Connect to olist-dwh - SUCCESS
2025-06-07 07:45:34,025 - INFO - Truncate `public` Schema in olist-dwh - SUCCESS
2025-06-07 07:45:34,025 - INFO - ==================================STARTING LOAD DATA=======================================
2025-06-07 07:46:03,749 - INFO - LOAD All Tables To olist-dwh-public - SUCCESS
2025-06-07 07:46:08,805 - ERROR - LOAD All Tables To DWH-Staging - FAILED
2025-06-07 07:46:08,807 - ERROR - LOAD All Tables To DWH - FAILED
2025-06-07 07:46:08,807 - ERROR - [pid 19900] Worker Worker(salt=3251714730, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) failed    Load()
Traceback (most recent call last):
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.InvalidColumnReference: there is no unique or exclusion constraint matching the ON CONFLICT specification


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\LENOVO THINKPAD\AppData\Local\Temp\ipykernel_19900\922383790.py", line 250, in run
    session.execute(query)
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\orm\session.py", line 2362, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\orm\session.py", line 2256, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1418, in execute
    return meth(
           ^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\sql\elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.InvalidColumnReference) there is no unique or exclusion constraint matching the ON CONFLICT specification

[SQL: INSERT INTO stg.order_reviews (
  review_id, order_id, 
  review_score, review_comment_title, review_comment_message, 
  review_creation_date
)
SELECT review_id, order_id, 
  review_score, review_comment_title, review_comment_message, 
  review_creation_date
FROM public.order_reviews
ON CONFLICT(review_id) DO NOTHING;]
(Background on this error at: https://sqlalche.me/e/20/f405)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\LENOVO THINKPAD\AppData\Local\Temp\ipykernel_19900\922383790.py", line 261, in run
    raise Exception('Failed Load Tables To DWH-Staging')
Exception: Failed Load Tables To DWH-Staging

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 210, in run
    new_deps = self._run_get_new_deps()
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 138, in _run_get_new_deps
    task_gen = self.task.run()
               ^^^^^^^^^^^^^^^
  File "C:\Users\LENOVO THINKPAD\AppData\Local\Temp\ipykernel_19900\922383790.py", line 300, in run
    raise Exception('Failed Load Tables To DWH')
Exception: Failed Load Tables To DWH
2025-06-07 07:46:08,813 - DEBUG - 1 running tasks, waiting for next task to finish
2025-06-07 07:46:08,815 - INFO - Informed scheduler that task   Load__99914b932b   has status   FAILED
2025-06-07 07:46:08,816 - DEBUG - Asking scheduler for work...
2025-06-07 07:46:08,816 - DEBUG - Done
2025-06-07 07:46:08,817 - DEBUG - There are no more tasks to run at this time
2025-06-07 07:46:08,818 - DEBUG - There are 1 pending tasks possibly being run by other workers
2025-06-07 07:46:08,819 - DEBUG - There are 1 pending tasks unique to this worker
2025-06-07 07:46:08,819 - DEBUG - There are 1 pending tasks last scheduled by this worker
2025-06-07 07:46:08,820 - INFO - Worker Worker(salt=3251714730, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) was stopped. Shutting down Keep-Alive thread
2025-06-07 07:46:08,847 - INFO - 
===== Luigi Execution Summary =====

Scheduled 2 tasks of which:
* 1 complete ones were encountered:
    - 1 Extract()
* 1 failed:
    - 1 Load()

This progress looks :( because there were failed tasks

===== Luigi Execution Summary =====

2025-06-07 07:50:18,511 - INFO - logging already configured
2025-06-07 07:50:18,514 - DEBUG - Checking if Extract() is complete
2025-06-07 07:50:18,566 - INFO - Informed scheduler that task   Extract__99914b932b   has status   PENDING
2025-06-07 07:50:18,567 - INFO - Done scheduling tasks
2025-06-07 07:50:18,568 - INFO - Running Worker with 1 processes
2025-06-07 07:50:18,569 - DEBUG - Asking scheduler for work...
2025-06-07 07:50:18,570 - DEBUG - Pending tasks: 1
2025-06-07 07:50:18,572 - INFO - [pid 19900] Worker Worker(salt=8864561208, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) running   Extract()
2025-06-07 07:50:18,575 - INFO - ==================================STARTING EXTRACT DATA=======================================
2025-06-07 07:50:18,748 - INFO - EXTRACT 'public.geolocation' - SUCCESS.
2025-06-07 07:50:18,755 - INFO - EXTRACT 'public.product_category_name_translation' - SUCCESS.
2025-06-07 07:50:18,877 - INFO - EXTRACT 'public.sellers' - SUCCESS.
2025-06-07 07:50:19,414 - INFO - EXTRACT 'public.customers' - SUCCESS.
2025-06-07 07:50:19,649 - INFO - EXTRACT 'public.products' - SUCCESS.
2025-06-07 07:50:20,329 - INFO - EXTRACT 'public.orders' - SUCCESS.
2025-06-07 07:50:21,090 - INFO - EXTRACT 'public.order_items' - SUCCESS.
2025-06-07 07:50:21,629 - INFO - EXTRACT 'public.order_payments' - SUCCESS.
2025-06-07 07:50:22,230 - INFO - EXTRACT 'public.order_reviews' - SUCCESS.
2025-06-07 07:50:22,230 - INFO - Extract All Tables From Sources - SUCCESS
2025-06-07 07:50:22,233 - INFO - ==================================ENDING EXTRACT DATA=======================================
2025-06-07 07:50:22,245 - INFO - [pid 19900] Worker Worker(salt=8864561208, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) done      Extract()
2025-06-07 07:50:22,245 - DEBUG - 1 running tasks, waiting for next task to finish
2025-06-07 07:50:22,245 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2025-06-07 07:50:22,245 - DEBUG - Asking scheduler for work...
2025-06-07 07:50:22,250 - DEBUG - Done
2025-06-07 07:50:22,250 - DEBUG - There are no more tasks to run at this time
2025-06-07 07:50:22,250 - INFO - Worker Worker(salt=8864561208, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) was stopped. Shutting down Keep-Alive thread
2025-06-07 07:50:22,252 - INFO - 
===== Luigi Execution Summary =====

Scheduled 1 tasks of which:
* 1 ran successfully:
    - 1 Extract()

This progress looks :) because there were no failed tasks or missing dependencies

===== Luigi Execution Summary =====

2025-06-07 07:50:26,443 - INFO - logging already configured
2025-06-07 07:50:26,446 - DEBUG - Checking if Extract() is complete
2025-06-07 07:50:26,447 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2025-06-07 07:50:26,449 - DEBUG - Checking if Load() is complete
2025-06-07 07:50:26,449 - DEBUG - Checking if Extract() is complete
2025-06-07 07:50:26,450 - INFO - Informed scheduler that task   Load__99914b932b   has status   PENDING
2025-06-07 07:50:26,451 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2025-06-07 07:50:26,451 - INFO - Done scheduling tasks
2025-06-07 07:50:26,451 - INFO - Running Worker with 1 processes
2025-06-07 07:50:26,451 - DEBUG - Asking scheduler for work...
2025-06-07 07:50:26,451 - DEBUG - Pending tasks: 1
2025-06-07 07:50:26,451 - INFO - [pid 19900] Worker Worker(salt=5549612506, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) running   Load()
2025-06-07 07:50:26,469 - INFO - Read Load Query - SUCCESS
2025-06-07 07:50:27,570 - INFO - Read Extracted Data - SUCCESS
2025-06-07 07:50:27,570 - INFO - Connect to olist-dwh - SUCCESS
2025-06-07 07:50:27,694 - INFO - Truncate `public` Schema in olist-dwh - SUCCESS
2025-06-07 07:50:27,694 - INFO - ==================================STARTING LOAD DATA=======================================
2025-06-07 07:50:55,466 - INFO - LOAD All Tables To olist-dwh-public - SUCCESS
2025-06-07 07:51:01,246 - INFO - LOAD All Tables To DWH-Staging - SUCCESS
2025-06-07 07:51:01,248 - INFO - ==================================ENDING LOAD DATA=======================================
2025-06-07 07:51:01,278 - INFO - [pid 19900] Worker Worker(salt=5549612506, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) done      Load()
2025-06-07 07:51:01,280 - DEBUG - 1 running tasks, waiting for next task to finish
2025-06-07 07:51:01,281 - INFO - Informed scheduler that task   Load__99914b932b   has status   DONE
2025-06-07 07:51:01,282 - DEBUG - Asking scheduler for work...
2025-06-07 07:51:01,282 - DEBUG - Done
2025-06-07 07:51:01,283 - DEBUG - There are no more tasks to run at this time
2025-06-07 07:51:01,284 - INFO - Worker Worker(salt=5549612506, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) was stopped. Shutting down Keep-Alive thread
2025-06-07 07:51:01,290 - INFO - 
===== Luigi Execution Summary =====

Scheduled 2 tasks of which:
* 1 complete ones were encountered:
    - 1 Extract()
* 1 ran successfully:
    - 1 Load()

This progress looks :) because there were no failed tasks or missing dependencies

===== Luigi Execution Summary =====

2025-06-07 07:57:03,686 - INFO - logging already configured
2025-06-07 07:57:03,688 - DEBUG - Checking if Extract() is complete
2025-06-07 07:57:03,690 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2025-06-07 07:57:03,690 - DEBUG - Checking if Load() is complete
2025-06-07 07:57:03,691 - INFO - Informed scheduler that task   Load__99914b932b   has status   DONE
2025-06-07 07:57:03,692 - DEBUG - Checking if Transform() is complete
2025-06-07 07:57:03,693 - DEBUG - Checking if Load() is complete
2025-06-07 07:57:03,694 - INFO - Informed scheduler that task   Transform__99914b932b   has status   PENDING
2025-06-07 07:57:03,694 - INFO - Informed scheduler that task   Load__99914b932b   has status   DONE
2025-06-07 07:57:03,695 - INFO - Done scheduling tasks
2025-06-07 07:57:03,695 - INFO - Running Worker with 1 processes
2025-06-07 07:57:03,697 - DEBUG - Asking scheduler for work...
2025-06-07 07:57:03,697 - DEBUG - Pending tasks: 1
2025-06-07 07:57:03,698 - INFO - [pid 19900] Worker Worker(salt=5346440739, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) running   Transform()
2025-06-07 07:57:03,700 - INFO - Connect to DWH - SUCCESS
2025-06-07 07:57:03,704 - INFO - Read Transform Query - SUCCESS
2025-06-07 07:57:03,704 - INFO - ==================================STARTING TRANSFROM DATA=======================================
2025-06-07 07:57:03,878 - INFO - Transform to 'dwh.dim_geolocation' - SUCCESS
2025-06-07 07:57:03,883 - INFO - Transform to 'dwh.dim_product_category' - SUCCESS
2025-06-07 07:57:03,909 - INFO - Transform to 'dwh.dim_sellers' - SUCCESS
2025-06-07 07:57:04,549 - INFO - Transform to 'dwh.dim_customers' - SUCCESS
2025-06-07 07:57:04,549 - ERROR - Transform to All Dimensions and Fact Tables - FAILED
2025-06-07 07:57:04,551 - ERROR - Transform Tables - FAILED
2025-06-07 07:57:04,551 - ERROR - [pid 19900] Worker Worker(salt=5346440739, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) failed    Transform()
Traceback (most recent call last):
  File "C:\Users\LENOVO THINKPAD\AppData\Local\Temp\ipykernel_19900\614781447.py", line 129, in run
    query = sqlalchemy.text(dim_product_query)
                            ^^^^^^^^^^^^^^^^^
NameError: name 'dim_product_query' is not defined. Did you mean: 'dim_products_query'?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 210, in run
    new_deps = self._run_get_new_deps()
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 138, in _run_get_new_deps
    task_gen = self.task.run()
               ^^^^^^^^^^^^^^^
  File "C:\Users\LENOVO THINKPAD\AppData\Local\Temp\ipykernel_19900\614781447.py", line 193, in run
    raise Exception('Failed Transforming Tables')
Exception: Failed Transforming Tables
2025-06-07 07:57:04,556 - DEBUG - 1 running tasks, waiting for next task to finish
2025-06-07 07:57:04,560 - INFO - Informed scheduler that task   Transform__99914b932b   has status   FAILED
2025-06-07 07:57:04,560 - DEBUG - Asking scheduler for work...
2025-06-07 07:57:04,561 - DEBUG - Done
2025-06-07 07:57:04,562 - DEBUG - There are no more tasks to run at this time
2025-06-07 07:57:04,563 - DEBUG - There are 1 pending tasks possibly being run by other workers
2025-06-07 07:57:04,564 - DEBUG - There are 1 pending tasks unique to this worker
2025-06-07 07:57:04,565 - DEBUG - There are 1 pending tasks last scheduled by this worker
2025-06-07 07:57:04,566 - INFO - Worker Worker(salt=5346440739, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) was stopped. Shutting down Keep-Alive thread
2025-06-07 07:57:04,570 - INFO - 
===== Luigi Execution Summary =====

Scheduled 3 tasks of which:
* 2 complete ones were encountered:
    - 1 Extract()
    - 1 Load()
* 1 failed:
    - 1 Transform()

This progress looks :( because there were failed tasks

===== Luigi Execution Summary =====

2025-06-07 07:57:35,799 - INFO - logging already configured
2025-06-07 07:57:35,801 - DEBUG - Checking if Extract() is complete
2025-06-07 07:57:35,803 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2025-06-07 07:57:35,804 - DEBUG - Checking if Load() is complete
2025-06-07 07:57:35,805 - INFO - Informed scheduler that task   Load__99914b932b   has status   DONE
2025-06-07 07:57:35,807 - DEBUG - Checking if Transform() is complete
2025-06-07 07:57:35,808 - INFO - Informed scheduler that task   Transform__99914b932b   has status   DONE
2025-06-07 07:57:35,809 - INFO - Done scheduling tasks
2025-06-07 07:57:35,809 - INFO - Running Worker with 1 processes
2025-06-07 07:57:35,810 - DEBUG - Asking scheduler for work...
2025-06-07 07:57:35,811 - DEBUG - Done
2025-06-07 07:57:35,811 - DEBUG - There are no more tasks to run at this time
2025-06-07 07:57:35,812 - INFO - Worker Worker(salt=7284630192, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) was stopped. Shutting down Keep-Alive thread
2025-06-07 07:57:35,814 - INFO - 
===== Luigi Execution Summary =====

Scheduled 3 tasks of which:
* 3 complete ones were encountered:
    - 1 Extract()
    - 1 Load()
    - 1 Transform()

Did not run any tasks
This progress looks :) because there were no failed tasks or missing dependencies

===== Luigi Execution Summary =====

2025-06-07 07:57:50,103 - INFO - logging already configured
2025-06-07 07:57:50,106 - DEBUG - Checking if Extract() is complete
2025-06-07 07:57:50,109 - INFO - Informed scheduler that task   Extract__99914b932b   has status   PENDING
2025-06-07 07:57:50,111 - DEBUG - Checking if Load() is complete
2025-06-07 07:57:50,114 - DEBUG - Checking if Extract() is complete
2025-06-07 07:57:50,116 - INFO - Informed scheduler that task   Load__99914b932b   has status   PENDING
2025-06-07 07:57:50,118 - INFO - Informed scheduler that task   Extract__99914b932b   has status   PENDING
2025-06-07 07:57:50,119 - DEBUG - Checking if Transform() is complete
2025-06-07 07:57:50,122 - DEBUG - Checking if Load() is complete
2025-06-07 07:57:50,123 - INFO - Informed scheduler that task   Transform__99914b932b   has status   PENDING
2025-06-07 07:57:50,126 - DEBUG - Checking if Extract() is complete
2025-06-07 07:57:50,127 - INFO - Informed scheduler that task   Load__99914b932b   has status   PENDING
2025-06-07 07:57:50,129 - INFO - Informed scheduler that task   Extract__99914b932b   has status   PENDING
2025-06-07 07:57:50,130 - INFO - Done scheduling tasks
2025-06-07 07:57:50,132 - INFO - Running Worker with 1 processes
2025-06-07 07:57:50,134 - DEBUG - Asking scheduler for work...
2025-06-07 07:57:50,135 - DEBUG - Pending tasks: 3
2025-06-07 07:57:50,136 - INFO - [pid 19900] Worker Worker(salt=4311281959, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) running   Extract()
2025-06-07 07:57:50,138 - ERROR - [pid 19900] Worker Worker(salt=4311281959, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) failed    Extract()
Traceback (most recent call last):
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 210, in run
    new_deps = self._run_get_new_deps()
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 138, in _run_get_new_deps
    task_gen = self.task.run()
               ^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\Documents\Github\Pacmann---Data-Storage_-Warehouse--Mart---Lake\mentoring 2\olist-dwh-project\pipeline\extract.py", line 43, in run
    os.makedirs(os.path.dirname(self.output().path), exist_ok=True)
                                ^^^^^^^^^^^^^^^^^^
AttributeError: 'list' object has no attribute 'path'
2025-06-07 07:57:50,142 - DEBUG - 1 running tasks, waiting for next task to finish
2025-06-07 07:57:50,148 - INFO - Informed scheduler that task   Extract__99914b932b   has status   FAILED
2025-06-07 07:57:50,150 - DEBUG - Asking scheduler for work...
2025-06-07 07:57:50,151 - DEBUG - Done
2025-06-07 07:57:50,153 - DEBUG - There are no more tasks to run at this time
2025-06-07 07:57:50,155 - DEBUG - There are 3 pending tasks possibly being run by other workers
2025-06-07 07:57:50,157 - DEBUG - There are 3 pending tasks unique to this worker
2025-06-07 07:57:50,159 - DEBUG - There are 3 pending tasks last scheduled by this worker
2025-06-07 07:57:50,160 - INFO - Worker Worker(salt=4311281959, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) was stopped. Shutting down Keep-Alive thread
2025-06-07 07:57:50,166 - INFO - 
===== Luigi Execution Summary =====

Scheduled 3 tasks of which:
* 1 failed:
    - 1 Extract()
* 2 were left pending, among these:
    * 2 had failed dependencies:
        - 1 Load()
        - 1 Transform()

This progress looks :( because there were failed tasks

===== Luigi Execution Summary =====

2025-06-07 07:58:07,045 - INFO - logging already configured
2025-06-07 07:58:07,047 - DEBUG - Checking if Extract() is complete
2025-06-07 07:58:07,049 - INFO - Informed scheduler that task   Extract__99914b932b   has status   PENDING
2025-06-07 07:58:07,049 - INFO - Done scheduling tasks
2025-06-07 07:58:07,050 - INFO - Running Worker with 1 processes
2025-06-07 07:58:07,050 - DEBUG - Asking scheduler for work...
2025-06-07 07:58:07,052 - DEBUG - Pending tasks: 1
2025-06-07 07:58:07,052 - INFO - [pid 19900] Worker Worker(salt=1821009955, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) running   Extract()
2025-06-07 07:58:07,053 - ERROR - [pid 19900] Worker Worker(salt=1821009955, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) failed    Extract()
Traceback (most recent call last):
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 210, in run
    new_deps = self._run_get_new_deps()
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 138, in _run_get_new_deps
    task_gen = self.task.run()
               ^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\Documents\Github\Pacmann---Data-Storage_-Warehouse--Mart---Lake\mentoring 2\olist-dwh-project\pipeline\extract.py", line 43, in run
    os.makedirs(os.path.dirname(self.output().path), exist_ok=True)
                                ^^^^^^^^^^^^^^^^^^
AttributeError: 'list' object has no attribute 'path'
2025-06-07 07:58:07,056 - DEBUG - 1 running tasks, waiting for next task to finish
2025-06-07 07:58:07,058 - INFO - Informed scheduler that task   Extract__99914b932b   has status   FAILED
2025-06-07 07:58:07,059 - DEBUG - Asking scheduler for work...
2025-06-07 07:58:07,060 - DEBUG - Done
2025-06-07 07:58:07,060 - DEBUG - There are no more tasks to run at this time
2025-06-07 07:58:07,061 - DEBUG - There are 1 pending tasks possibly being run by other workers
2025-06-07 07:58:07,062 - DEBUG - There are 1 pending tasks unique to this worker
2025-06-07 07:58:07,062 - DEBUG - There are 1 pending tasks last scheduled by this worker
2025-06-07 07:58:07,062 - INFO - Worker Worker(salt=1821009955, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) was stopped. Shutting down Keep-Alive thread
2025-06-07 07:58:07,067 - INFO - 
===== Luigi Execution Summary =====

Scheduled 1 tasks of which:
* 1 failed:
    - 1 Extract()

This progress looks :( because there were failed tasks

===== Luigi Execution Summary =====

2025-06-07 07:58:13,962 - INFO - logging already configured
2025-06-07 07:58:13,965 - DEBUG - Checking if Extract() is complete
2025-06-07 07:58:13,966 - INFO - Informed scheduler that task   Extract__99914b932b   has status   PENDING
2025-06-07 07:58:13,967 - INFO - Done scheduling tasks
2025-06-07 07:58:13,967 - INFO - Running Worker with 1 processes
2025-06-07 07:58:13,968 - DEBUG - Asking scheduler for work...
2025-06-07 07:58:13,969 - DEBUG - Pending tasks: 1
2025-06-07 07:58:13,969 - INFO - [pid 19900] Worker Worker(salt=8573616373, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) running   Extract()
2025-06-07 07:58:13,972 - INFO - ==================================STARTING EXTRACT DATA=======================================
2025-06-07 07:58:14,123 - INFO - EXTRACT 'public.geolocation' - SUCCESS.
2025-06-07 07:58:14,132 - INFO - EXTRACT 'public.product_category_name_translation' - SUCCESS.
2025-06-07 07:58:14,268 - INFO - EXTRACT 'public.sellers' - SUCCESS.
2025-06-07 07:58:14,835 - INFO - EXTRACT 'public.customers' - SUCCESS.
2025-06-07 07:58:15,074 - INFO - EXTRACT 'public.products' - SUCCESS.
2025-06-07 07:58:15,777 - INFO - EXTRACT 'public.orders' - SUCCESS.
2025-06-07 07:58:16,539 - INFO - EXTRACT 'public.order_items' - SUCCESS.
2025-06-07 07:58:17,082 - INFO - EXTRACT 'public.order_payments' - SUCCESS.
2025-06-07 07:58:17,683 - INFO - EXTRACT 'public.order_reviews' - SUCCESS.
2025-06-07 07:58:17,683 - INFO - Extract All Tables From Sources - SUCCESS
2025-06-07 07:58:17,683 - INFO - ==================================ENDING EXTRACT DATA=======================================
2025-06-07 07:58:17,702 - INFO - [pid 19900] Worker Worker(salt=8573616373, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) done      Extract()
2025-06-07 07:58:17,702 - DEBUG - 1 running tasks, waiting for next task to finish
2025-06-07 07:58:17,702 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2025-06-07 07:58:17,713 - DEBUG - Asking scheduler for work...
2025-06-07 07:58:17,714 - DEBUG - Done
2025-06-07 07:58:17,714 - DEBUG - There are no more tasks to run at this time
2025-06-07 07:58:17,715 - INFO - Worker Worker(salt=8573616373, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) was stopped. Shutting down Keep-Alive thread
2025-06-07 07:58:17,734 - INFO - 
===== Luigi Execution Summary =====

Scheduled 1 tasks of which:
* 1 ran successfully:
    - 1 Extract()

This progress looks :) because there were no failed tasks or missing dependencies

===== Luigi Execution Summary =====

2025-06-07 07:58:22,395 - INFO - logging already configured
2025-06-07 07:58:22,397 - DEBUG - Checking if Extract() is complete
2025-06-07 07:58:22,398 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2025-06-07 07:58:22,398 - DEBUG - Checking if Load() is complete
2025-06-07 07:58:22,398 - DEBUG - Checking if Extract() is complete
2025-06-07 07:58:22,398 - INFO - Informed scheduler that task   Load__99914b932b   has status   PENDING
2025-06-07 07:58:22,398 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2025-06-07 07:58:22,398 - INFO - Done scheduling tasks
2025-06-07 07:58:22,405 - INFO - Running Worker with 1 processes
2025-06-07 07:58:22,405 - DEBUG - Asking scheduler for work...
2025-06-07 07:58:22,407 - DEBUG - Pending tasks: 1
2025-06-07 07:58:22,408 - INFO - [pid 19900] Worker Worker(salt=8387820516, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) running   Load()
2025-06-07 07:58:22,411 - INFO - Read Load Query - SUCCESS
2025-06-07 07:58:23,443 - INFO - Read Extracted Data - SUCCESS
2025-06-07 07:58:23,443 - INFO - Connect to olist-dwh - SUCCESS
2025-06-07 07:58:23,565 - INFO - Truncate `public` Schema in olist-dwh - SUCCESS
2025-06-07 07:58:23,565 - INFO - ==================================STARTING LOAD DATA=======================================
2025-06-07 07:58:51,725 - INFO - LOAD All Tables To olist-dwh-public - SUCCESS
2025-06-07 07:58:55,573 - INFO - LOAD All Tables To DWH-Staging - SUCCESS
2025-06-07 07:58:55,573 - INFO - ==================================ENDING LOAD DATA=======================================
2025-06-07 07:58:55,605 - INFO - [pid 19900] Worker Worker(salt=8387820516, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) done      Load()
2025-06-07 07:58:55,605 - DEBUG - 1 running tasks, waiting for next task to finish
2025-06-07 07:58:55,605 - INFO - Informed scheduler that task   Load__99914b932b   has status   DONE
2025-06-07 07:58:55,620 - DEBUG - Asking scheduler for work...
2025-06-07 07:58:55,621 - DEBUG - Done
2025-06-07 07:58:55,621 - DEBUG - There are no more tasks to run at this time
2025-06-07 07:58:55,622 - INFO - Worker Worker(salt=8387820516, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) was stopped. Shutting down Keep-Alive thread
2025-06-07 07:58:55,625 - INFO - 
===== Luigi Execution Summary =====

Scheduled 2 tasks of which:
* 1 complete ones were encountered:
    - 1 Extract()
* 1 ran successfully:
    - 1 Load()

This progress looks :) because there were no failed tasks or missing dependencies

===== Luigi Execution Summary =====

2025-06-07 07:59:10,919 - INFO - logging already configured
2025-06-07 07:59:10,922 - DEBUG - Checking if Extract() is complete
2025-06-07 07:59:10,924 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2025-06-07 07:59:10,925 - DEBUG - Checking if Load() is complete
2025-06-07 07:59:10,926 - INFO - Informed scheduler that task   Load__99914b932b   has status   DONE
2025-06-07 07:59:10,927 - DEBUG - Checking if Transform() is complete
2025-06-07 07:59:10,928 - DEBUG - Checking if Load() is complete
2025-06-07 07:59:10,930 - INFO - Informed scheduler that task   Transform__99914b932b   has status   PENDING
2025-06-07 07:59:10,931 - INFO - Informed scheduler that task   Load__99914b932b   has status   DONE
2025-06-07 07:59:10,931 - INFO - Done scheduling tasks
2025-06-07 07:59:10,932 - INFO - Running Worker with 1 processes
2025-06-07 07:59:10,932 - DEBUG - Asking scheduler for work...
2025-06-07 07:59:10,933 - DEBUG - Pending tasks: 1
2025-06-07 07:59:10,933 - INFO - [pid 19900] Worker Worker(salt=2762681809, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) running   Transform()
2025-06-07 07:59:10,937 - INFO - Connect to DWH - SUCCESS
2025-06-07 07:59:10,941 - INFO - Read Transform Query - SUCCESS
2025-06-07 07:59:10,941 - INFO - ==================================STARTING TRANSFROM DATA=======================================
2025-06-07 07:59:11,095 - INFO - Transform to 'dwh.dim_geolocation' - SUCCESS
2025-06-07 07:59:11,102 - INFO - Transform to 'dwh.dim_product_category' - SUCCESS
2025-06-07 07:59:11,119 - INFO - Transform to 'dwh.dim_sellers' - SUCCESS
2025-06-07 07:59:11,849 - INFO - Transform to 'dwh.dim_customers' - SUCCESS
2025-06-07 07:59:11,852 - ERROR - Transform to All Dimensions and Fact Tables - FAILED
2025-06-07 07:59:11,854 - ERROR - Transform Tables - FAILED
2025-06-07 07:59:11,855 - ERROR - [pid 19900] Worker Worker(salt=2762681809, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) failed    Transform()
Traceback (most recent call last):
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: operator does not exist: real = text
LINE 11:       d.product_name_length IS DISTINCT FROM p.product_name_...
                                     ^
HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\LENOVO THINKPAD\AppData\Local\Temp\ipykernel_19900\231232265.py", line 130, in run
    session.execute(query)
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\orm\session.py", line 2362, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\orm\session.py", line 2256, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1418, in execute
    return meth(
           ^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\sql\elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) operator does not exist: real = text
LINE 11:       d.product_name_length IS DISTINCT FROM p.product_name_...
                                     ^
HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.

[SQL: -- Step 1: Expire the current records with changes
UPDATE dwh.dim_products d
SET 
    record_end_date = CURRENT_DATE - INTERVAL '1 day',
    is_current = FALSE
FROM stg.products p
WHERE d.product_id = p.product_id
  AND d.is_current = TRUE
  AND (
      d.product_category_name IS DISTINCT FROM p.product_category_name OR
      d.product_name_length IS DISTINCT FROM p.product_name_length OR
      d.product_description_length IS DISTINCT FROM p.product_description_length OR
      d.product_photos_qty IS DISTINCT FROM p.product_photos_qty OR
      d.product_weight_g IS DISTINCT FROM p.product_weight_g OR
      d.product_length_cm IS DISTINCT FROM p.product_length_cm OR
      d.product_height_cm IS DISTINCT FROM p.product_height_cm OR
      d.product_width_cm IS DISTINCT FROM p.product_width_cm
  );

-- Step 2: Insert new records (new or changed)
INSERT INTO dwh.dim_products (
    product_id,
    product_category_name,
    product_name_length,
    product_description_length,
    product_photos_qty,
    product_weight_g,
    product_length_cm,
    product_height_cm,
    product_width_cm,
    record_start_date,
    is_current
)
SELECT DISTINCT
    p.product_id,
    p.product_category_name,
    p.product_name_length,
    p.product_description_length,
    p.product_photos_qty,
    p.product_weight_g,
    p.product_length_cm,
    p.product_height_cm,
    p.product_width_cm,
    CURRENT_DATE,
    TRUE
FROM stg.products p
LEFT JOIN dwh.dim_products d
  ON p.product_id = d.product_id AND d.is_current = TRUE
WHERE 
    d.product_id IS NULL -- New product
    OR (
      d.product_category_name IS DISTINCT FROM p.product_category_name OR
      d.product_name_length IS DISTINCT FROM p.product_name_length OR
      d.product_description_length IS DISTINCT FROM p.product_description_length OR
      d.product_photos_qty IS DISTINCT FROM p.product_photos_qty OR
      d.product_weight_g IS DISTINCT FROM p.product_weight_g OR
      d.product_length_cm IS DISTINCT FROM p.product_length_cm OR
      d.product_height_cm IS DISTINCT FROM p.product_height_cm OR
      d.product_width_cm IS DISTINCT FROM p.product_width_cm
    );
]
(Background on this error at: https://sqlalche.me/e/20/f405)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 210, in run
    new_deps = self._run_get_new_deps()
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 138, in _run_get_new_deps
    task_gen = self.task.run()
               ^^^^^^^^^^^^^^^
  File "C:\Users\LENOVO THINKPAD\AppData\Local\Temp\ipykernel_19900\231232265.py", line 193, in run
    raise Exception('Failed Transforming Tables')
Exception: Failed Transforming Tables
2025-06-07 07:59:11,860 - DEBUG - 1 running tasks, waiting for next task to finish
2025-06-07 07:59:11,863 - INFO - Informed scheduler that task   Transform__99914b932b   has status   FAILED
2025-06-07 07:59:11,864 - DEBUG - Asking scheduler for work...
2025-06-07 07:59:11,865 - DEBUG - Done
2025-06-07 07:59:11,866 - DEBUG - There are no more tasks to run at this time
2025-06-07 07:59:11,866 - DEBUG - There are 1 pending tasks possibly being run by other workers
2025-06-07 07:59:11,867 - DEBUG - There are 1 pending tasks unique to this worker
2025-06-07 07:59:11,868 - DEBUG - There are 1 pending tasks last scheduled by this worker
2025-06-07 07:59:11,869 - INFO - Worker Worker(salt=2762681809, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) was stopped. Shutting down Keep-Alive thread
2025-06-07 07:59:11,872 - INFO - 
===== Luigi Execution Summary =====

Scheduled 3 tasks of which:
* 2 complete ones were encountered:
    - 1 Extract()
    - 1 Load()
* 1 failed:
    - 1 Transform()

This progress looks :( because there were failed tasks

===== Luigi Execution Summary =====

2025-06-07 08:06:29,176 - INFO - logging already configured
2025-06-07 08:06:29,180 - DEBUG - Checking if Extract() is complete
2025-06-07 08:06:29,182 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2025-06-07 08:06:29,182 - DEBUG - Checking if Load() is complete
2025-06-07 08:06:29,184 - INFO - Informed scheduler that task   Load__99914b932b   has status   DONE
2025-06-07 08:06:29,184 - DEBUG - Checking if Transform() is complete
2025-06-07 08:06:29,185 - INFO - Informed scheduler that task   Transform__99914b932b   has status   DONE
2025-06-07 08:06:29,186 - INFO - Done scheduling tasks
2025-06-07 08:06:29,187 - INFO - Running Worker with 1 processes
2025-06-07 08:06:29,187 - DEBUG - Asking scheduler for work...
2025-06-07 08:06:29,189 - DEBUG - Done
2025-06-07 08:06:29,189 - DEBUG - There are no more tasks to run at this time
2025-06-07 08:06:29,190 - INFO - Worker Worker(salt=9932036715, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) was stopped. Shutting down Keep-Alive thread
2025-06-07 08:06:29,193 - INFO - 
===== Luigi Execution Summary =====

Scheduled 3 tasks of which:
* 3 complete ones were encountered:
    - 1 Extract()
    - 1 Load()
    - 1 Transform()

Did not run any tasks
This progress looks :) because there were no failed tasks or missing dependencies

===== Luigi Execution Summary =====

2025-06-07 08:06:35,416 - INFO - logging already configured
2025-06-07 08:06:35,418 - DEBUG - Checking if Extract() is complete
2025-06-07 08:06:35,420 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2025-06-07 08:06:35,420 - DEBUG - Checking if Load() is complete
2025-06-07 08:06:35,422 - INFO - Informed scheduler that task   Load__99914b932b   has status   DONE
2025-06-07 08:06:35,423 - DEBUG - Checking if Transform() is complete
2025-06-07 08:06:35,424 - INFO - Informed scheduler that task   Transform__99914b932b   has status   DONE
2025-06-07 08:06:35,425 - INFO - Done scheduling tasks
2025-06-07 08:06:35,426 - INFO - Running Worker with 1 processes
2025-06-07 08:06:35,426 - DEBUG - Asking scheduler for work...
2025-06-07 08:06:35,427 - DEBUG - Done
2025-06-07 08:06:35,428 - DEBUG - There are no more tasks to run at this time
2025-06-07 08:06:35,429 - INFO - Worker Worker(salt=5816541612, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) was stopped. Shutting down Keep-Alive thread
2025-06-07 08:06:35,432 - INFO - 
===== Luigi Execution Summary =====

Scheduled 3 tasks of which:
* 3 complete ones were encountered:
    - 1 Extract()
    - 1 Load()
    - 1 Transform()

Did not run any tasks
This progress looks :) because there were no failed tasks or missing dependencies

===== Luigi Execution Summary =====

2025-06-07 08:07:05,422 - INFO - logging already configured
2025-06-07 08:07:05,424 - DEBUG - Checking if Extract() is complete
2025-06-07 08:07:05,424 - INFO - Informed scheduler that task   Extract__99914b932b   has status   PENDING
2025-06-07 08:07:05,426 - DEBUG - Checking if Load() is complete
2025-06-07 08:07:05,428 - DEBUG - Checking if Extract() is complete
2025-06-07 08:07:05,429 - INFO - Informed scheduler that task   Load__99914b932b   has status   PENDING
2025-06-07 08:07:05,429 - INFO - Informed scheduler that task   Extract__99914b932b   has status   PENDING
2025-06-07 08:07:05,430 - DEBUG - Checking if Transform() is complete
2025-06-07 08:07:05,432 - DEBUG - Checking if Load() is complete
2025-06-07 08:07:05,433 - INFO - Informed scheduler that task   Transform__99914b932b   has status   PENDING
2025-06-07 08:07:05,434 - DEBUG - Checking if Extract() is complete
2025-06-07 08:07:05,435 - INFO - Informed scheduler that task   Load__99914b932b   has status   PENDING
2025-06-07 08:07:05,435 - INFO - Informed scheduler that task   Extract__99914b932b   has status   PENDING
2025-06-07 08:07:05,436 - INFO - Done scheduling tasks
2025-06-07 08:07:05,437 - INFO - Running Worker with 1 processes
2025-06-07 08:07:05,437 - DEBUG - Asking scheduler for work...
2025-06-07 08:07:05,438 - DEBUG - Pending tasks: 3
2025-06-07 08:07:05,439 - INFO - [pid 19900] Worker Worker(salt=4688162617, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) running   Extract()
2025-06-07 08:07:05,439 - ERROR - [pid 19900] Worker Worker(salt=4688162617, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) failed    Extract()
Traceback (most recent call last):
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 210, in run
    new_deps = self._run_get_new_deps()
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 138, in _run_get_new_deps
    task_gen = self.task.run()
               ^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\Documents\Github\Pacmann---Data-Storage_-Warehouse--Mart---Lake\mentoring 2\olist-dwh-project\pipeline\extract.py", line 43, in run
    os.makedirs(os.path.dirname(self.output().path), exist_ok=True)
                                ^^^^^^^^^^^^^^^^^^
AttributeError: 'list' object has no attribute 'path'
2025-06-07 08:07:05,442 - DEBUG - 1 running tasks, waiting for next task to finish
2025-06-07 08:07:05,445 - INFO - Informed scheduler that task   Extract__99914b932b   has status   FAILED
2025-06-07 08:07:05,448 - DEBUG - Asking scheduler for work...
2025-06-07 08:07:05,448 - DEBUG - Done
2025-06-07 08:07:05,449 - DEBUG - There are no more tasks to run at this time
2025-06-07 08:07:05,450 - DEBUG - There are 3 pending tasks possibly being run by other workers
2025-06-07 08:07:05,450 - DEBUG - There are 3 pending tasks unique to this worker
2025-06-07 08:07:05,452 - DEBUG - There are 3 pending tasks last scheduled by this worker
2025-06-07 08:07:05,453 - INFO - Worker Worker(salt=4688162617, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) was stopped. Shutting down Keep-Alive thread
2025-06-07 08:07:05,457 - INFO - 
===== Luigi Execution Summary =====

Scheduled 3 tasks of which:
* 1 failed:
    - 1 Extract()
* 2 were left pending, among these:
    * 2 had failed dependencies:
        - 1 Load()
        - 1 Transform()

This progress looks :( because there were failed tasks

===== Luigi Execution Summary =====

2025-06-07 08:07:15,095 - INFO - logging already configured
2025-06-07 08:07:15,097 - DEBUG - Checking if Extract() is complete
2025-06-07 08:07:15,099 - INFO - Informed scheduler that task   Extract__99914b932b   has status   PENDING
2025-06-07 08:07:15,099 - INFO - Done scheduling tasks
2025-06-07 08:07:15,101 - INFO - Running Worker with 1 processes
2025-06-07 08:07:15,101 - DEBUG - Asking scheduler for work...
2025-06-07 08:07:15,103 - DEBUG - Pending tasks: 1
2025-06-07 08:07:15,103 - INFO - [pid 19900] Worker Worker(salt=8707767314, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) running   Extract()
2025-06-07 08:07:15,114 - INFO - ==================================STARTING EXTRACT DATA=======================================
2025-06-07 08:07:15,250 - INFO - EXTRACT 'public.geolocation' - SUCCESS.
2025-06-07 08:07:15,264 - INFO - EXTRACT 'public.product_category_name_translation' - SUCCESS.
2025-06-07 08:07:15,280 - INFO - EXTRACT 'public.sellers' - SUCCESS.
2025-06-07 08:07:15,839 - INFO - EXTRACT 'public.customers' - SUCCESS.
2025-06-07 08:07:16,188 - INFO - EXTRACT 'public.products' - SUCCESS.
2025-06-07 08:07:16,905 - INFO - EXTRACT 'public.orders' - SUCCESS.
2025-06-07 08:07:17,691 - INFO - EXTRACT 'public.order_items' - SUCCESS.
2025-06-07 08:07:18,229 - INFO - EXTRACT 'public.order_payments' - SUCCESS.
2025-06-07 08:07:18,851 - INFO - EXTRACT 'public.order_reviews' - SUCCESS.
2025-06-07 08:07:18,851 - INFO - Extract All Tables From Sources - SUCCESS
2025-06-07 08:07:18,853 - INFO - ==================================ENDING EXTRACT DATA=======================================
2025-06-07 08:07:18,865 - INFO - [pid 19900] Worker Worker(salt=8707767314, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) done      Extract()
2025-06-07 08:07:18,867 - DEBUG - 1 running tasks, waiting for next task to finish
2025-06-07 08:07:18,868 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2025-06-07 08:07:18,868 - DEBUG - Asking scheduler for work...
2025-06-07 08:07:18,869 - DEBUG - Done
2025-06-07 08:07:18,870 - DEBUG - There are no more tasks to run at this time
2025-06-07 08:07:18,870 - INFO - Worker Worker(salt=8707767314, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) was stopped. Shutting down Keep-Alive thread
2025-06-07 08:07:18,874 - INFO - 
===== Luigi Execution Summary =====

Scheduled 1 tasks of which:
* 1 ran successfully:
    - 1 Extract()

This progress looks :) because there were no failed tasks or missing dependencies

===== Luigi Execution Summary =====

2025-06-07 08:07:23,322 - INFO - logging already configured
2025-06-07 08:07:23,324 - DEBUG - Checking if Extract() is complete
2025-06-07 08:07:23,326 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2025-06-07 08:07:23,327 - DEBUG - Checking if Load() is complete
2025-06-07 08:07:23,328 - DEBUG - Checking if Extract() is complete
2025-06-07 08:07:23,329 - INFO - Informed scheduler that task   Load__99914b932b   has status   PENDING
2025-06-07 08:07:23,330 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2025-06-07 08:07:23,330 - INFO - Done scheduling tasks
2025-06-07 08:07:23,331 - INFO - Running Worker with 1 processes
2025-06-07 08:07:23,332 - DEBUG - Asking scheduler for work...
2025-06-07 08:07:23,332 - DEBUG - Pending tasks: 1
2025-06-07 08:07:23,334 - INFO - [pid 19900] Worker Worker(salt=2328014447, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) running   Load()
2025-06-07 08:07:23,446 - INFO - Read Load Query - SUCCESS
2025-06-07 08:07:24,533 - INFO - Read Extracted Data - SUCCESS
2025-06-07 08:07:24,534 - INFO - Connect to olist-dwh - SUCCESS
2025-06-07 08:07:24,675 - INFO - Truncate `public` Schema in olist-dwh - SUCCESS
2025-06-07 08:07:24,675 - INFO - ==================================STARTING LOAD DATA=======================================
2025-06-07 08:07:57,427 - INFO - LOAD All Tables To olist-dwh-public - SUCCESS
2025-06-07 08:08:01,677 - INFO - LOAD All Tables To DWH-Staging - SUCCESS
2025-06-07 08:08:01,680 - INFO - ==================================ENDING LOAD DATA=======================================
2025-06-07 08:08:01,712 - INFO - [pid 19900] Worker Worker(salt=2328014447, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) done      Load()
2025-06-07 08:08:01,713 - DEBUG - 1 running tasks, waiting for next task to finish
2025-06-07 08:08:01,714 - INFO - Informed scheduler that task   Load__99914b932b   has status   DONE
2025-06-07 08:08:01,715 - DEBUG - Asking scheduler for work...
2025-06-07 08:08:01,715 - DEBUG - Done
2025-06-07 08:08:01,716 - DEBUG - There are no more tasks to run at this time
2025-06-07 08:08:01,716 - INFO - Worker Worker(salt=2328014447, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) was stopped. Shutting down Keep-Alive thread
2025-06-07 08:08:01,720 - INFO - 
===== Luigi Execution Summary =====

Scheduled 2 tasks of which:
* 1 complete ones were encountered:
    - 1 Extract()
* 1 ran successfully:
    - 1 Load()

This progress looks :) because there were no failed tasks or missing dependencies

===== Luigi Execution Summary =====

2025-06-07 08:08:09,466 - INFO - logging already configured
2025-06-07 08:08:09,469 - DEBUG - Checking if Extract() is complete
2025-06-07 08:08:09,469 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2025-06-07 08:08:09,469 - DEBUG - Checking if Load() is complete
2025-06-07 08:08:09,469 - INFO - Informed scheduler that task   Load__99914b932b   has status   DONE
2025-06-07 08:08:09,469 - DEBUG - Checking if Transform() is complete
2025-06-07 08:08:09,469 - DEBUG - Checking if Load() is complete
2025-06-07 08:08:09,469 - INFO - Informed scheduler that task   Transform__99914b932b   has status   PENDING
2025-06-07 08:08:09,469 - INFO - Informed scheduler that task   Load__99914b932b   has status   DONE
2025-06-07 08:08:09,477 - INFO - Done scheduling tasks
2025-06-07 08:08:09,477 - INFO - Running Worker with 1 processes
2025-06-07 08:08:09,477 - DEBUG - Asking scheduler for work...
2025-06-07 08:08:09,478 - DEBUG - Pending tasks: 1
2025-06-07 08:08:09,478 - INFO - [pid 19900] Worker Worker(salt=5985622694, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) running   Transform()
2025-06-07 08:08:09,480 - INFO - Connect to DWH - SUCCESS
2025-06-07 08:08:09,600 - INFO - Read Transform Query - SUCCESS
2025-06-07 08:08:09,601 - INFO - ==================================STARTING TRANSFROM DATA=======================================
2025-06-07 08:08:09,745 - INFO - Transform to 'dwh.dim_geolocation' - SUCCESS
2025-06-07 08:08:09,749 - INFO - Transform to 'dwh.dim_product_category' - SUCCESS
2025-06-07 08:08:09,765 - INFO - Transform to 'dwh.dim_sellers' - SUCCESS
2025-06-07 08:08:10,456 - INFO - Transform to 'dwh.dim_customers' - SUCCESS
2025-06-07 08:08:10,462 - ERROR - Transform to All Dimensions and Fact Tables - FAILED
2025-06-07 08:08:10,464 - ERROR - Transform Tables - FAILED
2025-06-07 08:08:10,464 - ERROR - [pid 19900] Worker Worker(salt=5985622694, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) failed    Transform()
Traceback (most recent call last):
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: operator does not exist: real = text
LINE 11:       d.product_name_length IS DISTINCT FROM p.product_name_...
                                     ^
HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\LENOVO THINKPAD\AppData\Local\Temp\ipykernel_19900\1126753333.py", line 130, in run
    session.execute(query)
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\orm\session.py", line 2362, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\orm\session.py", line 2256, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1418, in execute
    return meth(
           ^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\sql\elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) operator does not exist: real = text
LINE 11:       d.product_name_length IS DISTINCT FROM p.product_name_...
                                     ^
HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.

[SQL: -- Step 1: Expire the current records with changes
UPDATE dwh.dim_products d
SET 
    record_end_date = CURRENT_DATE - INTERVAL '1 day',
    is_current = FALSE
FROM stg.products p
WHERE d.product_id = p.product_id
  AND d.is_current = TRUE
  AND (
      d.product_category_name IS DISTINCT FROM p.product_category_name OR
      d.product_name_length IS DISTINCT FROM p.product_name_length OR
      d.product_description_length IS DISTINCT FROM p.product_description_length OR
      d.product_photos_qty IS DISTINCT FROM p.product_photos_qty OR
      d.product_weight_g IS DISTINCT FROM p.product_weight_g OR
      d.product_length_cm IS DISTINCT FROM p.product_length_cm OR
      d.product_height_cm IS DISTINCT FROM p.product_height_cm OR
      d.product_width_cm IS DISTINCT FROM p.product_width_cm
  );

-- Step 2: Insert new records (new or changed)
INSERT INTO dwh.dim_products (
    product_id,
    product_category_name,
    product_name_length,
    product_description_length,
    product_photos_qty,
    product_weight_g,
    product_length_cm,
    product_height_cm,
    product_width_cm,
    record_start_date,
    is_current
)
SELECT DISTINCT
    p.product_id,
    p.product_category_name,
    p.product_name_length,
    p.product_description_length,
    p.product_photos_qty,
    p.product_weight_g,
    p.product_length_cm,
    p.product_height_cm,
    p.product_width_cm,
    CURRENT_DATE,
    TRUE
FROM stg.products p
LEFT JOIN dwh.dim_products d
  ON p.product_id = d.product_id AND d.is_current = TRUE
WHERE 
    d.product_id IS NULL -- New product
    OR (
      d.product_category_name IS DISTINCT FROM p.product_category_name OR
      d.product_name_length IS DISTINCT FROM p.product_name_length OR
      d.product_description_length IS DISTINCT FROM p.product_description_length OR
      d.product_photos_qty IS DISTINCT FROM p.product_photos_qty OR
      d.product_weight_g IS DISTINCT FROM p.product_weight_g OR
      d.product_length_cm IS DISTINCT FROM p.product_length_cm OR
      d.product_height_cm IS DISTINCT FROM p.product_height_cm OR
      d.product_width_cm IS DISTINCT FROM p.product_width_cm
    );
]
(Background on this error at: https://sqlalche.me/e/20/f405)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 210, in run
    new_deps = self._run_get_new_deps()
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 138, in _run_get_new_deps
    task_gen = self.task.run()
               ^^^^^^^^^^^^^^^
  File "C:\Users\LENOVO THINKPAD\AppData\Local\Temp\ipykernel_19900\1126753333.py", line 193, in run
    raise Exception('Failed Transforming Tables')
Exception: Failed Transforming Tables
2025-06-07 08:08:10,468 - DEBUG - 1 running tasks, waiting for next task to finish
2025-06-07 08:08:10,471 - INFO - Informed scheduler that task   Transform__99914b932b   has status   FAILED
2025-06-07 08:08:10,471 - DEBUG - Asking scheduler for work...
2025-06-07 08:08:10,472 - DEBUG - Done
2025-06-07 08:08:10,473 - DEBUG - There are no more tasks to run at this time
2025-06-07 08:08:10,474 - DEBUG - There are 1 pending tasks possibly being run by other workers
2025-06-07 08:08:10,474 - DEBUG - There are 1 pending tasks unique to this worker
2025-06-07 08:08:10,475 - DEBUG - There are 1 pending tasks last scheduled by this worker
2025-06-07 08:08:10,476 - INFO - Worker Worker(salt=5985622694, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) was stopped. Shutting down Keep-Alive thread
2025-06-07 08:08:10,479 - INFO - 
===== Luigi Execution Summary =====

Scheduled 3 tasks of which:
* 2 complete ones were encountered:
    - 1 Extract()
    - 1 Load()
* 1 failed:
    - 1 Transform()

This progress looks :( because there were failed tasks

===== Luigi Execution Summary =====

2025-06-07 08:25:03,435 - INFO - logging already configured
2025-06-07 08:25:03,449 - DEBUG - Checking if Extract() is complete
2025-06-07 08:25:03,449 - INFO - Informed scheduler that task   Extract__99914b932b   has status   PENDING
2025-06-07 08:25:03,449 - INFO - Done scheduling tasks
2025-06-07 08:25:03,449 - INFO - Running Worker with 1 processes
2025-06-07 08:25:03,459 - DEBUG - Asking scheduler for work...
2025-06-07 08:25:03,459 - DEBUG - Pending tasks: 1
2025-06-07 08:25:03,461 - INFO - [pid 19900] Worker Worker(salt=7270319868, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) running   Extract()
2025-06-07 08:25:03,464 - INFO - ==================================STARTING EXTRACT DATA=======================================
2025-06-07 08:25:03,803 - INFO - EXTRACT 'public.geolocation' - SUCCESS.
2025-06-07 08:25:03,810 - INFO - EXTRACT 'public.product_category_name_translation' - SUCCESS.
2025-06-07 08:25:03,827 - INFO - EXTRACT 'public.sellers' - SUCCESS.
2025-06-07 08:25:04,430 - INFO - EXTRACT 'public.customers' - SUCCESS.
2025-06-07 08:25:04,699 - INFO - EXTRACT 'public.products' - SUCCESS.
2025-06-07 08:25:05,421 - INFO - EXTRACT 'public.orders' - SUCCESS.
2025-06-07 08:25:06,220 - INFO - EXTRACT 'public.order_items' - SUCCESS.
2025-06-07 08:25:06,790 - INFO - EXTRACT 'public.order_payments' - SUCCESS.
2025-06-07 08:25:07,544 - INFO - EXTRACT 'public.order_reviews' - SUCCESS.
2025-06-07 08:25:07,544 - INFO - Extract All Tables From Sources - SUCCESS
2025-06-07 08:25:07,546 - INFO - ==================================ENDING EXTRACT DATA=======================================
2025-06-07 08:25:07,556 - INFO - [pid 19900] Worker Worker(salt=7270319868, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) done      Extract()
2025-06-07 08:25:07,560 - DEBUG - 1 running tasks, waiting for next task to finish
2025-06-07 08:25:07,560 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2025-06-07 08:25:07,560 - DEBUG - Asking scheduler for work...
2025-06-07 08:25:07,562 - DEBUG - Done
2025-06-07 08:25:07,562 - DEBUG - There are no more tasks to run at this time
2025-06-07 08:25:07,562 - INFO - Worker Worker(salt=7270319868, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) was stopped. Shutting down Keep-Alive thread
2025-06-07 08:25:07,564 - INFO - 
===== Luigi Execution Summary =====

Scheduled 1 tasks of which:
* 1 ran successfully:
    - 1 Extract()

This progress looks :) because there were no failed tasks or missing dependencies

===== Luigi Execution Summary =====

2025-06-07 08:25:12,157 - INFO - logging already configured
2025-06-07 08:25:12,160 - DEBUG - Checking if Extract() is complete
2025-06-07 08:25:12,162 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2025-06-07 08:25:12,163 - DEBUG - Checking if Load() is complete
2025-06-07 08:25:12,164 - DEBUG - Checking if Extract() is complete
2025-06-07 08:25:12,165 - INFO - Informed scheduler that task   Load__99914b932b   has status   PENDING
2025-06-07 08:25:12,166 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2025-06-07 08:25:12,167 - INFO - Done scheduling tasks
2025-06-07 08:25:12,168 - INFO - Running Worker with 1 processes
2025-06-07 08:25:12,169 - DEBUG - Asking scheduler for work...
2025-06-07 08:25:12,170 - DEBUG - Pending tasks: 1
2025-06-07 08:25:12,172 - INFO - [pid 19900] Worker Worker(salt=4935772939, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) running   Load()
2025-06-07 08:25:12,175 - INFO - Read Load Query - SUCCESS
2025-06-07 08:25:13,404 - INFO - Read Extracted Data - SUCCESS
2025-06-07 08:25:13,405 - INFO - Connect to olist-dwh - SUCCESS
2025-06-07 08:25:13,510 - INFO - Truncate `public` Schema in olist-dwh - SUCCESS
2025-06-07 08:25:13,510 - INFO - ==================================STARTING LOAD DATA=======================================
2025-06-07 08:25:41,520 - INFO - LOAD All Tables To olist-dwh-public - SUCCESS
2025-06-07 08:25:41,523 - ERROR - LOAD All Tables To DWH-Staging - FAILED
2025-06-07 08:25:41,525 - ERROR - LOAD All Tables To DWH - FAILED
2025-06-07 08:25:41,525 - ERROR - [pid 19900] Worker Worker(salt=4935772939, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) failed    Load()
Traceback (most recent call last):
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedTable: relation "stg.geolocation" does not exist
LINE 1: INSERT INTO stg.geolocation
                    ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\LENOVO THINKPAD\AppData\Local\Temp\ipykernel_19900\922383790.py", line 250, in run
    session.execute(query)
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\orm\session.py", line 2362, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\orm\session.py", line 2256, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1418, in execute
    return meth(
           ^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\sql\elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedTable) relation "stg.geolocation" does not exist
LINE 1: INSERT INTO stg.geolocation
                    ^

[SQL: INSERT INTO stg.geolocation
    (geolocation_zip_code_prefix,
    geolocation_lat,
    geolocation_lng,
    geolocation_city,
    geolocation_state) 
SELECT
    geolocation_zip_code_prefix, 
    geolocation_lat,
    geolocation_lng,
    geolocation_city,
    geolocation_state
FROM public.geolocation

ON CONFLICT (geolocation_zip_code_prefix) DO NOTHING;]
(Background on this error at: https://sqlalche.me/e/20/f405)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\LENOVO THINKPAD\AppData\Local\Temp\ipykernel_19900\922383790.py", line 261, in run
    raise Exception('Failed Load Tables To DWH-Staging')
Exception: Failed Load Tables To DWH-Staging

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 210, in run
    new_deps = self._run_get_new_deps()
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 138, in _run_get_new_deps
    task_gen = self.task.run()
               ^^^^^^^^^^^^^^^
  File "C:\Users\LENOVO THINKPAD\AppData\Local\Temp\ipykernel_19900\922383790.py", line 300, in run
    raise Exception('Failed Load Tables To DWH')
Exception: Failed Load Tables To DWH
2025-06-07 08:25:41,531 - DEBUG - 1 running tasks, waiting for next task to finish
2025-06-07 08:25:41,534 - INFO - Informed scheduler that task   Load__99914b932b   has status   FAILED
2025-06-07 08:25:41,535 - DEBUG - Asking scheduler for work...
2025-06-07 08:25:41,535 - DEBUG - Done
2025-06-07 08:25:41,536 - DEBUG - There are no more tasks to run at this time
2025-06-07 08:25:41,536 - DEBUG - There are 1 pending tasks possibly being run by other workers
2025-06-07 08:25:41,538 - DEBUG - There are 1 pending tasks unique to this worker
2025-06-07 08:25:41,539 - DEBUG - There are 1 pending tasks last scheduled by this worker
2025-06-07 08:25:41,539 - INFO - Worker Worker(salt=4935772939, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) was stopped. Shutting down Keep-Alive thread
2025-06-07 08:25:41,543 - INFO - 
===== Luigi Execution Summary =====

Scheduled 2 tasks of which:
* 1 complete ones were encountered:
    - 1 Extract()
* 1 failed:
    - 1 Load()

This progress looks :( because there were failed tasks

===== Luigi Execution Summary =====

2025-06-07 08:26:50,085 - INFO - logging already configured
2025-06-07 08:26:50,087 - DEBUG - Checking if Extract() is complete
2025-06-07 08:26:50,089 - INFO - Informed scheduler that task   Extract__99914b932b   has status   PENDING
2025-06-07 08:26:50,091 - INFO - Done scheduling tasks
2025-06-07 08:26:50,092 - INFO - Running Worker with 1 processes
2025-06-07 08:26:50,093 - DEBUG - Asking scheduler for work...
2025-06-07 08:26:50,094 - DEBUG - Pending tasks: 1
2025-06-07 08:26:50,094 - INFO - [pid 19900] Worker Worker(salt=6751585784, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) running   Extract()
2025-06-07 08:26:50,096 - INFO - ==================================STARTING EXTRACT DATA=======================================
2025-06-07 08:26:50,301 - INFO - EXTRACT 'public.geolocation' - SUCCESS.
2025-06-07 08:26:50,310 - INFO - EXTRACT 'public.product_category_name_translation' - SUCCESS.
2025-06-07 08:26:50,328 - INFO - EXTRACT 'public.sellers' - SUCCESS.
2025-06-07 08:26:50,935 - INFO - EXTRACT 'public.customers' - SUCCESS.
2025-06-07 08:26:51,184 - INFO - EXTRACT 'public.products' - SUCCESS.
2025-06-07 08:26:51,889 - INFO - EXTRACT 'public.orders' - SUCCESS.
2025-06-07 08:26:52,665 - INFO - EXTRACT 'public.order_items' - SUCCESS.
2025-06-07 08:26:53,235 - INFO - EXTRACT 'public.order_payments' - SUCCESS.
2025-06-07 08:26:53,852 - INFO - EXTRACT 'public.order_reviews' - SUCCESS.
2025-06-07 08:26:53,852 - INFO - Extract All Tables From Sources - SUCCESS
2025-06-07 08:26:53,854 - INFO - ==================================ENDING EXTRACT DATA=======================================
2025-06-07 08:26:53,865 - INFO - [pid 19900] Worker Worker(salt=6751585784, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) done      Extract()
2025-06-07 08:26:53,866 - DEBUG - 1 running tasks, waiting for next task to finish
2025-06-07 08:26:53,867 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2025-06-07 08:26:53,869 - DEBUG - Asking scheduler for work...
2025-06-07 08:26:53,870 - DEBUG - Done
2025-06-07 08:26:53,870 - DEBUG - There are no more tasks to run at this time
2025-06-07 08:26:53,870 - INFO - Worker Worker(salt=6751585784, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) was stopped. Shutting down Keep-Alive thread
2025-06-07 08:26:53,873 - INFO - 
===== Luigi Execution Summary =====

Scheduled 1 tasks of which:
* 1 ran successfully:
    - 1 Extract()

This progress looks :) because there were no failed tasks or missing dependencies

===== Luigi Execution Summary =====

2025-06-07 08:26:58,630 - INFO - logging already configured
2025-06-07 08:26:58,632 - DEBUG - Checking if Extract() is complete
2025-06-07 08:26:58,634 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2025-06-07 08:26:58,635 - DEBUG - Checking if Load() is complete
2025-06-07 08:26:58,636 - DEBUG - Checking if Extract() is complete
2025-06-07 08:26:58,637 - INFO - Informed scheduler that task   Load__99914b932b   has status   PENDING
2025-06-07 08:26:58,639 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2025-06-07 08:26:58,639 - INFO - Done scheduling tasks
2025-06-07 08:26:58,640 - INFO - Running Worker with 1 processes
2025-06-07 08:26:58,640 - DEBUG - Asking scheduler for work...
2025-06-07 08:26:58,641 - DEBUG - Pending tasks: 1
2025-06-07 08:26:58,641 - INFO - [pid 19900] Worker Worker(salt=3433818828, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) running   Load()
2025-06-07 08:26:58,644 - INFO - Read Load Query - SUCCESS
2025-06-07 08:26:59,767 - INFO - Read Extracted Data - SUCCESS
2025-06-07 08:26:59,768 - INFO - Connect to olist-dwh - SUCCESS
2025-06-07 08:26:59,885 - INFO - Truncate `public` Schema in olist-dwh - SUCCESS
2025-06-07 08:26:59,886 - INFO - ==================================STARTING LOAD DATA=======================================
2025-06-07 08:27:31,053 - INFO - LOAD All Tables To olist-dwh-public - SUCCESS
2025-06-07 08:27:35,726 - ERROR - LOAD All Tables To DWH-Staging - FAILED
2025-06-07 08:27:35,726 - ERROR - LOAD All Tables To DWH - FAILED
2025-06-07 08:27:35,726 - ERROR - [pid 19900] Worker Worker(salt=3433818828, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) failed    Load()
Traceback (most recent call last):
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UniqueViolation: duplicate key value violates unique constraint "order_reviews_review_id_key"
DETAIL:  Key (review_id)=(3242cc306a9218d0377831e175d62fbf) already exists.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\LENOVO THINKPAD\AppData\Local\Temp\ipykernel_19900\922383790.py", line 250, in run
    session.execute(query)
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\orm\session.py", line 2362, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\orm\session.py", line 2256, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1418, in execute
    return meth(
           ^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\sql\elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "order_reviews_review_id_key"
DETAIL:  Key (review_id)=(3242cc306a9218d0377831e175d62fbf) already exists.

[SQL: INSERT INTO stg.order_reviews (
  review_id, order_id, 
  review_score, review_comment_title, review_comment_message, 
  review_creation_date
)
SELECT review_id, order_id, 
  review_score, review_comment_title, review_comment_message, 
  review_creation_date
FROM public.order_reviews;]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\LENOVO THINKPAD\AppData\Local\Temp\ipykernel_19900\922383790.py", line 261, in run
    raise Exception('Failed Load Tables To DWH-Staging')
Exception: Failed Load Tables To DWH-Staging

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 210, in run
    new_deps = self._run_get_new_deps()
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 138, in _run_get_new_deps
    task_gen = self.task.run()
               ^^^^^^^^^^^^^^^
  File "C:\Users\LENOVO THINKPAD\AppData\Local\Temp\ipykernel_19900\922383790.py", line 300, in run
    raise Exception('Failed Load Tables To DWH')
Exception: Failed Load Tables To DWH
2025-06-07 08:27:35,744 - DEBUG - 1 running tasks, waiting for next task to finish
2025-06-07 08:27:35,746 - INFO - Informed scheduler that task   Load__99914b932b   has status   FAILED
2025-06-07 08:27:35,746 - DEBUG - Asking scheduler for work...
2025-06-07 08:27:35,746 - DEBUG - Done
2025-06-07 08:27:35,746 - DEBUG - There are no more tasks to run at this time
2025-06-07 08:27:35,746 - DEBUG - There are 1 pending tasks possibly being run by other workers
2025-06-07 08:27:35,746 - DEBUG - There are 1 pending tasks unique to this worker
2025-06-07 08:27:35,746 - DEBUG - There are 1 pending tasks last scheduled by this worker
2025-06-07 08:27:35,746 - INFO - Worker Worker(salt=3433818828, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) was stopped. Shutting down Keep-Alive thread
2025-06-07 08:27:35,746 - INFO - 
===== Luigi Execution Summary =====

Scheduled 2 tasks of which:
* 1 complete ones were encountered:
    - 1 Extract()
* 1 failed:
    - 1 Load()

This progress looks :( because there were failed tasks

===== Luigi Execution Summary =====

2025-06-07 08:29:50,797 - INFO - logging already configured
2025-06-07 08:29:50,800 - DEBUG - Checking if Extract() is complete
2025-06-07 08:29:50,800 - INFO - Informed scheduler that task   Extract__99914b932b   has status   PENDING
2025-06-07 08:29:50,800 - DEBUG - Checking if Load() is complete
2025-06-07 08:29:50,800 - DEBUG - Checking if Extract() is complete
2025-06-07 08:29:50,805 - INFO - Informed scheduler that task   Load__99914b932b   has status   PENDING
2025-06-07 08:29:50,805 - INFO - Informed scheduler that task   Extract__99914b932b   has status   PENDING
2025-06-07 08:29:50,805 - INFO - Done scheduling tasks
2025-06-07 08:29:50,807 - INFO - Running Worker with 1 processes
2025-06-07 08:29:50,807 - DEBUG - Asking scheduler for work...
2025-06-07 08:29:50,809 - DEBUG - Pending tasks: 2
2025-06-07 08:29:50,809 - INFO - [pid 19900] Worker Worker(salt=2899621874, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) running   Extract()
2025-06-07 08:29:50,810 - ERROR - [pid 19900] Worker Worker(salt=2899621874, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) failed    Extract()
Traceback (most recent call last):
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 210, in run
    new_deps = self._run_get_new_deps()
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 138, in _run_get_new_deps
    task_gen = self.task.run()
               ^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\Documents\Github\Pacmann---Data-Storage_-Warehouse--Mart---Lake\mentoring 2\olist-dwh-project\pipeline\extract.py", line 43, in run
    os.makedirs(os.path.dirname(self.output().path), exist_ok=True)
                                ^^^^^^^^^^^^^^^^^^
AttributeError: 'list' object has no attribute 'path'
2025-06-07 08:29:50,813 - DEBUG - 1 running tasks, waiting for next task to finish
2025-06-07 08:29:50,816 - INFO - Informed scheduler that task   Extract__99914b932b   has status   FAILED
2025-06-07 08:29:50,816 - DEBUG - Asking scheduler for work...
2025-06-07 08:29:50,817 - DEBUG - Done
2025-06-07 08:29:50,818 - DEBUG - There are no more tasks to run at this time
2025-06-07 08:29:50,819 - DEBUG - There are 2 pending tasks possibly being run by other workers
2025-06-07 08:29:50,819 - DEBUG - There are 2 pending tasks unique to this worker
2025-06-07 08:29:50,821 - DEBUG - There are 2 pending tasks last scheduled by this worker
2025-06-07 08:29:50,821 - INFO - Worker Worker(salt=2899621874, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) was stopped. Shutting down Keep-Alive thread
2025-06-07 08:29:50,824 - INFO - 
===== Luigi Execution Summary =====

Scheduled 2 tasks of which:
* 1 failed:
    - 1 Extract()
* 1 were left pending, among these:
    * 1 had failed dependencies:
        - 1 Load()

This progress looks :( because there were failed tasks

===== Luigi Execution Summary =====

2025-06-07 08:30:00,341 - INFO - logging already configured
2025-06-07 08:30:00,344 - DEBUG - Checking if Extract() is complete
2025-06-07 08:30:00,347 - INFO - Informed scheduler that task   Extract__99914b932b   has status   PENDING
2025-06-07 08:30:00,348 - INFO - Done scheduling tasks
2025-06-07 08:30:00,348 - INFO - Running Worker with 1 processes
2025-06-07 08:30:00,350 - DEBUG - Asking scheduler for work...
2025-06-07 08:30:00,351 - DEBUG - Pending tasks: 1
2025-06-07 08:30:00,351 - INFO - [pid 19900] Worker Worker(salt=922676728, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) running   Extract()
2025-06-07 08:30:00,353 - INFO - ==================================STARTING EXTRACT DATA=======================================
2025-06-07 08:30:00,545 - INFO - EXTRACT 'public.geolocation' - SUCCESS.
2025-06-07 08:30:00,555 - INFO - EXTRACT 'public.product_category_name_translation' - SUCCESS.
2025-06-07 08:30:00,576 - INFO - EXTRACT 'public.sellers' - SUCCESS.
2025-06-07 08:30:01,175 - INFO - EXTRACT 'public.customers' - SUCCESS.
2025-06-07 08:30:01,424 - INFO - EXTRACT 'public.products' - SUCCESS.
2025-06-07 08:30:02,245 - INFO - EXTRACT 'public.orders' - SUCCESS.
2025-06-07 08:30:03,051 - INFO - EXTRACT 'public.order_items' - SUCCESS.
2025-06-07 08:30:03,615 - INFO - EXTRACT 'public.order_payments' - SUCCESS.
2025-06-07 08:30:04,251 - INFO - EXTRACT 'public.order_reviews' - SUCCESS.
2025-06-07 08:30:04,251 - INFO - Extract All Tables From Sources - SUCCESS
2025-06-07 08:30:04,253 - INFO - ==================================ENDING EXTRACT DATA=======================================
2025-06-07 08:30:04,267 - INFO - [pid 19900] Worker Worker(salt=922676728, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) done      Extract()
2025-06-07 08:30:04,269 - DEBUG - 1 running tasks, waiting for next task to finish
2025-06-07 08:30:04,270 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2025-06-07 08:30:04,272 - DEBUG - Asking scheduler for work...
2025-06-07 08:30:04,273 - DEBUG - Done
2025-06-07 08:30:04,273 - DEBUG - There are no more tasks to run at this time
2025-06-07 08:30:04,274 - INFO - Worker Worker(salt=922676728, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) was stopped. Shutting down Keep-Alive thread
2025-06-07 08:30:04,277 - INFO - 
===== Luigi Execution Summary =====

Scheduled 1 tasks of which:
* 1 ran successfully:
    - 1 Extract()

This progress looks :) because there were no failed tasks or missing dependencies

===== Luigi Execution Summary =====

2025-06-07 08:30:07,747 - INFO - logging already configured
2025-06-07 08:30:07,749 - DEBUG - Checking if Extract() is complete
2025-06-07 08:30:07,752 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2025-06-07 08:30:07,753 - DEBUG - Checking if Load() is complete
2025-06-07 08:30:07,754 - DEBUG - Checking if Extract() is complete
2025-06-07 08:30:07,755 - INFO - Informed scheduler that task   Load__99914b932b   has status   PENDING
2025-06-07 08:30:07,756 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2025-06-07 08:30:07,756 - INFO - Done scheduling tasks
2025-06-07 08:30:07,756 - INFO - Running Worker with 1 processes
2025-06-07 08:30:07,757 - DEBUG - Asking scheduler for work...
2025-06-07 08:30:07,757 - DEBUG - Pending tasks: 1
2025-06-07 08:30:07,758 - INFO - [pid 19900] Worker Worker(salt=8998745534, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) running   Load()
2025-06-07 08:30:07,772 - INFO - Read Load Query - SUCCESS
2025-06-07 08:30:08,930 - INFO - Read Extracted Data - SUCCESS
2025-06-07 08:30:08,931 - INFO - Connect to olist-dwh - SUCCESS
2025-06-07 08:30:09,076 - INFO - Truncate `public` Schema in olist-dwh - SUCCESS
2025-06-07 08:30:09,076 - INFO - ==================================STARTING LOAD DATA=======================================
2025-06-07 08:30:38,504 - INFO - LOAD All Tables To olist-dwh-public - SUCCESS
2025-06-07 08:30:45,175 - INFO - LOAD All Tables To DWH-Staging - SUCCESS
2025-06-07 08:30:45,177 - INFO - ==================================ENDING LOAD DATA=======================================
2025-06-07 08:30:45,208 - INFO - [pid 19900] Worker Worker(salt=8998745534, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) done      Load()
2025-06-07 08:30:45,211 - DEBUG - 1 running tasks, waiting for next task to finish
2025-06-07 08:30:45,212 - INFO - Informed scheduler that task   Load__99914b932b   has status   DONE
2025-06-07 08:30:45,213 - DEBUG - Asking scheduler for work...
2025-06-07 08:30:45,213 - DEBUG - Done
2025-06-07 08:30:45,214 - DEBUG - There are no more tasks to run at this time
2025-06-07 08:30:45,215 - INFO - Worker Worker(salt=8998745534, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) was stopped. Shutting down Keep-Alive thread
2025-06-07 08:30:45,217 - INFO - 
===== Luigi Execution Summary =====

Scheduled 2 tasks of which:
* 1 complete ones were encountered:
    - 1 Extract()
* 1 ran successfully:
    - 1 Load()

This progress looks :) because there were no failed tasks or missing dependencies

===== Luigi Execution Summary =====

2025-06-07 08:31:11,419 - INFO - logging already configured
2025-06-07 08:31:11,422 - DEBUG - Checking if Extract() is complete
2025-06-07 08:31:11,424 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2025-06-07 08:31:11,425 - DEBUG - Checking if Load() is complete
2025-06-07 08:31:11,426 - INFO - Informed scheduler that task   Load__99914b932b   has status   DONE
2025-06-07 08:31:11,427 - DEBUG - Checking if Transform() is complete
2025-06-07 08:31:11,428 - DEBUG - Checking if Load() is complete
2025-06-07 08:31:11,430 - INFO - Informed scheduler that task   Transform__99914b932b   has status   PENDING
2025-06-07 08:31:11,431 - INFO - Informed scheduler that task   Load__99914b932b   has status   DONE
2025-06-07 08:31:11,432 - INFO - Done scheduling tasks
2025-06-07 08:31:11,433 - INFO - Running Worker with 1 processes
2025-06-07 08:31:11,434 - DEBUG - Asking scheduler for work...
2025-06-07 08:31:11,434 - DEBUG - Pending tasks: 1
2025-06-07 08:31:11,435 - INFO - [pid 19900] Worker Worker(salt=7739139678, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) running   Transform()
2025-06-07 08:31:11,437 - INFO - Connect to DWH - SUCCESS
2025-06-07 08:31:11,439 - INFO - Read Transform Query - SUCCESS
2025-06-07 08:31:11,439 - INFO - ==================================STARTING TRANSFROM DATA=======================================
2025-06-07 08:31:11,588 - INFO - Transform to 'dwh.dim_geolocation' - SUCCESS
2025-06-07 08:31:11,594 - INFO - Transform to 'dwh.dim_product_category' - SUCCESS
2025-06-07 08:31:11,616 - INFO - Transform to 'dwh.dim_sellers' - SUCCESS
2025-06-07 08:31:12,311 - INFO - Transform to 'dwh.dim_customers' - SUCCESS
2025-06-07 08:31:12,586 - INFO - Transform to 'dwh.dim_products' - SUCCESS
2025-06-07 08:31:12,589 - ERROR - Transform to All Dimensions and Fact Tables - FAILED
2025-06-07 08:31:12,593 - ERROR - Transform Tables - FAILED
2025-06-07 08:31:12,593 - ERROR - [pid 19900] Worker Worker(salt=7739139678, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) failed    Transform()
Traceback (most recent call last):
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedColumn: column "customer_sk" of relation "fact_orders_comprehensive" does not exist
LINE 3:     customer_sk, seller_sk, product_sk, product_category_sk,
            ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\LENOVO THINKPAD\AppData\Local\Temp\ipykernel_19900\1126753333.py", line 134, in run
    session.execute(query)
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\orm\session.py", line 2362, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\orm\session.py", line 2256, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1418, in execute
    return meth(
           ^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\sql\elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedColumn) column "customer_sk" of relation "fact_orders_comprehensive" does not exist
LINE 3:     customer_sk, seller_sk, product_sk, product_category_sk,
            ^

[SQL: INSERT INTO dwh.fact_orders_comprehensive (
    order_id, order_date_id, order_time_id,
    customer_sk, seller_sk, product_sk, product_category_sk,
    price, freight_value, quantity
)
SELECT
    oi.order_id, dd.full_date, dt.time_id,
    dc.customer_sk, ds.seller_sk, dp.product_sk, dpc.product_category_sk,
    oi.price, oi.freight_value, oi.quantity

FROM stg.order_items oi
JOIN stg.orders o ON oi.order_id = o.order_id

JOIN dwh.dim_date dd ON dd.full_date = DATE(o.order_approved_at)
JOIN dwh.dim_time dt ON
    EXTRACT(HOUR FROM o.order_approved_at)::INT = dt.hours AND
    EXTRACT(MINUTE FROM o.order_approved_at)::INT = dt.minutes AND
    EXTRACT(SECOND FROM o.order_approved_at)::INT = dt.seconds

JOIN dwh.dim_customers dc ON dc.customer_id = o.customer_id AND dc.is_current = TRUE
JOIN dwh.dim_sellers ds ON ds.seller_id = oi.seller_id AND ds.is_current = TRUE
JOIN dwh.dim_products dp ON dp.product_id = oi.product_id AND dp.is_current = TRUE
JOIN dwh.dim_product_category dpc ON dpc.product_category_name = dp.product_category_name;]
(Background on this error at: https://sqlalche.me/e/20/f405)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 210, in run
    new_deps = self._run_get_new_deps()
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 138, in _run_get_new_deps
    task_gen = self.task.run()
               ^^^^^^^^^^^^^^^
  File "C:\Users\LENOVO THINKPAD\AppData\Local\Temp\ipykernel_19900\1126753333.py", line 193, in run
    raise Exception('Failed Transforming Tables')
Exception: Failed Transforming Tables
2025-06-07 08:31:12,598 - DEBUG - 1 running tasks, waiting for next task to finish
2025-06-07 08:31:12,601 - INFO - Informed scheduler that task   Transform__99914b932b   has status   FAILED
2025-06-07 08:31:12,602 - DEBUG - Asking scheduler for work...
2025-06-07 08:31:12,603 - DEBUG - Done
2025-06-07 08:31:12,604 - DEBUG - There are no more tasks to run at this time
2025-06-07 08:31:12,605 - DEBUG - There are 1 pending tasks possibly being run by other workers
2025-06-07 08:31:12,606 - DEBUG - There are 1 pending tasks unique to this worker
2025-06-07 08:31:12,606 - DEBUG - There are 1 pending tasks last scheduled by this worker
2025-06-07 08:31:12,607 - INFO - Worker Worker(salt=7739139678, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) was stopped. Shutting down Keep-Alive thread
2025-06-07 08:31:12,610 - INFO - 
===== Luigi Execution Summary =====

Scheduled 3 tasks of which:
* 2 complete ones were encountered:
    - 1 Extract()
    - 1 Load()
* 1 failed:
    - 1 Transform()

This progress looks :( because there were failed tasks

===== Luigi Execution Summary =====

2025-06-07 08:41:32,654 - INFO - logging already configured
2025-06-07 08:41:32,657 - DEBUG - Checking if Extract() is complete
2025-06-07 08:41:32,658 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2025-06-07 08:41:32,660 - DEBUG - Checking if Load() is complete
2025-06-07 08:41:32,660 - INFO - Informed scheduler that task   Load__99914b932b   has status   DONE
2025-06-07 08:41:32,661 - DEBUG - Checking if Transform() is complete
2025-06-07 08:41:32,662 - INFO - Informed scheduler that task   Transform__99914b932b   has status   DONE
2025-06-07 08:41:32,662 - INFO - Done scheduling tasks
2025-06-07 08:41:32,662 - INFO - Running Worker with 1 processes
2025-06-07 08:41:32,666 - DEBUG - Asking scheduler for work...
2025-06-07 08:41:32,666 - DEBUG - Done
2025-06-07 08:41:32,667 - DEBUG - There are no more tasks to run at this time
2025-06-07 08:41:32,667 - INFO - Worker Worker(salt=9710306734, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) was stopped. Shutting down Keep-Alive thread
2025-06-07 08:41:32,686 - INFO - 
===== Luigi Execution Summary =====

Scheduled 3 tasks of which:
* 3 complete ones were encountered:
    - 1 Extract()
    - 1 Load()
    - 1 Transform()

Did not run any tasks
This progress looks :) because there were no failed tasks or missing dependencies

===== Luigi Execution Summary =====

2025-06-07 08:42:02,346 - INFO - logging already configured
2025-06-07 08:42:02,348 - DEBUG - Checking if Extract() is complete
2025-06-07 08:42:02,351 - INFO - Informed scheduler that task   Extract__99914b932b   has status   PENDING
2025-06-07 08:42:02,353 - INFO - Done scheduling tasks
2025-06-07 08:42:02,354 - INFO - Running Worker with 1 processes
2025-06-07 08:42:02,356 - DEBUG - Asking scheduler for work...
2025-06-07 08:42:02,358 - DEBUG - Pending tasks: 1
2025-06-07 08:42:02,359 - INFO - [pid 19900] Worker Worker(salt=7582848513, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) running   Extract()
2025-06-07 08:42:02,364 - INFO - ==================================STARTING EXTRACT DATA=======================================
2025-06-07 08:42:02,647 - INFO - EXTRACT 'public.geolocation' - SUCCESS.
2025-06-07 08:42:02,661 - INFO - EXTRACT 'public.product_category_name_translation' - SUCCESS.
2025-06-07 08:42:02,700 - INFO - EXTRACT 'public.sellers' - SUCCESS.
2025-06-07 08:42:03,475 - INFO - EXTRACT 'public.customers' - SUCCESS.
2025-06-07 08:42:03,836 - INFO - EXTRACT 'public.products' - SUCCESS.
2025-06-07 08:42:04,531 - INFO - EXTRACT 'public.orders' - SUCCESS.
2025-06-07 08:42:05,297 - INFO - EXTRACT 'public.order_items' - SUCCESS.
2025-06-07 08:42:05,869 - INFO - EXTRACT 'public.order_payments' - SUCCESS.
2025-06-07 08:42:06,500 - INFO - EXTRACT 'public.order_reviews' - SUCCESS.
2025-06-07 08:42:06,500 - INFO - Extract All Tables From Sources - SUCCESS
2025-06-07 08:42:06,502 - INFO - ==================================ENDING EXTRACT DATA=======================================
2025-06-07 08:42:06,515 - INFO - [pid 19900] Worker Worker(salt=7582848513, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) done      Extract()
2025-06-07 08:42:06,517 - DEBUG - 1 running tasks, waiting for next task to finish
2025-06-07 08:42:06,518 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2025-06-07 08:42:06,520 - DEBUG - Asking scheduler for work...
2025-06-07 08:42:06,520 - DEBUG - Done
2025-06-07 08:42:06,521 - DEBUG - There are no more tasks to run at this time
2025-06-07 08:42:06,521 - INFO - Worker Worker(salt=7582848513, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) was stopped. Shutting down Keep-Alive thread
2025-06-07 08:42:06,524 - INFO - 
===== Luigi Execution Summary =====

Scheduled 1 tasks of which:
* 1 ran successfully:
    - 1 Extract()

This progress looks :) because there were no failed tasks or missing dependencies

===== Luigi Execution Summary =====

2025-06-07 08:42:12,545 - INFO - logging already configured
2025-06-07 08:42:12,548 - DEBUG - Checking if Extract() is complete
2025-06-07 08:42:12,548 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2025-06-07 08:42:12,548 - DEBUG - Checking if Load() is complete
2025-06-07 08:42:12,551 - DEBUG - Checking if Extract() is complete
2025-06-07 08:42:12,553 - INFO - Informed scheduler that task   Load__99914b932b   has status   PENDING
2025-06-07 08:42:12,553 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2025-06-07 08:42:12,555 - INFO - Done scheduling tasks
2025-06-07 08:42:12,555 - INFO - Running Worker with 1 processes
2025-06-07 08:42:12,556 - DEBUG - Asking scheduler for work...
2025-06-07 08:42:12,556 - DEBUG - Pending tasks: 1
2025-06-07 08:42:12,556 - INFO - [pid 19900] Worker Worker(salt=6313868494, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) running   Load()
2025-06-07 08:42:12,560 - INFO - Read Load Query - SUCCESS
2025-06-07 08:42:13,821 - INFO - Read Extracted Data - SUCCESS
2025-06-07 08:42:13,822 - INFO - Connect to olist-dwh - SUCCESS
2025-06-07 08:42:13,934 - INFO - Truncate `public` Schema in olist-dwh - SUCCESS
2025-06-07 08:42:13,935 - INFO - ==================================STARTING LOAD DATA=======================================
2025-06-07 08:42:42,742 - INFO - LOAD All Tables To olist-dwh-public - SUCCESS
2025-06-07 08:42:46,668 - INFO - LOAD All Tables To DWH-Staging - SUCCESS
2025-06-07 08:42:46,672 - INFO - ==================================ENDING LOAD DATA=======================================
2025-06-07 08:42:46,700 - INFO - [pid 19900] Worker Worker(salt=6313868494, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) done      Load()
2025-06-07 08:42:46,700 - DEBUG - 1 running tasks, waiting for next task to finish
2025-06-07 08:42:46,709 - INFO - Informed scheduler that task   Load__99914b932b   has status   DONE
2025-06-07 08:42:46,709 - DEBUG - Asking scheduler for work...
2025-06-07 08:42:46,711 - DEBUG - Done
2025-06-07 08:42:46,711 - DEBUG - There are no more tasks to run at this time
2025-06-07 08:42:46,711 - INFO - Worker Worker(salt=6313868494, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) was stopped. Shutting down Keep-Alive thread
2025-06-07 08:42:46,711 - INFO - 
===== Luigi Execution Summary =====

Scheduled 2 tasks of which:
* 1 complete ones were encountered:
    - 1 Extract()
* 1 ran successfully:
    - 1 Load()

This progress looks :) because there were no failed tasks or missing dependencies

===== Luigi Execution Summary =====

2025-06-07 08:42:58,478 - INFO - logging already configured
2025-06-07 08:42:58,481 - DEBUG - Checking if Extract() is complete
2025-06-07 08:42:58,481 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2025-06-07 08:42:58,483 - DEBUG - Checking if Load() is complete
2025-06-07 08:42:58,485 - INFO - Informed scheduler that task   Load__99914b932b   has status   DONE
2025-06-07 08:42:58,486 - DEBUG - Checking if Transform() is complete
2025-06-07 08:42:58,486 - DEBUG - Checking if Load() is complete
2025-06-07 08:42:58,486 - INFO - Informed scheduler that task   Transform__99914b932b   has status   PENDING
2025-06-07 08:42:58,486 - INFO - Informed scheduler that task   Load__99914b932b   has status   DONE
2025-06-07 08:42:58,490 - INFO - Done scheduling tasks
2025-06-07 08:42:58,490 - INFO - Running Worker with 1 processes
2025-06-07 08:42:58,490 - DEBUG - Asking scheduler for work...
2025-06-07 08:42:58,492 - DEBUG - Pending tasks: 1
2025-06-07 08:42:58,492 - INFO - [pid 19900] Worker Worker(salt=5637021617, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) running   Transform()
2025-06-07 08:42:58,495 - INFO - Connect to DWH - SUCCESS
2025-06-07 08:42:58,497 - INFO - Read Transform Query - SUCCESS
2025-06-07 08:42:58,497 - INFO - ==================================STARTING TRANSFROM DATA=======================================
2025-06-07 08:42:58,683 - INFO - Transform to 'dwh.dim_geolocation' - SUCCESS
2025-06-07 08:42:58,689 - INFO - Transform to 'dwh.dim_product_category' - SUCCESS
2025-06-07 08:42:58,712 - INFO - Transform to 'dwh.dim_sellers' - SUCCESS
2025-06-07 08:42:59,486 - INFO - Transform to 'dwh.dim_customers' - SUCCESS
2025-06-07 08:42:59,751 - INFO - Transform to 'dwh.dim_products' - SUCCESS
2025-06-07 08:42:59,757 - ERROR - Transform to All Dimensions and Fact Tables - FAILED
2025-06-07 08:42:59,759 - ERROR - Transform Tables - FAILED
2025-06-07 08:42:59,759 - ERROR - [pid 19900] Worker Worker(salt=5637021617, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) failed    Transform()
Traceback (most recent call last):
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedFunction: function pg_catalog.extract(unknown, text) does not exist
LINE 16:     EXTRACT(HOUR FROM o.order_approved_at)::INT = dt.hours A...
             ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\LENOVO THINKPAD\AppData\Local\Temp\ipykernel_19900\4240733592.py", line 134, in run
    session.execute(query)
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\orm\session.py", line 2362, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\orm\session.py", line 2256, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1418, in execute
    return meth(
           ^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\sql\elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedFunction) function pg_catalog.extract(unknown, text) does not exist
LINE 16:     EXTRACT(HOUR FROM o.order_approved_at)::INT = dt.hours A...
             ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: INSERT INTO dwh.fact_orders_comprehensive (
    order_id, order_date_id, order_time_id,
    customer_sk, seller_sk, product_sk, product_category_sk,
    price, freight_value, quantity
)
SELECT
    oi.order_id, dd.full_date, dt.time_id,
    dc.customer_sk, ds.seller_sk, dp.product_sk, dpc.product_category_sk,
    oi.price, oi.freight_value, oi.quantity

FROM stg.order_items oi
JOIN stg.orders o ON oi.order_id = o.order_id

JOIN dwh.dim_date dd ON dd.full_date = DATE(o.order_approved_at)
JOIN dwh.dim_time dt ON
    EXTRACT(HOUR FROM o.order_approved_at)::INT = dt.hours AND
    EXTRACT(MINUTE FROM o.order_approved_at)::INT = dt.minutes AND
    EXTRACT(SECOND FROM o.order_approved_at)::INT = dt.seconds

JOIN dwh.dim_customers dc ON dc.customer_id = o.customer_id AND dc.is_current = TRUE
JOIN dwh.dim_sellers ds ON ds.seller_id = oi.seller_id AND ds.is_current = TRUE
JOIN dwh.dim_products dp ON dp.product_id = oi.product_id AND dp.is_current = TRUE
JOIN dwh.dim_product_category dpc ON dpc.product_category_name = dp.product_category_name;]
(Background on this error at: https://sqlalche.me/e/20/f405)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 210, in run
    new_deps = self._run_get_new_deps()
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 138, in _run_get_new_deps
    task_gen = self.task.run()
               ^^^^^^^^^^^^^^^
  File "C:\Users\LENOVO THINKPAD\AppData\Local\Temp\ipykernel_19900\4240733592.py", line 193, in run
    raise Exception('Failed Transforming Tables')
Exception: Failed Transforming Tables
2025-06-07 08:42:59,763 - DEBUG - 1 running tasks, waiting for next task to finish
2025-06-07 08:42:59,766 - INFO - Informed scheduler that task   Transform__99914b932b   has status   FAILED
2025-06-07 08:42:59,767 - DEBUG - Asking scheduler for work...
2025-06-07 08:42:59,767 - DEBUG - Done
2025-06-07 08:42:59,769 - DEBUG - There are no more tasks to run at this time
2025-06-07 08:42:59,770 - DEBUG - There are 1 pending tasks possibly being run by other workers
2025-06-07 08:42:59,770 - DEBUG - There are 1 pending tasks unique to this worker
2025-06-07 08:42:59,771 - DEBUG - There are 1 pending tasks last scheduled by this worker
2025-06-07 08:42:59,771 - INFO - Worker Worker(salt=5637021617, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) was stopped. Shutting down Keep-Alive thread
2025-06-07 08:42:59,774 - INFO - 
===== Luigi Execution Summary =====

Scheduled 3 tasks of which:
* 2 complete ones were encountered:
    - 1 Extract()
    - 1 Load()
* 1 failed:
    - 1 Transform()

This progress looks :( because there were failed tasks

===== Luigi Execution Summary =====

2025-06-07 08:54:57,814 - INFO - logging already configured
2025-06-07 08:54:57,816 - DEBUG - Checking if Extract() is complete
2025-06-07 08:54:57,817 - INFO - Informed scheduler that task   Extract__99914b932b   has status   PENDING
2025-06-07 08:54:57,819 - INFO - Done scheduling tasks
2025-06-07 08:54:57,820 - INFO - Running Worker with 1 processes
2025-06-07 08:54:57,821 - DEBUG - Asking scheduler for work...
2025-06-07 08:54:57,822 - DEBUG - Pending tasks: 1
2025-06-07 08:54:57,823 - INFO - [pid 19900] Worker Worker(salt=2619639638, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) running   Extract()
2025-06-07 08:54:57,825 - INFO - ==================================STARTING EXTRACT DATA=======================================
2025-06-07 08:54:57,990 - INFO - EXTRACT 'public.geolocation' - SUCCESS.
2025-06-07 08:54:57,998 - INFO - EXTRACT 'public.product_category_name_translation' - SUCCESS.
2025-06-07 08:54:58,016 - INFO - EXTRACT 'public.sellers' - SUCCESS.
2025-06-07 08:54:58,619 - INFO - EXTRACT 'public.customers' - SUCCESS.
2025-06-07 08:54:58,869 - INFO - EXTRACT 'public.products' - SUCCESS.
2025-06-07 08:54:59,572 - INFO - EXTRACT 'public.orders' - SUCCESS.
2025-06-07 08:55:00,387 - INFO - EXTRACT 'public.order_items' - SUCCESS.
2025-06-07 08:55:01,082 - INFO - EXTRACT 'public.order_payments' - SUCCESS.
2025-06-07 08:55:01,756 - INFO - EXTRACT 'public.order_reviews' - SUCCESS.
2025-06-07 08:55:01,756 - INFO - Extract All Tables From Sources - SUCCESS
2025-06-07 08:55:01,758 - INFO - ==================================ENDING EXTRACT DATA=======================================
2025-06-07 08:55:01,770 - INFO - [pid 19900] Worker Worker(salt=2619639638, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) done      Extract()
2025-06-07 08:55:01,772 - DEBUG - 1 running tasks, waiting for next task to finish
2025-06-07 08:55:01,773 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2025-06-07 08:55:01,774 - DEBUG - Asking scheduler for work...
2025-06-07 08:55:01,775 - DEBUG - Done
2025-06-07 08:55:01,775 - DEBUG - There are no more tasks to run at this time
2025-06-07 08:55:01,776 - INFO - Worker Worker(salt=2619639638, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) was stopped. Shutting down Keep-Alive thread
2025-06-07 08:55:01,780 - INFO - 
===== Luigi Execution Summary =====

Scheduled 1 tasks of which:
* 1 ran successfully:
    - 1 Extract()

This progress looks :) because there were no failed tasks or missing dependencies

===== Luigi Execution Summary =====

2025-06-07 08:55:06,837 - INFO - logging already configured
2025-06-07 08:55:06,840 - DEBUG - Checking if Extract() is complete
2025-06-07 08:55:06,841 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2025-06-07 08:55:06,843 - DEBUG - Checking if Load() is complete
2025-06-07 08:55:06,844 - DEBUG - Checking if Extract() is complete
2025-06-07 08:55:06,846 - INFO - Informed scheduler that task   Load__99914b932b   has status   PENDING
2025-06-07 08:55:06,846 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2025-06-07 08:55:06,847 - INFO - Done scheduling tasks
2025-06-07 08:55:06,848 - INFO - Running Worker with 1 processes
2025-06-07 08:55:06,849 - DEBUG - Asking scheduler for work...
2025-06-07 08:55:06,849 - DEBUG - Pending tasks: 1
2025-06-07 08:55:06,850 - INFO - [pid 19900] Worker Worker(salt=3157120996, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) running   Load()
2025-06-07 08:55:06,853 - INFO - Read Load Query - SUCCESS
2025-06-07 08:55:08,095 - INFO - Read Extracted Data - SUCCESS
2025-06-07 08:55:08,097 - INFO - Connect to olist-dwh - SUCCESS
2025-06-07 08:55:08,227 - INFO - Truncate `public` Schema in olist-dwh - SUCCESS
2025-06-07 08:55:08,228 - INFO - ==================================STARTING LOAD DATA=======================================
2025-06-07 08:55:37,231 - INFO - LOAD All Tables To olist-dwh-public - SUCCESS
2025-06-07 08:55:40,947 - INFO - LOAD All Tables To DWH-Staging - SUCCESS
2025-06-07 08:55:40,947 - INFO - ==================================ENDING LOAD DATA=======================================
2025-06-07 08:55:40,980 - INFO - [pid 19900] Worker Worker(salt=3157120996, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) done      Load()
2025-06-07 08:55:40,980 - DEBUG - 1 running tasks, waiting for next task to finish
2025-06-07 08:55:40,982 - INFO - Informed scheduler that task   Load__99914b932b   has status   DONE
2025-06-07 08:55:40,982 - DEBUG - Asking scheduler for work...
2025-06-07 08:55:40,984 - DEBUG - Done
2025-06-07 08:55:40,984 - DEBUG - There are no more tasks to run at this time
2025-06-07 08:55:40,984 - INFO - Worker Worker(salt=3157120996, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) was stopped. Shutting down Keep-Alive thread
2025-06-07 08:55:40,986 - INFO - 
===== Luigi Execution Summary =====

Scheduled 2 tasks of which:
* 1 complete ones were encountered:
    - 1 Extract()
* 1 ran successfully:
    - 1 Load()

This progress looks :) because there were no failed tasks or missing dependencies

===== Luigi Execution Summary =====

2025-06-07 08:55:49,613 - INFO - logging already configured
2025-06-07 08:55:49,616 - DEBUG - Checking if Extract() is complete
2025-06-07 08:55:49,618 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2025-06-07 08:55:49,618 - DEBUG - Checking if Load() is complete
2025-06-07 08:55:49,619 - INFO - Informed scheduler that task   Load__99914b932b   has status   DONE
2025-06-07 08:55:49,620 - DEBUG - Checking if Transform() is complete
2025-06-07 08:55:49,622 - DEBUG - Checking if Load() is complete
2025-06-07 08:55:49,623 - INFO - Informed scheduler that task   Transform__99914b932b   has status   PENDING
2025-06-07 08:55:49,625 - INFO - Informed scheduler that task   Load__99914b932b   has status   DONE
2025-06-07 08:55:49,625 - INFO - Done scheduling tasks
2025-06-07 08:55:49,626 - INFO - Running Worker with 1 processes
2025-06-07 08:55:49,627 - DEBUG - Asking scheduler for work...
2025-06-07 08:55:49,627 - DEBUG - Pending tasks: 1
2025-06-07 08:55:49,628 - INFO - [pid 19900] Worker Worker(salt=9655868800, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) running   Transform()
2025-06-07 08:55:49,630 - INFO - Connect to DWH - SUCCESS
2025-06-07 08:55:49,645 - INFO - Read Transform Query - SUCCESS
2025-06-07 08:55:49,645 - INFO - ==================================STARTING TRANSFROM DATA=======================================
2025-06-07 08:55:49,857 - INFO - Transform to 'dwh.dim_geolocation' - SUCCESS
2025-06-07 08:55:49,861 - INFO - Transform to 'dwh.dim_product_category' - SUCCESS
2025-06-07 08:55:49,881 - INFO - Transform to 'dwh.dim_sellers' - SUCCESS
2025-06-07 08:55:50,640 - INFO - Transform to 'dwh.dim_customers' - SUCCESS
2025-06-07 08:55:50,930 - INFO - Transform to 'dwh.dim_products' - SUCCESS
2025-06-07 08:55:50,937 - ERROR - Transform to All Dimensions and Fact Tables - FAILED
2025-06-07 08:55:50,938 - ERROR - Transform Tables - FAILED
2025-06-07 08:55:50,938 - ERROR - [pid 19900] Worker Worker(salt=9655868800, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) failed    Transform()
Traceback (most recent call last):
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedColumn: column dt.hours does not exist
LINE 16: ...der_approved_at, 'YYYY-MM-DD HH24:MI:SS'))::INT = dt.hours A...
                                                              ^
HINT:  Perhaps you meant to reference the column "dt.hour".


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\LENOVO THINKPAD\AppData\Local\Temp\ipykernel_19900\4240733592.py", line 134, in run
    session.execute(query)
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\orm\session.py", line 2362, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\orm\session.py", line 2256, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1418, in execute
    return meth(
           ^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\sql\elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedColumn) column dt.hours does not exist
LINE 16: ...der_approved_at, 'YYYY-MM-DD HH24:MI:SS'))::INT = dt.hours A...
                                                              ^
HINT:  Perhaps you meant to reference the column "dt.hour".

[SQL: INSERT INTO dwh.fact_orders_comprehensive (
    order_id, order_date_id, order_time_id,
    customer_sk, seller_sk, product_sk, product_category_sk,
    price, freight_value, quantity
)
SELECT
    oi.order_id, dd.full_date, dt.time_id,
    dc.customer_sk, ds.seller_sk, dp.product_sk, dpc.product_category_sk,
    oi.price, oi.freight_value, oi.quantity

FROM stg.order_items oi
JOIN stg.orders o ON oi.order_id = o.order_id

JOIN dwh.dim_date dd ON dd.full_date = DATE(o.order_approved_at)
JOIN dwh.dim_time dt ON
    EXTRACT(HOUR FROM TO_TIMESTAMP(o.order_approved_at, 'YYYY-MM-DD HH24:MI:SS'))::INT = dt.hours AND
    EXTRACT(MINUTE FROM TO_TIMESTAMP(o.order_approved_at, 'YYYY-MM-DD HH24:MI:SS'))::INT = dt.minutes AND
    EXTRACT(SECOND FROM TO_TIMESTAMP(o.order_approved_at, 'YYYY-MM-DD HH24:MI:SS'))::INT = dt.seconds

JOIN dwh.dim_customers dc ON dc.customer_id = o.customer_id AND dc.is_current = TRUE
JOIN dwh.dim_sellers ds ON ds.seller_id = oi.seller_id AND ds.is_current = TRUE
JOIN dwh.dim_products dp ON dp.product_id = oi.product_id AND dp.is_current = TRUE
JOIN dwh.dim_product_category dpc ON dpc.product_category_name = dp.product_category_name;]
(Background on this error at: https://sqlalche.me/e/20/f405)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 210, in run
    new_deps = self._run_get_new_deps()
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 138, in _run_get_new_deps
    task_gen = self.task.run()
               ^^^^^^^^^^^^^^^
  File "C:\Users\LENOVO THINKPAD\AppData\Local\Temp\ipykernel_19900\4240733592.py", line 193, in run
    raise Exception('Failed Transforming Tables')
Exception: Failed Transforming Tables
2025-06-07 08:55:50,943 - DEBUG - 1 running tasks, waiting for next task to finish
2025-06-07 08:55:50,947 - INFO - Informed scheduler that task   Transform__99914b932b   has status   FAILED
2025-06-07 08:55:50,948 - DEBUG - Asking scheduler for work...
2025-06-07 08:55:50,949 - DEBUG - Done
2025-06-07 08:55:50,949 - DEBUG - There are no more tasks to run at this time
2025-06-07 08:55:50,950 - DEBUG - There are 1 pending tasks possibly being run by other workers
2025-06-07 08:55:50,951 - DEBUG - There are 1 pending tasks unique to this worker
2025-06-07 08:55:50,951 - DEBUG - There are 1 pending tasks last scheduled by this worker
2025-06-07 08:55:50,952 - INFO - Worker Worker(salt=9655868800, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) was stopped. Shutting down Keep-Alive thread
2025-06-07 08:55:50,954 - INFO - 
===== Luigi Execution Summary =====

Scheduled 3 tasks of which:
* 2 complete ones were encountered:
    - 1 Extract()
    - 1 Load()
* 1 failed:
    - 1 Transform()

This progress looks :( because there were failed tasks

===== Luigi Execution Summary =====

2025-06-07 08:58:27,209 - INFO - logging already configured
2025-06-07 08:58:27,212 - DEBUG - Checking if Extract() is complete
2025-06-07 08:58:27,214 - INFO - Informed scheduler that task   Extract__99914b932b   has status   PENDING
2025-06-07 08:58:27,215 - INFO - Done scheduling tasks
2025-06-07 08:58:27,215 - INFO - Running Worker with 1 processes
2025-06-07 08:58:27,216 - DEBUG - Asking scheduler for work...
2025-06-07 08:58:27,216 - DEBUG - Pending tasks: 1
2025-06-07 08:58:27,217 - INFO - [pid 19900] Worker Worker(salt=3825671028, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) running   Extract()
2025-06-07 08:58:27,217 - INFO - ==================================STARTING EXTRACT DATA=======================================
2025-06-07 08:58:27,514 - INFO - EXTRACT 'public.geolocation' - SUCCESS.
2025-06-07 08:58:27,525 - INFO - EXTRACT 'public.product_category_name_translation' - SUCCESS.
2025-06-07 08:58:27,542 - INFO - EXTRACT 'public.sellers' - SUCCESS.
2025-06-07 08:58:28,202 - INFO - EXTRACT 'public.customers' - SUCCESS.
2025-06-07 08:58:28,455 - INFO - EXTRACT 'public.products' - SUCCESS.
2025-06-07 08:58:29,162 - INFO - EXTRACT 'public.orders' - SUCCESS.
2025-06-07 08:58:29,942 - INFO - EXTRACT 'public.order_items' - SUCCESS.
2025-06-07 08:58:30,624 - INFO - EXTRACT 'public.order_payments' - SUCCESS.
2025-06-07 08:58:31,299 - INFO - EXTRACT 'public.order_reviews' - SUCCESS.
2025-06-07 08:58:31,299 - INFO - Extract All Tables From Sources - SUCCESS
2025-06-07 08:58:31,301 - INFO - ==================================ENDING EXTRACT DATA=======================================
2025-06-07 08:58:31,313 - INFO - [pid 19900] Worker Worker(salt=3825671028, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) done      Extract()
2025-06-07 08:58:31,315 - DEBUG - 1 running tasks, waiting for next task to finish
2025-06-07 08:58:31,317 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2025-06-07 08:58:31,318 - DEBUG - Asking scheduler for work...
2025-06-07 08:58:31,318 - DEBUG - Done
2025-06-07 08:58:31,319 - DEBUG - There are no more tasks to run at this time
2025-06-07 08:58:31,319 - INFO - Worker Worker(salt=3825671028, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) was stopped. Shutting down Keep-Alive thread
2025-06-07 08:58:31,322 - INFO - 
===== Luigi Execution Summary =====

Scheduled 1 tasks of which:
* 1 ran successfully:
    - 1 Extract()

This progress looks :) because there were no failed tasks or missing dependencies

===== Luigi Execution Summary =====

2025-06-07 08:58:40,432 - INFO - logging already configured
2025-06-07 08:58:40,434 - DEBUG - Checking if Extract() is complete
2025-06-07 08:58:40,436 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2025-06-07 08:58:40,437 - DEBUG - Checking if Load() is complete
2025-06-07 08:58:40,438 - DEBUG - Checking if Extract() is complete
2025-06-07 08:58:40,440 - INFO - Informed scheduler that task   Load__99914b932b   has status   PENDING
2025-06-07 08:58:40,441 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2025-06-07 08:58:40,441 - INFO - Done scheduling tasks
2025-06-07 08:58:40,442 - INFO - Running Worker with 1 processes
2025-06-07 08:58:40,444 - DEBUG - Asking scheduler for work...
2025-06-07 08:58:40,444 - DEBUG - Pending tasks: 1
2025-06-07 08:58:40,445 - INFO - [pid 19900] Worker Worker(salt=4012975089, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) running   Load()
2025-06-07 08:58:40,448 - INFO - Read Load Query - SUCCESS
2025-06-07 08:58:41,675 - INFO - Read Extracted Data - SUCCESS
2025-06-07 08:58:41,676 - INFO - Connect to olist-dwh - SUCCESS
2025-06-07 08:58:41,787 - INFO - Truncate `public` Schema in olist-dwh - SUCCESS
2025-06-07 08:58:41,787 - INFO - ==================================STARTING LOAD DATA=======================================
2025-06-07 08:59:10,140 - INFO - LOAD All Tables To olist-dwh-public - SUCCESS
2025-06-07 08:59:14,160 - INFO - LOAD All Tables To DWH-Staging - SUCCESS
2025-06-07 08:59:14,162 - INFO - ==================================ENDING LOAD DATA=======================================
2025-06-07 08:59:14,196 - INFO - [pid 19900] Worker Worker(salt=4012975089, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) done      Load()
2025-06-07 08:59:14,198 - DEBUG - 1 running tasks, waiting for next task to finish
2025-06-07 08:59:14,200 - INFO - Informed scheduler that task   Load__99914b932b   has status   DONE
2025-06-07 08:59:14,201 - DEBUG - Asking scheduler for work...
2025-06-07 08:59:14,201 - DEBUG - Done
2025-06-07 08:59:14,202 - DEBUG - There are no more tasks to run at this time
2025-06-07 08:59:14,203 - INFO - Worker Worker(salt=4012975089, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) was stopped. Shutting down Keep-Alive thread
2025-06-07 08:59:14,207 - INFO - 
===== Luigi Execution Summary =====

Scheduled 2 tasks of which:
* 1 complete ones were encountered:
    - 1 Extract()
* 1 ran successfully:
    - 1 Load()

This progress looks :) because there were no failed tasks or missing dependencies

===== Luigi Execution Summary =====

2025-06-07 08:59:21,668 - INFO - logging already configured
2025-06-07 08:59:21,670 - DEBUG - Checking if Extract() is complete
2025-06-07 08:59:21,672 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2025-06-07 08:59:21,673 - DEBUG - Checking if Load() is complete
2025-06-07 08:59:21,675 - INFO - Informed scheduler that task   Load__99914b932b   has status   DONE
2025-06-07 08:59:21,676 - DEBUG - Checking if Transform() is complete
2025-06-07 08:59:21,678 - DEBUG - Checking if Load() is complete
2025-06-07 08:59:21,680 - INFO - Informed scheduler that task   Transform__99914b932b   has status   PENDING
2025-06-07 08:59:21,681 - INFO - Informed scheduler that task   Load__99914b932b   has status   DONE
2025-06-07 08:59:21,681 - INFO - Done scheduling tasks
2025-06-07 08:59:21,683 - INFO - Running Worker with 1 processes
2025-06-07 08:59:21,683 - DEBUG - Asking scheduler for work...
2025-06-07 08:59:21,684 - DEBUG - Pending tasks: 1
2025-06-07 08:59:21,685 - INFO - [pid 19900] Worker Worker(salt=6687769782, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) running   Transform()
2025-06-07 08:59:21,687 - INFO - Connect to DWH - SUCCESS
2025-06-07 08:59:21,709 - INFO - Read Transform Query - SUCCESS
2025-06-07 08:59:21,709 - INFO - ==================================STARTING TRANSFROM DATA=======================================
2025-06-07 08:59:21,886 - INFO - Transform to 'dwh.dim_geolocation' - SUCCESS
2025-06-07 08:59:21,892 - INFO - Transform to 'dwh.dim_product_category' - SUCCESS
2025-06-07 08:59:21,913 - INFO - Transform to 'dwh.dim_sellers' - SUCCESS
2025-06-07 08:59:22,662 - INFO - Transform to 'dwh.dim_customers' - SUCCESS
2025-06-07 08:59:22,933 - INFO - Transform to 'dwh.dim_products' - SUCCESS
2025-06-07 08:59:22,938 - ERROR - Transform to All Dimensions and Fact Tables - FAILED
2025-06-07 08:59:22,942 - ERROR - Transform Tables - FAILED
2025-06-07 08:59:22,942 - ERROR - [pid 19900] Worker Worker(salt=6687769782, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) failed    Transform()
Traceback (most recent call last):
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedColumn: column oi.quantity does not exist
LINE 9:     oi.price, oi.freight_value, oi.quantity
                                        ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\LENOVO THINKPAD\AppData\Local\Temp\ipykernel_19900\4240733592.py", line 134, in run
    session.execute(query)
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\orm\session.py", line 2362, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\orm\session.py", line 2256, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1418, in execute
    return meth(
           ^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\sql\elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedColumn) column oi.quantity does not exist
LINE 9:     oi.price, oi.freight_value, oi.quantity
                                        ^

[SQL: INSERT INTO dwh.fact_orders_comprehensive (
    order_id, order_date_id, order_time_id,
    customer_sk, seller_sk, product_sk, product_category_sk,
    price, freight_value, quantity
)
SELECT
    oi.order_id, dd.full_date, dt.time_id,
    dc.customer_sk, ds.seller_sk, dp.product_sk, dpc.product_category_sk,
    oi.price, oi.freight_value, oi.quantity

FROM stg.order_items oi
JOIN stg.orders o ON oi.order_id = o.order_id

JOIN dwh.dim_date dd ON dd.full_date = DATE(o.order_approved_at)
JOIN dwh.dim_time dt ON
    EXTRACT(HOUR FROM TO_TIMESTAMP(o.order_approved_at, 'YYYY-MM-DD HH24:MI:SS')) = dt.hour AND
    EXTRACT(MINUTE FROM TO_TIMESTAMP(o.order_approved_at, 'YYYY-MM-DD HH24:MI:SS')) = dt.minute AND
    EXTRACT(SECOND FROM TO_TIMESTAMP(o.order_approved_at, 'YYYY-MM-DD HH24:MI:SS')) = dt.second

JOIN dwh.dim_customers dc ON dc.customer_id = o.customer_id AND dc.is_current = TRUE
JOIN dwh.dim_sellers ds ON ds.seller_id = oi.seller_id AND ds.is_current = TRUE
JOIN dwh.dim_products dp ON dp.product_id = oi.product_id AND dp.is_current = TRUE
JOIN dwh.dim_product_category dpc ON dpc.product_category_name = dp.product_category_name;]
(Background on this error at: https://sqlalche.me/e/20/f405)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 210, in run
    new_deps = self._run_get_new_deps()
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 138, in _run_get_new_deps
    task_gen = self.task.run()
               ^^^^^^^^^^^^^^^
  File "C:\Users\LENOVO THINKPAD\AppData\Local\Temp\ipykernel_19900\4240733592.py", line 193, in run
    raise Exception('Failed Transforming Tables')
Exception: Failed Transforming Tables
2025-06-07 08:59:22,946 - DEBUG - 1 running tasks, waiting for next task to finish
2025-06-07 08:59:22,950 - INFO - Informed scheduler that task   Transform__99914b932b   has status   FAILED
2025-06-07 08:59:22,951 - DEBUG - Asking scheduler for work...
2025-06-07 08:59:22,951 - DEBUG - Done
2025-06-07 08:59:22,952 - DEBUG - There are no more tasks to run at this time
2025-06-07 08:59:22,952 - DEBUG - There are 1 pending tasks possibly being run by other workers
2025-06-07 08:59:22,954 - DEBUG - There are 1 pending tasks unique to this worker
2025-06-07 08:59:22,955 - DEBUG - There are 1 pending tasks last scheduled by this worker
2025-06-07 08:59:22,955 - INFO - Worker Worker(salt=6687769782, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) was stopped. Shutting down Keep-Alive thread
2025-06-07 08:59:22,967 - INFO - 
===== Luigi Execution Summary =====

Scheduled 3 tasks of which:
* 2 complete ones were encountered:
    - 1 Extract()
    - 1 Load()
* 1 failed:
    - 1 Transform()

This progress looks :( because there were failed tasks

===== Luigi Execution Summary =====

2025-06-07 09:02:46,889 - INFO - logging already configured
2025-06-07 09:02:46,891 - DEBUG - Checking if Extract() is complete
2025-06-07 09:02:46,893 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2025-06-07 09:02:46,894 - INFO - Done scheduling tasks
2025-06-07 09:02:46,895 - INFO - Running Worker with 1 processes
2025-06-07 09:02:46,896 - DEBUG - Asking scheduler for work...
2025-06-07 09:02:46,897 - DEBUG - Done
2025-06-07 09:02:46,897 - DEBUG - There are no more tasks to run at this time
2025-06-07 09:02:46,898 - INFO - Worker Worker(salt=2773744932, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) was stopped. Shutting down Keep-Alive thread
2025-06-07 09:02:46,902 - INFO - 
===== Luigi Execution Summary =====

Scheduled 1 tasks of which:
* 1 complete ones were encountered:
    - 1 Extract()

Did not run any tasks
This progress looks :) because there were no failed tasks or missing dependencies

===== Luigi Execution Summary =====

2025-06-07 09:02:51,244 - INFO - logging already configured
2025-06-07 09:02:51,246 - DEBUG - Checking if Extract() is complete
2025-06-07 09:02:51,248 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2025-06-07 09:02:51,249 - DEBUG - Checking if Load() is complete
2025-06-07 09:02:51,250 - INFO - Informed scheduler that task   Load__99914b932b   has status   DONE
2025-06-07 09:02:51,251 - INFO - Done scheduling tasks
2025-06-07 09:02:51,252 - INFO - Running Worker with 1 processes
2025-06-07 09:02:51,253 - DEBUG - Asking scheduler for work...
2025-06-07 09:02:51,254 - DEBUG - Done
2025-06-07 09:02:51,254 - DEBUG - There are no more tasks to run at this time
2025-06-07 09:02:51,255 - INFO - Worker Worker(salt=7127933152, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) was stopped. Shutting down Keep-Alive thread
2025-06-07 09:02:51,258 - INFO - 
===== Luigi Execution Summary =====

Scheduled 2 tasks of which:
* 2 complete ones were encountered:
    - 1 Extract()
    - 1 Load()

Did not run any tasks
This progress looks :) because there were no failed tasks or missing dependencies

===== Luigi Execution Summary =====

2025-06-07 09:02:56,143 - INFO - logging already configured
2025-06-07 09:02:56,145 - DEBUG - Checking if Extract() is complete
2025-06-07 09:02:56,147 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2025-06-07 09:02:56,148 - DEBUG - Checking if Load() is complete
2025-06-07 09:02:56,150 - INFO - Informed scheduler that task   Load__99914b932b   has status   DONE
2025-06-07 09:02:56,151 - DEBUG - Checking if Transform() is complete
2025-06-07 09:02:56,152 - INFO - Informed scheduler that task   Transform__99914b932b   has status   DONE
2025-06-07 09:02:56,152 - INFO - Done scheduling tasks
2025-06-07 09:02:56,153 - INFO - Running Worker with 1 processes
2025-06-07 09:02:56,153 - DEBUG - Asking scheduler for work...
2025-06-07 09:02:56,154 - DEBUG - Done
2025-06-07 09:02:56,154 - DEBUG - There are no more tasks to run at this time
2025-06-07 09:02:56,156 - INFO - Worker Worker(salt=5182643017, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) was stopped. Shutting down Keep-Alive thread
2025-06-07 09:02:56,168 - INFO - 
===== Luigi Execution Summary =====

Scheduled 3 tasks of which:
* 3 complete ones were encountered:
    - 1 Extract()
    - 1 Load()
    - 1 Transform()

Did not run any tasks
This progress looks :) because there were no failed tasks or missing dependencies

===== Luigi Execution Summary =====

2025-06-07 09:03:08,347 - INFO - logging already configured
2025-06-07 09:03:08,350 - DEBUG - Checking if Extract() is complete
2025-06-07 09:03:08,351 - INFO - Informed scheduler that task   Extract__99914b932b   has status   PENDING
2025-06-07 09:03:08,352 - INFO - Done scheduling tasks
2025-06-07 09:03:08,352 - INFO - Running Worker with 1 processes
2025-06-07 09:03:08,352 - DEBUG - Asking scheduler for work...
2025-06-07 09:03:08,354 - DEBUG - Pending tasks: 1
2025-06-07 09:03:08,355 - INFO - [pid 19900] Worker Worker(salt=8216729205, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) running   Extract()
2025-06-07 09:03:08,355 - INFO - ==================================STARTING EXTRACT DATA=======================================
2025-06-07 09:03:08,642 - INFO - EXTRACT 'public.geolocation' - SUCCESS.
2025-06-07 09:03:08,660 - INFO - EXTRACT 'public.product_category_name_translation' - SUCCESS.
2025-06-07 09:03:08,674 - INFO - EXTRACT 'public.sellers' - SUCCESS.
2025-06-07 09:03:09,296 - INFO - EXTRACT 'public.customers' - SUCCESS.
2025-06-07 09:03:09,561 - INFO - EXTRACT 'public.products' - SUCCESS.
2025-06-07 09:03:10,266 - INFO - EXTRACT 'public.orders' - SUCCESS.
2025-06-07 09:03:11,067 - INFO - EXTRACT 'public.order_items' - SUCCESS.
2025-06-07 09:03:11,649 - INFO - EXTRACT 'public.order_payments' - SUCCESS.
2025-06-07 09:03:12,437 - INFO - EXTRACT 'public.order_reviews' - SUCCESS.
2025-06-07 09:03:12,438 - INFO - Extract All Tables From Sources - SUCCESS
2025-06-07 09:03:12,439 - INFO - ==================================ENDING EXTRACT DATA=======================================
2025-06-07 09:03:12,452 - INFO - [pid 19900] Worker Worker(salt=8216729205, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) done      Extract()
2025-06-07 09:03:12,454 - DEBUG - 1 running tasks, waiting for next task to finish
2025-06-07 09:03:12,455 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2025-06-07 09:03:12,456 - DEBUG - Asking scheduler for work...
2025-06-07 09:03:12,457 - DEBUG - Done
2025-06-07 09:03:12,457 - DEBUG - There are no more tasks to run at this time
2025-06-07 09:03:12,458 - INFO - Worker Worker(salt=8216729205, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) was stopped. Shutting down Keep-Alive thread
2025-06-07 09:03:12,460 - INFO - 
===== Luigi Execution Summary =====

Scheduled 1 tasks of which:
* 1 ran successfully:
    - 1 Extract()

This progress looks :) because there were no failed tasks or missing dependencies

===== Luigi Execution Summary =====

2025-06-07 09:03:18,485 - INFO - logging already configured
2025-06-07 09:03:18,488 - DEBUG - Checking if Extract() is complete
2025-06-07 09:03:18,490 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2025-06-07 09:03:18,491 - DEBUG - Checking if Load() is complete
2025-06-07 09:03:18,492 - DEBUG - Checking if Extract() is complete
2025-06-07 09:03:18,493 - INFO - Informed scheduler that task   Load__99914b932b   has status   PENDING
2025-06-07 09:03:18,494 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2025-06-07 09:03:18,495 - INFO - Done scheduling tasks
2025-06-07 09:03:18,495 - INFO - Running Worker with 1 processes
2025-06-07 09:03:18,496 - DEBUG - Asking scheduler for work...
2025-06-07 09:03:18,497 - DEBUG - Pending tasks: 1
2025-06-07 09:03:18,498 - INFO - [pid 19900] Worker Worker(salt=3078190936, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) running   Load()
2025-06-07 09:03:18,500 - INFO - Read Load Query - SUCCESS
2025-06-07 09:03:19,644 - INFO - Read Extracted Data - SUCCESS
2025-06-07 09:03:19,645 - INFO - Connect to olist-dwh - SUCCESS
2025-06-07 09:03:19,770 - INFO - Truncate `public` Schema in olist-dwh - SUCCESS
2025-06-07 09:03:19,770 - INFO - ==================================STARTING LOAD DATA=======================================
2025-06-07 09:03:49,429 - INFO - LOAD All Tables To olist-dwh-public - SUCCESS
2025-06-07 09:03:53,259 - INFO - LOAD All Tables To DWH-Staging - SUCCESS
2025-06-07 09:03:53,259 - INFO - ==================================ENDING LOAD DATA=======================================
2025-06-07 09:03:53,292 - INFO - [pid 19900] Worker Worker(salt=3078190936, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) done      Load()
2025-06-07 09:03:53,296 - DEBUG - 1 running tasks, waiting for next task to finish
2025-06-07 09:03:53,296 - INFO - Informed scheduler that task   Load__99914b932b   has status   DONE
2025-06-07 09:03:53,297 - DEBUG - Asking scheduler for work...
2025-06-07 09:03:53,297 - DEBUG - Done
2025-06-07 09:03:53,297 - DEBUG - There are no more tasks to run at this time
2025-06-07 09:03:53,299 - INFO - Worker Worker(salt=3078190936, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) was stopped. Shutting down Keep-Alive thread
2025-06-07 09:03:53,300 - INFO - 
===== Luigi Execution Summary =====

Scheduled 2 tasks of which:
* 1 complete ones were encountered:
    - 1 Extract()
* 1 ran successfully:
    - 1 Load()

This progress looks :) because there were no failed tasks or missing dependencies

===== Luigi Execution Summary =====

2025-06-07 09:03:58,756 - INFO - logging already configured
2025-06-07 09:03:58,758 - DEBUG - Checking if Extract() is complete
2025-06-07 09:03:58,761 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2025-06-07 09:03:58,761 - DEBUG - Checking if Load() is complete
2025-06-07 09:03:58,762 - INFO - Informed scheduler that task   Load__99914b932b   has status   DONE
2025-06-07 09:03:58,763 - DEBUG - Checking if Transform() is complete
2025-06-07 09:03:58,764 - DEBUG - Checking if Load() is complete
2025-06-07 09:03:58,765 - INFO - Informed scheduler that task   Transform__99914b932b   has status   PENDING
2025-06-07 09:03:58,766 - INFO - Informed scheduler that task   Load__99914b932b   has status   DONE
2025-06-07 09:03:58,767 - INFO - Done scheduling tasks
2025-06-07 09:03:58,767 - INFO - Running Worker with 1 processes
2025-06-07 09:03:58,768 - DEBUG - Asking scheduler for work...
2025-06-07 09:03:58,769 - DEBUG - Pending tasks: 1
2025-06-07 09:03:58,769 - INFO - [pid 19900] Worker Worker(salt=7618532328, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) running   Transform()
2025-06-07 09:03:58,772 - INFO - Connect to DWH - SUCCESS
2025-06-07 09:03:58,790 - INFO - Read Transform Query - SUCCESS
2025-06-07 09:03:58,790 - INFO - ==================================STARTING TRANSFROM DATA=======================================
2025-06-07 09:03:58,956 - INFO - Transform to 'dwh.dim_geolocation' - SUCCESS
2025-06-07 09:03:58,959 - INFO - Transform to 'dwh.dim_product_category' - SUCCESS
2025-06-07 09:03:58,980 - INFO - Transform to 'dwh.dim_sellers' - SUCCESS
2025-06-07 09:03:59,663 - INFO - Transform to 'dwh.dim_customers' - SUCCESS
2025-06-07 09:03:59,907 - INFO - Transform to 'dwh.dim_products' - SUCCESS
2025-06-07 09:03:59,910 - ERROR - Transform to All Dimensions and Fact Tables - FAILED
2025-06-07 09:03:59,912 - ERROR - Transform Tables - FAILED
2025-06-07 09:03:59,913 - ERROR - [pid 19900] Worker Worker(salt=7618532328, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) failed    Transform()
Traceback (most recent call last):
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedColumn: column "quantity" of relation "fact_orders_comprehensive" does not exist
LINE 4:     price, freight_value, quantity
                                  ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\LENOVO THINKPAD\AppData\Local\Temp\ipykernel_19900\4240733592.py", line 134, in run
    session.execute(query)
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\orm\session.py", line 2362, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\orm\session.py", line 2256, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1418, in execute
    return meth(
           ^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\sql\elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedColumn) column "quantity" of relation "fact_orders_comprehensive" does not exist
LINE 4:     price, freight_value, quantity
                                  ^

[SQL: INSERT INTO dwh.fact_orders_comprehensive (
    order_id, order_date_id, order_time_id,
    customer_sk, seller_sk, product_sk, product_category_sk,
    price, freight_value, quantity
)
SELECT
    oi.order_id, dd.full_date, dt.time_id,
    dc.customer_sk, ds.seller_sk, dp.product_sk, dpc.product_category_sk,
    oi.price, oi.freight_value

FROM stg.order_items oi
JOIN stg.orders o ON oi.order_id = o.order_id

JOIN dwh.dim_date dd ON dd.full_date = DATE(o.order_approved_at)
JOIN dwh.dim_time dt ON
    EXTRACT(HOUR FROM TO_TIMESTAMP(o.order_approved_at, 'YYYY-MM-DD HH24:MI:SS')) = dt.hour AND
    EXTRACT(MINUTE FROM TO_TIMESTAMP(o.order_approved_at, 'YYYY-MM-DD HH24:MI:SS')) = dt.minute AND
    EXTRACT(SECOND FROM TO_TIMESTAMP(o.order_approved_at, 'YYYY-MM-DD HH24:MI:SS')) = dt.second

JOIN dwh.dim_customers dc ON dc.customer_id = o.customer_id AND dc.is_current = TRUE
JOIN dwh.dim_sellers ds ON ds.seller_id = oi.seller_id AND ds.is_current = TRUE
JOIN dwh.dim_products dp ON dp.product_id = oi.product_id AND dp.is_current = TRUE
JOIN dwh.dim_product_category dpc ON dpc.product_category_name = dp.product_category_name;]
(Background on this error at: https://sqlalche.me/e/20/f405)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 210, in run
    new_deps = self._run_get_new_deps()
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 138, in _run_get_new_deps
    task_gen = self.task.run()
               ^^^^^^^^^^^^^^^
  File "C:\Users\LENOVO THINKPAD\AppData\Local\Temp\ipykernel_19900\4240733592.py", line 193, in run
    raise Exception('Failed Transforming Tables')
Exception: Failed Transforming Tables
2025-06-07 09:03:59,917 - DEBUG - 1 running tasks, waiting for next task to finish
2025-06-07 09:03:59,921 - INFO - Informed scheduler that task   Transform__99914b932b   has status   FAILED
2025-06-07 09:03:59,921 - DEBUG - Asking scheduler for work...
2025-06-07 09:03:59,922 - DEBUG - Done
2025-06-07 09:03:59,923 - DEBUG - There are no more tasks to run at this time
2025-06-07 09:03:59,924 - DEBUG - There are 1 pending tasks possibly being run by other workers
2025-06-07 09:03:59,924 - DEBUG - There are 1 pending tasks unique to this worker
2025-06-07 09:03:59,925 - DEBUG - There are 1 pending tasks last scheduled by this worker
2025-06-07 09:03:59,926 - INFO - Worker Worker(salt=7618532328, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) was stopped. Shutting down Keep-Alive thread
2025-06-07 09:03:59,947 - INFO - 
===== Luigi Execution Summary =====

Scheduled 3 tasks of which:
* 2 complete ones were encountered:
    - 1 Extract()
    - 1 Load()
* 1 failed:
    - 1 Transform()

This progress looks :( because there were failed tasks

===== Luigi Execution Summary =====

2025-06-07 09:04:20,017 - INFO - logging already configured
2025-06-07 09:04:20,018 - DEBUG - Checking if Extract() is complete
2025-06-07 09:04:20,020 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2025-06-07 09:04:20,021 - DEBUG - Checking if Load() is complete
2025-06-07 09:04:20,023 - INFO - Informed scheduler that task   Load__99914b932b   has status   DONE
2025-06-07 09:04:20,024 - DEBUG - Checking if Transform() is complete
2025-06-07 09:04:20,025 - INFO - Informed scheduler that task   Transform__99914b932b   has status   DONE
2025-06-07 09:04:20,026 - INFO - Done scheduling tasks
2025-06-07 09:04:20,026 - INFO - Running Worker with 1 processes
2025-06-07 09:04:20,027 - DEBUG - Asking scheduler for work...
2025-06-07 09:04:20,028 - DEBUG - Done
2025-06-07 09:04:20,028 - DEBUG - There are no more tasks to run at this time
2025-06-07 09:04:20,030 - INFO - Worker Worker(salt=618343371, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) was stopped. Shutting down Keep-Alive thread
2025-06-07 09:04:20,033 - INFO - 
===== Luigi Execution Summary =====

Scheduled 3 tasks of which:
* 3 complete ones were encountered:
    - 1 Extract()
    - 1 Load()
    - 1 Transform()

Did not run any tasks
This progress looks :) because there were no failed tasks or missing dependencies

===== Luigi Execution Summary =====

2025-06-07 09:04:20,932 - INFO - logging already configured
2025-06-07 09:04:20,934 - DEBUG - Checking if Extract() is complete
2025-06-07 09:04:20,936 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2025-06-07 09:04:20,937 - DEBUG - Checking if Load() is complete
2025-06-07 09:04:20,938 - INFO - Informed scheduler that task   Load__99914b932b   has status   DONE
2025-06-07 09:04:20,939 - DEBUG - Checking if Transform() is complete
2025-06-07 09:04:20,940 - INFO - Informed scheduler that task   Transform__99914b932b   has status   DONE
2025-06-07 09:04:20,941 - INFO - Done scheduling tasks
2025-06-07 09:04:20,941 - INFO - Running Worker with 1 processes
2025-06-07 09:04:20,942 - DEBUG - Asking scheduler for work...
2025-06-07 09:04:20,942 - DEBUG - Done
2025-06-07 09:04:20,943 - DEBUG - There are no more tasks to run at this time
2025-06-07 09:04:20,944 - INFO - Worker Worker(salt=7279378777, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) was stopped. Shutting down Keep-Alive thread
2025-06-07 09:04:20,951 - INFO - 
===== Luigi Execution Summary =====

Scheduled 3 tasks of which:
* 3 complete ones were encountered:
    - 1 Extract()
    - 1 Load()
    - 1 Transform()

Did not run any tasks
This progress looks :) because there were no failed tasks or missing dependencies

===== Luigi Execution Summary =====

2025-06-07 09:04:21,222 - INFO - logging already configured
2025-06-07 09:04:21,223 - DEBUG - Checking if Extract() is complete
2025-06-07 09:04:21,226 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2025-06-07 09:04:21,227 - DEBUG - Checking if Load() is complete
2025-06-07 09:04:21,228 - INFO - Informed scheduler that task   Load__99914b932b   has status   DONE
2025-06-07 09:04:21,230 - DEBUG - Checking if Transform() is complete
2025-06-07 09:04:21,231 - INFO - Informed scheduler that task   Transform__99914b932b   has status   DONE
2025-06-07 09:04:21,231 - INFO - Done scheduling tasks
2025-06-07 09:04:21,232 - INFO - Running Worker with 1 processes
2025-06-07 09:04:21,233 - DEBUG - Asking scheduler for work...
2025-06-07 09:04:21,233 - DEBUG - Done
2025-06-07 09:04:21,233 - DEBUG - There are no more tasks to run at this time
2025-06-07 09:04:21,235 - INFO - Worker Worker(salt=4510416938, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) was stopped. Shutting down Keep-Alive thread
2025-06-07 09:04:21,238 - INFO - 
===== Luigi Execution Summary =====

Scheduled 3 tasks of which:
* 3 complete ones were encountered:
    - 1 Extract()
    - 1 Load()
    - 1 Transform()

Did not run any tasks
This progress looks :) because there were no failed tasks or missing dependencies

===== Luigi Execution Summary =====

2025-06-07 09:04:21,388 - INFO - logging already configured
2025-06-07 09:04:21,390 - DEBUG - Checking if Extract() is complete
2025-06-07 09:04:21,392 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2025-06-07 09:04:21,394 - DEBUG - Checking if Load() is complete
2025-06-07 09:04:21,395 - INFO - Informed scheduler that task   Load__99914b932b   has status   DONE
2025-06-07 09:04:21,396 - DEBUG - Checking if Transform() is complete
2025-06-07 09:04:21,397 - INFO - Informed scheduler that task   Transform__99914b932b   has status   DONE
2025-06-07 09:04:21,398 - INFO - Done scheduling tasks
2025-06-07 09:04:21,399 - INFO - Running Worker with 1 processes
2025-06-07 09:04:21,399 - DEBUG - Asking scheduler for work...
2025-06-07 09:04:21,400 - DEBUG - Done
2025-06-07 09:04:21,401 - DEBUG - There are no more tasks to run at this time
2025-06-07 09:04:21,402 - INFO - Worker Worker(salt=3582856991, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) was stopped. Shutting down Keep-Alive thread
2025-06-07 09:04:21,405 - INFO - 
===== Luigi Execution Summary =====

Scheduled 3 tasks of which:
* 3 complete ones were encountered:
    - 1 Extract()
    - 1 Load()
    - 1 Transform()

Did not run any tasks
This progress looks :) because there were no failed tasks or missing dependencies

===== Luigi Execution Summary =====

2025-06-07 09:04:56,454 - INFO - logging already configured
2025-06-07 09:04:56,455 - DEBUG - Checking if Extract() is complete
2025-06-07 09:04:56,457 - INFO - Informed scheduler that task   Extract__99914b932b   has status   PENDING
2025-06-07 09:04:56,457 - DEBUG - Checking if Load() is complete
2025-06-07 09:04:56,459 - DEBUG - Checking if Extract() is complete
2025-06-07 09:04:56,460 - INFO - Informed scheduler that task   Load__99914b932b   has status   PENDING
2025-06-07 09:04:56,461 - INFO - Informed scheduler that task   Extract__99914b932b   has status   PENDING
2025-06-07 09:04:56,461 - INFO - Done scheduling tasks
2025-06-07 09:04:56,463 - INFO - Running Worker with 1 processes
2025-06-07 09:04:56,463 - DEBUG - Asking scheduler for work...
2025-06-07 09:04:56,464 - DEBUG - Pending tasks: 2
2025-06-07 09:04:56,464 - INFO - [pid 19900] Worker Worker(salt=4978689657, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) running   Extract()
2025-06-07 09:04:56,465 - ERROR - [pid 19900] Worker Worker(salt=4978689657, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) failed    Extract()
Traceback (most recent call last):
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 210, in run
    new_deps = self._run_get_new_deps()
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 138, in _run_get_new_deps
    task_gen = self.task.run()
               ^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\Documents\Github\Pacmann---Data-Storage_-Warehouse--Mart---Lake\mentoring 2\olist-dwh-project\pipeline\extract.py", line 43, in run
    os.makedirs(os.path.dirname(self.output().path), exist_ok=True)
                                ^^^^^^^^^^^^^^^^^^
AttributeError: 'list' object has no attribute 'path'
2025-06-07 09:04:56,467 - DEBUG - 1 running tasks, waiting for next task to finish
2025-06-07 09:04:56,472 - INFO - Informed scheduler that task   Extract__99914b932b   has status   FAILED
2025-06-07 09:04:56,472 - DEBUG - Asking scheduler for work...
2025-06-07 09:04:56,473 - DEBUG - Done
2025-06-07 09:04:56,473 - DEBUG - There are no more tasks to run at this time
2025-06-07 09:04:56,474 - DEBUG - There are 2 pending tasks possibly being run by other workers
2025-06-07 09:04:56,476 - DEBUG - There are 2 pending tasks unique to this worker
2025-06-07 09:04:56,476 - DEBUG - There are 2 pending tasks last scheduled by this worker
2025-06-07 09:04:56,477 - INFO - Worker Worker(salt=4978689657, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) was stopped. Shutting down Keep-Alive thread
2025-06-07 09:04:56,481 - INFO - 
===== Luigi Execution Summary =====

Scheduled 2 tasks of which:
* 1 failed:
    - 1 Extract()
* 1 were left pending, among these:
    * 1 had failed dependencies:
        - 1 Load()

This progress looks :( because there were failed tasks

===== Luigi Execution Summary =====

2025-06-07 09:05:01,890 - INFO - logging already configured
2025-06-07 09:05:01,892 - DEBUG - Checking if Extract() is complete
2025-06-07 09:05:01,895 - INFO - Informed scheduler that task   Extract__99914b932b   has status   PENDING
2025-06-07 09:05:01,896 - INFO - Done scheduling tasks
2025-06-07 09:05:01,897 - INFO - Running Worker with 1 processes
2025-06-07 09:05:01,898 - DEBUG - Asking scheduler for work...
2025-06-07 09:05:01,899 - DEBUG - Pending tasks: 1
2025-06-07 09:05:01,900 - INFO - [pid 19900] Worker Worker(salt=9130637051, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) running   Extract()
2025-06-07 09:05:01,903 - INFO - ==================================STARTING EXTRACT DATA=======================================
2025-06-07 09:05:02,102 - INFO - EXTRACT 'public.geolocation' - SUCCESS.
2025-06-07 09:05:02,108 - INFO - EXTRACT 'public.product_category_name_translation' - SUCCESS.
2025-06-07 09:05:02,114 - INFO - EXTRACT 'public.sellers' - SUCCESS.
2025-06-07 09:05:02,764 - INFO - EXTRACT 'public.customers' - SUCCESS.
2025-06-07 09:05:03,035 - INFO - EXTRACT 'public.products' - SUCCESS.
2025-06-07 09:05:03,764 - INFO - EXTRACT 'public.orders' - SUCCESS.
2025-06-07 09:05:04,571 - INFO - EXTRACT 'public.order_items' - SUCCESS.
2025-06-07 09:05:05,171 - INFO - EXTRACT 'public.order_payments' - SUCCESS.
2025-06-07 09:05:05,821 - INFO - EXTRACT 'public.order_reviews' - SUCCESS.
2025-06-07 09:05:05,821 - INFO - Extract All Tables From Sources - SUCCESS
2025-06-07 09:05:05,823 - INFO - ==================================ENDING EXTRACT DATA=======================================
2025-06-07 09:05:05,835 - INFO - [pid 19900] Worker Worker(salt=9130637051, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) done      Extract()
2025-06-07 09:05:05,837 - DEBUG - 1 running tasks, waiting for next task to finish
2025-06-07 09:05:05,838 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2025-06-07 09:05:05,838 - DEBUG - Asking scheduler for work...
2025-06-07 09:05:05,839 - DEBUG - Done
2025-06-07 09:05:05,840 - DEBUG - There are no more tasks to run at this time
2025-06-07 09:05:05,840 - INFO - Worker Worker(salt=9130637051, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) was stopped. Shutting down Keep-Alive thread
2025-06-07 09:05:05,843 - INFO - 
===== Luigi Execution Summary =====

Scheduled 1 tasks of which:
* 1 ran successfully:
    - 1 Extract()

This progress looks :) because there were no failed tasks or missing dependencies

===== Luigi Execution Summary =====

2025-06-07 09:05:13,307 - INFO - logging already configured
2025-06-07 09:05:13,309 - DEBUG - Checking if Extract() is complete
2025-06-07 09:05:13,311 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2025-06-07 09:05:13,311 - DEBUG - Checking if Load() is complete
2025-06-07 09:05:13,314 - DEBUG - Checking if Extract() is complete
2025-06-07 09:05:13,315 - INFO - Informed scheduler that task   Load__99914b932b   has status   PENDING
2025-06-07 09:05:13,315 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2025-06-07 09:05:13,316 - INFO - Done scheduling tasks
2025-06-07 09:05:13,317 - INFO - Running Worker with 1 processes
2025-06-07 09:05:13,318 - DEBUG - Asking scheduler for work...
2025-06-07 09:05:13,318 - DEBUG - Pending tasks: 1
2025-06-07 09:05:13,319 - INFO - [pid 19900] Worker Worker(salt=5166618936, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) running   Load()
2025-06-07 09:05:13,322 - INFO - Read Load Query - SUCCESS
2025-06-07 09:05:14,466 - INFO - Read Extracted Data - SUCCESS
2025-06-07 09:05:14,467 - INFO - Connect to olist-dwh - SUCCESS
2025-06-07 09:05:14,596 - INFO - Truncate `public` Schema in olist-dwh - SUCCESS
2025-06-07 09:05:14,596 - INFO - ==================================STARTING LOAD DATA=======================================
2025-06-07 09:05:42,289 - INFO - LOAD All Tables To olist-dwh-public - SUCCESS
2025-06-07 09:05:46,285 - INFO - LOAD All Tables To DWH-Staging - SUCCESS
2025-06-07 09:05:46,287 - INFO - ==================================ENDING LOAD DATA=======================================
2025-06-07 09:05:46,321 - INFO - [pid 19900] Worker Worker(salt=5166618936, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) done      Load()
2025-06-07 09:05:46,323 - DEBUG - 1 running tasks, waiting for next task to finish
2025-06-07 09:05:46,324 - INFO - Informed scheduler that task   Load__99914b932b   has status   DONE
2025-06-07 09:05:46,325 - DEBUG - Asking scheduler for work...
2025-06-07 09:05:46,326 - DEBUG - Done
2025-06-07 09:05:46,327 - DEBUG - There are no more tasks to run at this time
2025-06-07 09:05:46,328 - INFO - Worker Worker(salt=5166618936, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) was stopped. Shutting down Keep-Alive thread
2025-06-07 09:05:46,331 - INFO - 
===== Luigi Execution Summary =====

Scheduled 2 tasks of which:
* 1 complete ones were encountered:
    - 1 Extract()
* 1 ran successfully:
    - 1 Load()

This progress looks :) because there were no failed tasks or missing dependencies

===== Luigi Execution Summary =====

2025-06-07 09:05:51,477 - INFO - logging already configured
2025-06-07 09:05:51,479 - DEBUG - Checking if Extract() is complete
2025-06-07 09:05:51,481 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2025-06-07 09:05:51,483 - DEBUG - Checking if Load() is complete
2025-06-07 09:05:51,484 - INFO - Informed scheduler that task   Load__99914b932b   has status   DONE
2025-06-07 09:05:51,485 - DEBUG - Checking if Transform() is complete
2025-06-07 09:05:51,487 - DEBUG - Checking if Load() is complete
2025-06-07 09:05:51,488 - INFO - Informed scheduler that task   Transform__99914b932b   has status   PENDING
2025-06-07 09:05:51,489 - INFO - Informed scheduler that task   Load__99914b932b   has status   DONE
2025-06-07 09:05:51,489 - INFO - Done scheduling tasks
2025-06-07 09:05:51,490 - INFO - Running Worker with 1 processes
2025-06-07 09:05:51,491 - DEBUG - Asking scheduler for work...
2025-06-07 09:05:51,492 - DEBUG - Pending tasks: 1
2025-06-07 09:05:51,492 - INFO - [pid 19900] Worker Worker(salt=5705543422, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) running   Transform()
2025-06-07 09:05:51,494 - INFO - Connect to DWH - SUCCESS
2025-06-07 09:05:51,509 - INFO - Read Transform Query - SUCCESS
2025-06-07 09:05:51,509 - INFO - ==================================STARTING TRANSFROM DATA=======================================
2025-06-07 09:05:51,587 - ERROR - Transform to All Dimensions and Fact Tables - FAILED
2025-06-07 09:05:51,591 - ERROR - Transform Tables - FAILED
2025-06-07 09:05:51,591 - ERROR - [pid 19900] Worker Worker(salt=5705543422, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) failed    Transform()
Traceback (most recent call last):
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedTable: relation "dwh.dim_geolocation" does not exist
LINE 1: INSERT INTO dwh.dim_geolocation (
                    ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\LENOVO THINKPAD\AppData\Local\Temp\ipykernel_19900\4240733592.py", line 114, in run
    session.execute(query)
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\orm\session.py", line 2362, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\orm\session.py", line 2256, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1418, in execute
    return meth(
           ^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\sql\elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedTable) relation "dwh.dim_geolocation" does not exist
LINE 1: INSERT INTO dwh.dim_geolocation (
                    ^

[SQL: INSERT INTO dwh.dim_geolocation (
    geolocation_zip_code_prefix,
    geolocation_lat, geolocation_lng,
    geolocation_city, geolocation_state
)
SELECT geolocation_zip_code_prefix, 
  geolocation_lat, geolocation_lng, 
  geolocation_city, geolocation_state
FROM stg.geolocation
WHERE geolocation_zip_code_prefix IS NOT NULL
ON CONFLICT (geolocation_zip_code_prefix) DO NOTHING;]
(Background on this error at: https://sqlalche.me/e/20/f405)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 210, in run
    new_deps = self._run_get_new_deps()
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 138, in _run_get_new_deps
    task_gen = self.task.run()
               ^^^^^^^^^^^^^^^
  File "C:\Users\LENOVO THINKPAD\AppData\Local\Temp\ipykernel_19900\4240733592.py", line 193, in run
    raise Exception('Failed Transforming Tables')
Exception: Failed Transforming Tables
2025-06-07 09:05:51,597 - DEBUG - 1 running tasks, waiting for next task to finish
2025-06-07 09:05:51,601 - INFO - Informed scheduler that task   Transform__99914b932b   has status   FAILED
2025-06-07 09:05:51,602 - DEBUG - Asking scheduler for work...
2025-06-07 09:05:51,602 - DEBUG - Done
2025-06-07 09:05:51,603 - DEBUG - There are no more tasks to run at this time
2025-06-07 09:05:51,603 - DEBUG - There are 1 pending tasks possibly being run by other workers
2025-06-07 09:05:51,605 - DEBUG - There are 1 pending tasks unique to this worker
2025-06-07 09:05:51,605 - DEBUG - There are 1 pending tasks last scheduled by this worker
2025-06-07 09:05:51,606 - INFO - Worker Worker(salt=5705543422, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) was stopped. Shutting down Keep-Alive thread
2025-06-07 09:05:51,609 - INFO - 
===== Luigi Execution Summary =====

Scheduled 3 tasks of which:
* 2 complete ones were encountered:
    - 1 Extract()
    - 1 Load()
* 1 failed:
    - 1 Transform()

This progress looks :( because there were failed tasks

===== Luigi Execution Summary =====

2025-06-07 09:07:29,599 - INFO - logging already configured
2025-06-07 09:07:29,602 - DEBUG - Checking if Extract() is complete
2025-06-07 09:07:29,603 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2025-06-07 09:07:29,603 - DEBUG - Checking if Load() is complete
2025-06-07 09:07:29,603 - INFO - Informed scheduler that task   Load__99914b932b   has status   DONE
2025-06-07 09:07:29,606 - DEBUG - Checking if Transform() is complete
2025-06-07 09:07:29,606 - INFO - Informed scheduler that task   Transform__99914b932b   has status   DONE
2025-06-07 09:07:29,606 - INFO - Done scheduling tasks
2025-06-07 09:07:29,606 - INFO - Running Worker with 1 processes
2025-06-07 09:07:29,606 - DEBUG - Asking scheduler for work...
2025-06-07 09:07:29,606 - DEBUG - Done
2025-06-07 09:07:29,611 - DEBUG - There are no more tasks to run at this time
2025-06-07 09:07:29,611 - INFO - Worker Worker(salt=5292676624, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) was stopped. Shutting down Keep-Alive thread
2025-06-07 09:07:29,615 - INFO - 
===== Luigi Execution Summary =====

Scheduled 3 tasks of which:
* 3 complete ones were encountered:
    - 1 Extract()
    - 1 Load()
    - 1 Transform()

Did not run any tasks
This progress looks :) because there were no failed tasks or missing dependencies

===== Luigi Execution Summary =====

2025-06-07 09:08:02,520 - INFO - logging already configured
2025-06-07 09:08:02,522 - DEBUG - Checking if Extract() is complete
2025-06-07 09:08:02,524 - INFO - Informed scheduler that task   Extract__99914b932b   has status   PENDING
2025-06-07 09:08:02,524 - DEBUG - Checking if Load() is complete
2025-06-07 09:08:02,526 - DEBUG - Checking if Extract() is complete
2025-06-07 09:08:02,527 - INFO - Informed scheduler that task   Load__99914b932b   has status   PENDING
2025-06-07 09:08:02,528 - INFO - Informed scheduler that task   Extract__99914b932b   has status   PENDING
2025-06-07 09:08:02,528 - INFO - Done scheduling tasks
2025-06-07 09:08:02,529 - INFO - Running Worker with 1 processes
2025-06-07 09:08:02,530 - DEBUG - Asking scheduler for work...
2025-06-07 09:08:02,530 - DEBUG - Pending tasks: 2
2025-06-07 09:08:02,531 - INFO - [pid 19900] Worker Worker(salt=7404824464, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) running   Extract()
2025-06-07 09:08:02,532 - ERROR - [pid 19900] Worker Worker(salt=7404824464, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) failed    Extract()
Traceback (most recent call last):
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 210, in run
    new_deps = self._run_get_new_deps()
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 138, in _run_get_new_deps
    task_gen = self.task.run()
               ^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\Documents\Github\Pacmann---Data-Storage_-Warehouse--Mart---Lake\mentoring 2\olist-dwh-project\pipeline\extract.py", line 43, in run
    os.makedirs(os.path.dirname(self.output().path), exist_ok=True)
                                ^^^^^^^^^^^^^^^^^^
AttributeError: 'list' object has no attribute 'path'
2025-06-07 09:08:02,535 - DEBUG - 1 running tasks, waiting for next task to finish
2025-06-07 09:08:02,538 - INFO - Informed scheduler that task   Extract__99914b932b   has status   FAILED
2025-06-07 09:08:02,539 - DEBUG - Asking scheduler for work...
2025-06-07 09:08:02,540 - DEBUG - Done
2025-06-07 09:08:02,541 - DEBUG - There are no more tasks to run at this time
2025-06-07 09:08:02,541 - DEBUG - There are 2 pending tasks possibly being run by other workers
2025-06-07 09:08:02,542 - DEBUG - There are 2 pending tasks unique to this worker
2025-06-07 09:08:02,543 - DEBUG - There are 2 pending tasks last scheduled by this worker
2025-06-07 09:08:02,544 - INFO - Worker Worker(salt=7404824464, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) was stopped. Shutting down Keep-Alive thread
2025-06-07 09:08:02,548 - INFO - 
===== Luigi Execution Summary =====

Scheduled 2 tasks of which:
* 1 failed:
    - 1 Extract()
* 1 were left pending, among these:
    * 1 had failed dependencies:
        - 1 Load()

This progress looks :( because there were failed tasks

===== Luigi Execution Summary =====

2025-06-07 09:08:06,702 - INFO - logging already configured
2025-06-07 09:08:06,705 - DEBUG - Checking if Extract() is complete
2025-06-07 09:08:06,707 - INFO - Informed scheduler that task   Extract__99914b932b   has status   PENDING
2025-06-07 09:08:06,708 - INFO - Done scheduling tasks
2025-06-07 09:08:06,708 - INFO - Running Worker with 1 processes
2025-06-07 09:08:06,708 - DEBUG - Asking scheduler for work...
2025-06-07 09:08:06,710 - DEBUG - Pending tasks: 1
2025-06-07 09:08:06,710 - INFO - [pid 19900] Worker Worker(salt=1631821265, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) running   Extract()
2025-06-07 09:08:06,713 - INFO - ==================================STARTING EXTRACT DATA=======================================
2025-06-07 09:08:06,873 - INFO - EXTRACT 'public.geolocation' - SUCCESS.
2025-06-07 09:08:06,880 - INFO - EXTRACT 'public.product_category_name_translation' - SUCCESS.
2025-06-07 09:08:06,889 - INFO - EXTRACT 'public.sellers' - SUCCESS.
2025-06-07 09:08:07,552 - INFO - EXTRACT 'public.customers' - SUCCESS.
2025-06-07 09:08:07,814 - INFO - EXTRACT 'public.products' - SUCCESS.
2025-06-07 09:08:08,516 - INFO - EXTRACT 'public.orders' - SUCCESS.
2025-06-07 09:08:09,304 - INFO - EXTRACT 'public.order_items' - SUCCESS.
2025-06-07 09:08:10,007 - INFO - EXTRACT 'public.order_payments' - SUCCESS.
2025-06-07 09:08:10,661 - INFO - EXTRACT 'public.order_reviews' - SUCCESS.
2025-06-07 09:08:10,661 - INFO - Extract All Tables From Sources - SUCCESS
2025-06-07 09:08:10,662 - INFO - ==================================ENDING EXTRACT DATA=======================================
2025-06-07 09:08:10,676 - INFO - [pid 19900] Worker Worker(salt=1631821265, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) done      Extract()
2025-06-07 09:08:10,678 - DEBUG - 1 running tasks, waiting for next task to finish
2025-06-07 09:08:10,679 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2025-06-07 09:08:10,680 - DEBUG - Asking scheduler for work...
2025-06-07 09:08:10,680 - DEBUG - Done
2025-06-07 09:08:10,681 - DEBUG - There are no more tasks to run at this time
2025-06-07 09:08:10,681 - INFO - Worker Worker(salt=1631821265, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) was stopped. Shutting down Keep-Alive thread
2025-06-07 09:08:10,685 - INFO - 
===== Luigi Execution Summary =====

Scheduled 1 tasks of which:
* 1 ran successfully:
    - 1 Extract()

This progress looks :) because there were no failed tasks or missing dependencies

===== Luigi Execution Summary =====

2025-06-07 09:08:15,090 - INFO - logging already configured
2025-06-07 09:08:15,092 - DEBUG - Checking if Extract() is complete
2025-06-07 09:08:15,094 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2025-06-07 09:08:15,095 - DEBUG - Checking if Load() is complete
2025-06-07 09:08:15,096 - DEBUG - Checking if Extract() is complete
2025-06-07 09:08:15,097 - INFO - Informed scheduler that task   Load__99914b932b   has status   PENDING
2025-06-07 09:08:15,098 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2025-06-07 09:08:15,099 - INFO - Done scheduling tasks
2025-06-07 09:08:15,100 - INFO - Running Worker with 1 processes
2025-06-07 09:08:15,101 - DEBUG - Asking scheduler for work...
2025-06-07 09:08:15,101 - DEBUG - Pending tasks: 1
2025-06-07 09:08:15,102 - INFO - [pid 19900] Worker Worker(salt=6510873888, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) running   Load()
2025-06-07 09:08:15,105 - INFO - Read Load Query - SUCCESS
2025-06-07 09:08:16,306 - INFO - Read Extracted Data - SUCCESS
2025-06-07 09:08:16,307 - INFO - Connect to olist-dwh - SUCCESS
2025-06-07 09:08:16,438 - INFO - Truncate `public` Schema in olist-dwh - SUCCESS
2025-06-07 09:08:16,438 - INFO - ==================================STARTING LOAD DATA=======================================
2025-06-07 09:08:44,444 - INFO - LOAD All Tables To olist-dwh-public - SUCCESS
2025-06-07 09:08:48,521 - INFO - LOAD All Tables To DWH-Staging - SUCCESS
2025-06-07 09:08:48,529 - INFO - ==================================ENDING LOAD DATA=======================================
2025-06-07 09:08:48,549 - INFO - [pid 19900] Worker Worker(salt=6510873888, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) done      Load()
2025-06-07 09:08:48,564 - DEBUG - 1 running tasks, waiting for next task to finish
2025-06-07 09:08:48,565 - INFO - Informed scheduler that task   Load__99914b932b   has status   DONE
2025-06-07 09:08:48,565 - DEBUG - Asking scheduler for work...
2025-06-07 09:08:48,565 - DEBUG - Done
2025-06-07 09:08:48,567 - DEBUG - There are no more tasks to run at this time
2025-06-07 09:08:48,567 - INFO - Worker Worker(salt=6510873888, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) was stopped. Shutting down Keep-Alive thread
2025-06-07 09:08:48,569 - INFO - 
===== Luigi Execution Summary =====

Scheduled 2 tasks of which:
* 1 complete ones were encountered:
    - 1 Extract()
* 1 ran successfully:
    - 1 Load()

This progress looks :) because there were no failed tasks or missing dependencies

===== Luigi Execution Summary =====

2025-06-07 09:08:52,889 - INFO - logging already configured
2025-06-07 09:08:52,891 - DEBUG - Checking if Extract() is complete
2025-06-07 09:08:52,893 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2025-06-07 09:08:52,893 - DEBUG - Checking if Load() is complete
2025-06-07 09:08:52,893 - INFO - Informed scheduler that task   Load__99914b932b   has status   DONE
2025-06-07 09:08:52,893 - DEBUG - Checking if Transform() is complete
2025-06-07 09:08:52,896 - DEBUG - Checking if Load() is complete
2025-06-07 09:08:52,897 - INFO - Informed scheduler that task   Transform__99914b932b   has status   PENDING
2025-06-07 09:08:52,897 - INFO - Informed scheduler that task   Load__99914b932b   has status   DONE
2025-06-07 09:08:52,897 - INFO - Done scheduling tasks
2025-06-07 09:08:52,897 - INFO - Running Worker with 1 processes
2025-06-07 09:08:52,897 - DEBUG - Asking scheduler for work...
2025-06-07 09:08:52,897 - DEBUG - Pending tasks: 1
2025-06-07 09:08:52,897 - INFO - [pid 19900] Worker Worker(salt=3455850063, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) running   Transform()
2025-06-07 09:08:52,903 - INFO - Connect to DWH - SUCCESS
2025-06-07 09:08:52,904 - INFO - Read Transform Query - SUCCESS
2025-06-07 09:08:52,904 - INFO - ==================================STARTING TRANSFROM DATA=======================================
2025-06-07 09:08:53,086 - INFO - Transform to 'dwh.dim_geolocation' - SUCCESS
2025-06-07 09:08:53,091 - INFO - Transform to 'dwh.dim_product_category' - SUCCESS
2025-06-07 09:08:53,109 - INFO - Transform to 'dwh.dim_sellers' - SUCCESS
2025-06-07 09:08:53,774 - INFO - Transform to 'dwh.dim_customers' - SUCCESS
2025-06-07 09:08:54,033 - INFO - Transform to 'dwh.dim_products' - SUCCESS
2025-06-07 09:08:54,528 - INFO - Transform to 'dwh.fact_orders_comprehensive' - SUCCESS
2025-06-07 09:08:54,530 - ERROR - Transform to All Dimensions and Fact Tables - FAILED
2025-06-07 09:08:54,531 - ERROR - Transform Tables - FAILED
2025-06-07 09:08:54,531 - ERROR - [pid 19900] Worker Worker(salt=3455850063, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) failed    Transform()
Traceback (most recent call last):
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedColumn: column "customer_id" of relation "fact_reviews_sentiment" does not exist
LINE 4:     customer_id,
            ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\LENOVO THINKPAD\AppData\Local\Temp\ipykernel_19900\4240733592.py", line 138, in run
    session.execute(query)
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\orm\session.py", line 2362, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\orm\session.py", line 2256, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1418, in execute
    return meth(
           ^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\sql\elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedColumn) column "customer_id" of relation "fact_reviews_sentiment" does not exist
LINE 4:     customer_id,
            ^

[SQL: INSERT INTO dwh.fact_reviews_sentiment (
    review_id,
    order_compr_id,
    customer_id,
    product_id,
    review_title,
    review_comment_message,
    review_score
)
SELECT
    r.review_id,
    foc.order_compr_id,
    o.customer_id,
    oi.product_id,
    r.review_comment_title,
    r.review_comment_message,
    r.review_score

FROM stg.order_reviews r
JOIN stg.orders o ON r.order_id = o.order_id
JOIN stg.order_items oi ON r.order_id = oi.order_id
    AND oi.order_item_id = 1  -- assuming one primary product per order to resolve product_id
JOIN dwh.fact_orders_comprehensive foc
    ON foc.order_id = o.order_id
    AND foc.customer_id = o.customer_id
    AND foc.product_id = oi.product_id;
]
(Background on this error at: https://sqlalche.me/e/20/f405)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 210, in run
    new_deps = self._run_get_new_deps()
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 138, in _run_get_new_deps
    task_gen = self.task.run()
               ^^^^^^^^^^^^^^^
  File "C:\Users\LENOVO THINKPAD\AppData\Local\Temp\ipykernel_19900\4240733592.py", line 193, in run
    raise Exception('Failed Transforming Tables')
Exception: Failed Transforming Tables
2025-06-07 09:08:54,536 - DEBUG - 1 running tasks, waiting for next task to finish
2025-06-07 09:08:54,540 - INFO - Informed scheduler that task   Transform__99914b932b   has status   FAILED
2025-06-07 09:08:54,542 - DEBUG - Asking scheduler for work...
2025-06-07 09:08:54,543 - DEBUG - Done
2025-06-07 09:08:54,543 - DEBUG - There are no more tasks to run at this time
2025-06-07 09:08:54,544 - DEBUG - There are 1 pending tasks possibly being run by other workers
2025-06-07 09:08:54,545 - DEBUG - There are 1 pending tasks unique to this worker
2025-06-07 09:08:54,546 - DEBUG - There are 1 pending tasks last scheduled by this worker
2025-06-07 09:08:54,546 - INFO - Worker Worker(salt=3455850063, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) was stopped. Shutting down Keep-Alive thread
2025-06-07 09:08:54,550 - INFO - 
===== Luigi Execution Summary =====

Scheduled 3 tasks of which:
* 2 complete ones were encountered:
    - 1 Extract()
    - 1 Load()
* 1 failed:
    - 1 Transform()

This progress looks :( because there were failed tasks

===== Luigi Execution Summary =====

2025-06-07 09:10:54,776 - INFO - logging already configured
2025-06-07 09:10:54,779 - DEBUG - Checking if Extract() is complete
2025-06-07 09:10:54,781 - INFO - Informed scheduler that task   Extract__99914b932b   has status   PENDING
2025-06-07 09:10:54,782 - INFO - Done scheduling tasks
2025-06-07 09:10:54,782 - INFO - Running Worker with 1 processes
2025-06-07 09:10:54,783 - DEBUG - Asking scheduler for work...
2025-06-07 09:10:54,784 - DEBUG - Pending tasks: 1
2025-06-07 09:10:54,785 - INFO - [pid 19900] Worker Worker(salt=4158274507, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) running   Extract()
2025-06-07 09:10:54,787 - INFO - ==================================STARTING EXTRACT DATA=======================================
2025-06-07 09:10:54,962 - INFO - EXTRACT 'public.geolocation' - SUCCESS.
2025-06-07 09:10:54,970 - INFO - EXTRACT 'public.product_category_name_translation' - SUCCESS.
2025-06-07 09:10:54,988 - INFO - EXTRACT 'public.sellers' - SUCCESS.
2025-06-07 09:10:55,616 - INFO - EXTRACT 'public.customers' - SUCCESS.
2025-06-07 09:10:56,000 - INFO - EXTRACT 'public.products' - SUCCESS.
2025-06-07 09:10:56,731 - INFO - EXTRACT 'public.orders' - SUCCESS.
2025-06-07 09:10:57,513 - INFO - EXTRACT 'public.order_items' - SUCCESS.
2025-06-07 09:10:58,112 - INFO - EXTRACT 'public.order_payments' - SUCCESS.
2025-06-07 09:10:58,773 - INFO - EXTRACT 'public.order_reviews' - SUCCESS.
2025-06-07 09:10:58,774 - INFO - Extract All Tables From Sources - SUCCESS
2025-06-07 09:10:58,776 - INFO - ==================================ENDING EXTRACT DATA=======================================
2025-06-07 09:10:58,789 - INFO - [pid 19900] Worker Worker(salt=4158274507, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) done      Extract()
2025-06-07 09:10:58,791 - DEBUG - 1 running tasks, waiting for next task to finish
2025-06-07 09:10:58,792 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2025-06-07 09:10:58,793 - DEBUG - Asking scheduler for work...
2025-06-07 09:10:58,794 - DEBUG - Done
2025-06-07 09:10:58,794 - DEBUG - There are no more tasks to run at this time
2025-06-07 09:10:58,795 - INFO - Worker Worker(salt=4158274507, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) was stopped. Shutting down Keep-Alive thread
2025-06-07 09:10:58,798 - INFO - 
===== Luigi Execution Summary =====

Scheduled 1 tasks of which:
* 1 ran successfully:
    - 1 Extract()

This progress looks :) because there were no failed tasks or missing dependencies

===== Luigi Execution Summary =====

2025-06-07 09:11:02,375 - INFO - logging already configured
2025-06-07 09:11:02,377 - DEBUG - Checking if Extract() is complete
2025-06-07 09:11:02,379 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2025-06-07 09:11:02,379 - DEBUG - Checking if Load() is complete
2025-06-07 09:11:02,381 - DEBUG - Checking if Extract() is complete
2025-06-07 09:11:02,381 - INFO - Informed scheduler that task   Load__99914b932b   has status   PENDING
2025-06-07 09:11:02,381 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2025-06-07 09:11:02,381 - INFO - Done scheduling tasks
2025-06-07 09:11:02,381 - INFO - Running Worker with 1 processes
2025-06-07 09:11:02,381 - DEBUG - Asking scheduler for work...
2025-06-07 09:11:02,381 - DEBUG - Pending tasks: 1
2025-06-07 09:11:02,381 - INFO - [pid 19900] Worker Worker(salt=385051304, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) running   Load()
2025-06-07 09:11:02,388 - INFO - Read Load Query - SUCCESS
2025-06-07 09:11:03,653 - INFO - Read Extracted Data - SUCCESS
2025-06-07 09:11:03,653 - INFO - Connect to olist-dwh - SUCCESS
2025-06-07 09:11:03,811 - INFO - Truncate `public` Schema in olist-dwh - SUCCESS
2025-06-07 09:11:03,811 - INFO - ==================================STARTING LOAD DATA=======================================
2025-06-07 09:11:35,197 - INFO - LOAD All Tables To olist-dwh-public - SUCCESS
2025-06-07 09:11:39,188 - INFO - LOAD All Tables To DWH-Staging - SUCCESS
2025-06-07 09:11:39,190 - INFO - ==================================ENDING LOAD DATA=======================================
2025-06-07 09:11:39,222 - INFO - [pid 19900] Worker Worker(salt=385051304, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) done      Load()
2025-06-07 09:11:39,224 - DEBUG - 1 running tasks, waiting for next task to finish
2025-06-07 09:11:39,225 - INFO - Informed scheduler that task   Load__99914b932b   has status   DONE
2025-06-07 09:11:39,226 - DEBUG - Asking scheduler for work...
2025-06-07 09:11:39,227 - DEBUG - Done
2025-06-07 09:11:39,228 - DEBUG - There are no more tasks to run at this time
2025-06-07 09:11:39,229 - INFO - Worker Worker(salt=385051304, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) was stopped. Shutting down Keep-Alive thread
2025-06-07 09:11:39,233 - INFO - 
===== Luigi Execution Summary =====

Scheduled 2 tasks of which:
* 1 complete ones were encountered:
    - 1 Extract()
* 1 ran successfully:
    - 1 Load()

This progress looks :) because there were no failed tasks or missing dependencies

===== Luigi Execution Summary =====

2025-06-07 09:11:43,721 - INFO - logging already configured
2025-06-07 09:11:43,723 - DEBUG - Checking if Extract() is complete
2025-06-07 09:11:43,725 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2025-06-07 09:11:43,726 - DEBUG - Checking if Load() is complete
2025-06-07 09:11:43,727 - INFO - Informed scheduler that task   Load__99914b932b   has status   DONE
2025-06-07 09:11:43,728 - DEBUG - Checking if Transform() is complete
2025-06-07 09:11:43,729 - DEBUG - Checking if Load() is complete
2025-06-07 09:11:43,731 - INFO - Informed scheduler that task   Transform__99914b932b   has status   PENDING
2025-06-07 09:11:43,731 - INFO - Informed scheduler that task   Load__99914b932b   has status   DONE
2025-06-07 09:11:43,732 - INFO - Done scheduling tasks
2025-06-07 09:11:43,732 - INFO - Running Worker with 1 processes
2025-06-07 09:11:43,733 - DEBUG - Asking scheduler for work...
2025-06-07 09:11:43,734 - DEBUG - Pending tasks: 1
2025-06-07 09:11:43,734 - INFO - [pid 19900] Worker Worker(salt=1952063183, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) running   Transform()
2025-06-07 09:11:43,736 - INFO - Connect to DWH - SUCCESS
2025-06-07 09:11:43,751 - INFO - Read Transform Query - SUCCESS
2025-06-07 09:11:43,751 - INFO - ==================================STARTING TRANSFROM DATA=======================================
2025-06-07 09:11:43,915 - INFO - Transform to 'dwh.dim_geolocation' - SUCCESS
2025-06-07 09:11:43,919 - INFO - Transform to 'dwh.dim_product_category' - SUCCESS
2025-06-07 09:11:43,953 - INFO - Transform to 'dwh.dim_sellers' - SUCCESS
2025-06-07 09:11:44,730 - INFO - Transform to 'dwh.dim_customers' - SUCCESS
2025-06-07 09:11:45,099 - INFO - Transform to 'dwh.dim_products' - SUCCESS
2025-06-07 09:11:45,548 - INFO - Transform to 'dwh.fact_orders_comprehensive' - SUCCESS
2025-06-07 09:11:45,550 - ERROR - Transform to All Dimensions and Fact Tables - FAILED
2025-06-07 09:11:45,552 - ERROR - Transform Tables - FAILED
2025-06-07 09:11:45,552 - ERROR - [pid 19900] Worker Worker(salt=1952063183, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) failed    Transform()
Traceback (most recent call last):
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedColumn: column foc.customer_id does not exist
LINE 25:     AND foc.customer_id = o.customer_id
                 ^
HINT:  Perhaps you meant to reference the column "o.customer_id" or the column "foc.customer_sk".


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\LENOVO THINKPAD\AppData\Local\Temp\ipykernel_19900\4240733592.py", line 138, in run
    session.execute(query)
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\orm\session.py", line 2362, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\orm\session.py", line 2256, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1418, in execute
    return meth(
           ^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\sql\elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedColumn) column foc.customer_id does not exist
LINE 25:     AND foc.customer_id = o.customer_id
                 ^
HINT:  Perhaps you meant to reference the column "o.customer_id" or the column "foc.customer_sk".

[SQL: INSERT INTO dwh.fact_reviews_sentiment (
    review_id,
    order_compr_id,
    customer_sk,
    product_sk,
    review_title,
    review_comment_message,
    review_score
)
SELECT
    r.review_id,
    foc.order_compr_id,
    o.customer_sk,
    oi.product_sk,
    r.review_comment_title,
    r.review_comment_message,
    r.review_score

FROM stg.order_reviews r
JOIN stg.orders o ON r.order_id = o.order_id
JOIN stg.order_items oi ON r.order_id = oi.order_id
    AND oi.order_item_id = 1  -- assuming one primary product per order to resolve product_id
JOIN dwh.fact_orders_comprehensive foc
    ON foc.order_id = o.order_id
    AND foc.customer_id = o.customer_id
    AND foc.product_id = oi.product_id;
]
(Background on this error at: https://sqlalche.me/e/20/f405)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 210, in run
    new_deps = self._run_get_new_deps()
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 138, in _run_get_new_deps
    task_gen = self.task.run()
               ^^^^^^^^^^^^^^^
  File "C:\Users\LENOVO THINKPAD\AppData\Local\Temp\ipykernel_19900\4240733592.py", line 193, in run
    raise Exception('Failed Transforming Tables')
Exception: Failed Transforming Tables
2025-06-07 09:11:45,555 - DEBUG - 1 running tasks, waiting for next task to finish
2025-06-07 09:11:45,558 - INFO - Informed scheduler that task   Transform__99914b932b   has status   FAILED
2025-06-07 09:11:45,559 - DEBUG - Asking scheduler for work...
2025-06-07 09:11:45,560 - DEBUG - Done
2025-06-07 09:11:45,560 - DEBUG - There are no more tasks to run at this time
2025-06-07 09:11:45,561 - DEBUG - There are 1 pending tasks possibly being run by other workers
2025-06-07 09:11:45,562 - DEBUG - There are 1 pending tasks unique to this worker
2025-06-07 09:11:45,562 - DEBUG - There are 1 pending tasks last scheduled by this worker
2025-06-07 09:11:45,563 - INFO - Worker Worker(salt=1952063183, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) was stopped. Shutting down Keep-Alive thread
2025-06-07 09:11:45,567 - INFO - 
===== Luigi Execution Summary =====

Scheduled 3 tasks of which:
* 2 complete ones were encountered:
    - 1 Extract()
    - 1 Load()
* 1 failed:
    - 1 Transform()

This progress looks :( because there were failed tasks

===== Luigi Execution Summary =====

2025-06-07 09:56:40,930 - INFO - logging already configured
2025-06-07 09:56:40,931 - DEBUG - Checking if Extract() is complete
2025-06-07 09:56:40,936 - INFO - Informed scheduler that task   Extract__99914b932b   has status   PENDING
2025-06-07 09:56:40,937 - INFO - Done scheduling tasks
2025-06-07 09:56:40,939 - INFO - Running Worker with 1 processes
2025-06-07 09:56:40,940 - DEBUG - Asking scheduler for work...
2025-06-07 09:56:40,942 - DEBUG - Pending tasks: 1
2025-06-07 09:56:40,942 - INFO - [pid 19900] Worker Worker(salt=4837431386, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) running   Extract()
2025-06-07 09:56:40,945 - INFO - ==================================STARTING EXTRACT DATA=======================================
2025-06-07 09:56:41,370 - INFO - EXTRACT 'public.geolocation' - SUCCESS.
2025-06-07 09:56:41,381 - INFO - EXTRACT 'public.product_category_name_translation' - SUCCESS.
2025-06-07 09:56:41,409 - INFO - EXTRACT 'public.sellers' - SUCCESS.
2025-06-07 09:56:42,431 - INFO - EXTRACT 'public.customers' - SUCCESS.
2025-06-07 09:56:42,896 - INFO - EXTRACT 'public.products' - SUCCESS.
2025-06-07 09:56:44,219 - INFO - EXTRACT 'public.orders' - SUCCESS.
2025-06-07 09:56:45,664 - INFO - EXTRACT 'public.order_items' - SUCCESS.
2025-06-07 09:56:46,824 - INFO - EXTRACT 'public.order_payments' - SUCCESS.
2025-06-07 09:56:47,946 - INFO - EXTRACT 'public.order_reviews' - SUCCESS.
2025-06-07 09:56:47,946 - INFO - Extract All Tables From Sources - SUCCESS
2025-06-07 09:56:47,949 - INFO - ==================================ENDING EXTRACT DATA=======================================
2025-06-07 09:56:47,964 - INFO - [pid 19900] Worker Worker(salt=4837431386, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) done      Extract()
2025-06-07 09:56:47,968 - DEBUG - 1 running tasks, waiting for next task to finish
2025-06-07 09:56:47,969 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2025-06-07 09:56:47,971 - DEBUG - Asking scheduler for work...
2025-06-07 09:56:47,972 - DEBUG - Done
2025-06-07 09:56:47,973 - DEBUG - There are no more tasks to run at this time
2025-06-07 09:56:47,974 - INFO - Worker Worker(salt=4837431386, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) was stopped. Shutting down Keep-Alive thread
2025-06-07 09:56:47,979 - INFO - 
===== Luigi Execution Summary =====

Scheduled 1 tasks of which:
* 1 ran successfully:
    - 1 Extract()

This progress looks :) because there were no failed tasks or missing dependencies

===== Luigi Execution Summary =====

2025-06-07 09:56:51,438 - INFO - logging already configured
2025-06-07 09:56:51,440 - DEBUG - Checking if Extract() is complete
2025-06-07 09:56:51,442 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2025-06-07 09:56:51,444 - DEBUG - Checking if Load() is complete
2025-06-07 09:56:51,447 - DEBUG - Checking if Extract() is complete
2025-06-07 09:56:51,448 - INFO - Informed scheduler that task   Load__99914b932b   has status   PENDING
2025-06-07 09:56:51,450 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2025-06-07 09:56:51,450 - INFO - Done scheduling tasks
2025-06-07 09:56:51,451 - INFO - Running Worker with 1 processes
2025-06-07 09:56:51,453 - DEBUG - Asking scheduler for work...
2025-06-07 09:56:51,454 - DEBUG - Pending tasks: 1
2025-06-07 09:56:51,456 - INFO - [pid 19900] Worker Worker(salt=8641938522, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) running   Load()
2025-06-07 09:56:51,461 - INFO - Read Load Query - SUCCESS
2025-06-07 09:56:53,349 - INFO - Read Extracted Data - SUCCESS
2025-06-07 09:56:53,351 - INFO - Connect to olist-dwh - SUCCESS
2025-06-07 09:56:53,547 - INFO - Truncate `public` Schema in olist-dwh - SUCCESS
2025-06-07 09:56:53,547 - INFO - ==================================STARTING LOAD DATA=======================================
2025-06-07 09:57:36,816 - INFO - LOAD All Tables To olist-dwh-public - SUCCESS
2025-06-07 09:57:44,205 - INFO - LOAD All Tables To DWH-Staging - SUCCESS
2025-06-07 09:57:44,209 - INFO - ==================================ENDING LOAD DATA=======================================
2025-06-07 09:57:44,262 - INFO - [pid 19900] Worker Worker(salt=8641938522, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) done      Load()
2025-06-07 09:57:44,264 - DEBUG - 1 running tasks, waiting for next task to finish
2025-06-07 09:57:44,266 - INFO - Informed scheduler that task   Load__99914b932b   has status   DONE
2025-06-07 09:57:44,268 - DEBUG - Asking scheduler for work...
2025-06-07 09:57:44,270 - DEBUG - Done
2025-06-07 09:57:44,272 - DEBUG - There are no more tasks to run at this time
2025-06-07 09:57:44,274 - INFO - Worker Worker(salt=8641938522, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) was stopped. Shutting down Keep-Alive thread
2025-06-07 09:57:44,303 - INFO - 
===== Luigi Execution Summary =====

Scheduled 2 tasks of which:
* 1 complete ones were encountered:
    - 1 Extract()
* 1 ran successfully:
    - 1 Load()

This progress looks :) because there were no failed tasks or missing dependencies

===== Luigi Execution Summary =====

2025-06-07 09:57:48,886 - INFO - logging already configured
2025-06-07 09:57:48,890 - DEBUG - Checking if Extract() is complete
2025-06-07 09:57:48,893 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2025-06-07 09:57:48,894 - DEBUG - Checking if Load() is complete
2025-06-07 09:57:48,896 - INFO - Informed scheduler that task   Load__99914b932b   has status   DONE
2025-06-07 09:57:48,898 - DEBUG - Checking if Transform() is complete
2025-06-07 09:57:48,901 - DEBUG - Checking if Load() is complete
2025-06-07 09:57:48,902 - INFO - Informed scheduler that task   Transform__99914b932b   has status   PENDING
2025-06-07 09:57:48,904 - INFO - Informed scheduler that task   Load__99914b932b   has status   DONE
2025-06-07 09:57:48,905 - INFO - Done scheduling tasks
2025-06-07 09:57:48,906 - INFO - Running Worker with 1 processes
2025-06-07 09:57:48,907 - DEBUG - Asking scheduler for work...
2025-06-07 09:57:48,909 - DEBUG - Pending tasks: 1
2025-06-07 09:57:48,910 - INFO - [pid 19900] Worker Worker(salt=5024815435, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) running   Transform()
2025-06-07 09:57:48,914 - INFO - Connect to DWH - SUCCESS
2025-06-07 09:57:48,944 - INFO - Read Transform Query - SUCCESS
2025-06-07 09:57:48,944 - INFO - ==================================STARTING TRANSFROM DATA=======================================
2025-06-07 09:57:49,318 - INFO - Transform to 'dwh.dim_geolocation' - SUCCESS
2025-06-07 09:57:49,323 - INFO - Transform to 'dwh.dim_product_category' - SUCCESS
2025-06-07 09:57:49,358 - INFO - Transform to 'dwh.dim_sellers' - SUCCESS
2025-06-07 09:57:50,761 - INFO - Transform to 'dwh.dim_customers' - SUCCESS
2025-06-07 09:57:51,226 - INFO - Transform to 'dwh.dim_products' - SUCCESS
2025-06-07 09:57:52,142 - INFO - Transform to 'dwh.fact_orders_comprehensive' - SUCCESS
2025-06-07 09:57:52,145 - ERROR - Transform to All Dimensions and Fact Tables - FAILED
2025-06-07 09:57:52,148 - ERROR - Transform Tables - FAILED
2025-06-07 09:57:52,148 - ERROR - [pid 19900] Worker Worker(salt=5024815435, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) failed    Transform()
Traceback (most recent call last):
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedColumn: column o.customer_sk does not exist
LINE 25:     AND foc.customer_sk = o.customer_sk
                                   ^
HINT:  Perhaps you meant to reference the column "o.customer_id" or the column "foc.customer_sk".


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\LENOVO THINKPAD\AppData\Local\Temp\ipykernel_19900\4240733592.py", line 138, in run
    session.execute(query)
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\orm\session.py", line 2362, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\orm\session.py", line 2256, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1418, in execute
    return meth(
           ^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\sql\elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedColumn) column o.customer_sk does not exist
LINE 25:     AND foc.customer_sk = o.customer_sk
                                   ^
HINT:  Perhaps you meant to reference the column "o.customer_id" or the column "foc.customer_sk".

[SQL: INSERT INTO dwh.fact_reviews_sentiment (
    review_id,
    order_compr_id,
    customer_sk,
    product_sk,
    review_title,
    review_comment_message,
    review_score
)
SELECT
    r.review_id,
    foc.order_compr_id,
    o.customer_sk,
    oi.product_sk,
    r.review_comment_title,
    r.review_comment_message,
    r.review_score

FROM stg.order_reviews r
JOIN stg.orders o ON r.order_id = o.order_id
JOIN stg.order_items oi ON r.order_id = oi.order_id
    AND oi.order_item_id = 1  -- assuming one primary product per order to resolve product_id
JOIN dwh.fact_orders_comprehensive foc
    ON foc.order_id = o.order_id
    AND foc.customer_sk = o.customer_sk
    AND foc.product_sk = oi.product_sk;
]
(Background on this error at: https://sqlalche.me/e/20/f405)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 210, in run
    new_deps = self._run_get_new_deps()
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 138, in _run_get_new_deps
    task_gen = self.task.run()
               ^^^^^^^^^^^^^^^
  File "C:\Users\LENOVO THINKPAD\AppData\Local\Temp\ipykernel_19900\4240733592.py", line 193, in run
    raise Exception('Failed Transforming Tables')
Exception: Failed Transforming Tables
2025-06-07 09:57:52,156 - DEBUG - 1 running tasks, waiting for next task to finish
2025-06-07 09:57:52,163 - INFO - Informed scheduler that task   Transform__99914b932b   has status   FAILED
2025-06-07 09:57:52,166 - DEBUG - Asking scheduler for work...
2025-06-07 09:57:52,169 - DEBUG - Done
2025-06-07 09:57:52,174 - DEBUG - There are no more tasks to run at this time
2025-06-07 09:57:52,176 - DEBUG - There are 1 pending tasks possibly being run by other workers
2025-06-07 09:57:52,178 - DEBUG - There are 1 pending tasks unique to this worker
2025-06-07 09:57:52,179 - DEBUG - There are 1 pending tasks last scheduled by this worker
2025-06-07 09:57:52,190 - INFO - Worker Worker(salt=5024815435, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) was stopped. Shutting down Keep-Alive thread
2025-06-07 09:57:52,241 - INFO - 
===== Luigi Execution Summary =====

Scheduled 3 tasks of which:
* 2 complete ones were encountered:
    - 1 Extract()
    - 1 Load()
* 1 failed:
    - 1 Transform()

This progress looks :( because there were failed tasks

===== Luigi Execution Summary =====

2025-06-07 10:03:21,514 - INFO - logging already configured
2025-06-07 10:03:21,514 - DEBUG - Checking if Extract() is complete
2025-06-07 10:03:21,522 - INFO - Informed scheduler that task   Extract__99914b932b   has status   PENDING
2025-06-07 10:03:21,522 - DEBUG - Checking if Load() is complete
2025-06-07 10:03:21,526 - DEBUG - Checking if Extract() is complete
2025-06-07 10:03:21,526 - INFO - Informed scheduler that task   Load__99914b932b   has status   PENDING
2025-06-07 10:03:21,526 - INFO - Informed scheduler that task   Extract__99914b932b   has status   PENDING
2025-06-07 10:03:21,526 - INFO - Done scheduling tasks
2025-06-07 10:03:21,526 - INFO - Running Worker with 1 processes
2025-06-07 10:03:21,526 - DEBUG - Asking scheduler for work...
2025-06-07 10:03:21,526 - DEBUG - Pending tasks: 2
2025-06-07 10:03:21,526 - INFO - [pid 19900] Worker Worker(salt=534219155, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) running   Extract()
2025-06-07 10:03:21,538 - ERROR - [pid 19900] Worker Worker(salt=534219155, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) failed    Extract()
Traceback (most recent call last):
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 210, in run
    new_deps = self._run_get_new_deps()
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 138, in _run_get_new_deps
    task_gen = self.task.run()
               ^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\Documents\Github\Pacmann---Data-Storage_-Warehouse--Mart---Lake\mentoring 2\olist-dwh-project\pipeline\extract.py", line 43, in run
    os.makedirs(os.path.dirname(self.output().path), exist_ok=True)
                                ^^^^^^^^^^^^^^^^^^
AttributeError: 'list' object has no attribute 'path'
2025-06-07 10:03:21,543 - DEBUG - 1 running tasks, waiting for next task to finish
2025-06-07 10:03:21,543 - INFO - Informed scheduler that task   Extract__99914b932b   has status   FAILED
2025-06-07 10:03:21,543 - DEBUG - Asking scheduler for work...
2025-06-07 10:03:21,543 - DEBUG - Done
2025-06-07 10:03:21,554 - DEBUG - There are no more tasks to run at this time
2025-06-07 10:03:21,554 - DEBUG - There are 2 pending tasks possibly being run by other workers
2025-06-07 10:03:21,554 - DEBUG - There are 2 pending tasks unique to this worker
2025-06-07 10:03:21,554 - DEBUG - There are 2 pending tasks last scheduled by this worker
2025-06-07 10:03:21,558 - INFO - Worker Worker(salt=534219155, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) was stopped. Shutting down Keep-Alive thread
2025-06-07 10:03:21,562 - INFO - 
===== Luigi Execution Summary =====

Scheduled 2 tasks of which:
* 1 failed:
    - 1 Extract()
* 1 were left pending, among these:
    * 1 had failed dependencies:
        - 1 Load()

This progress looks :( because there were failed tasks

===== Luigi Execution Summary =====

2025-06-07 10:03:27,220 - INFO - logging already configured
2025-06-07 10:03:27,224 - DEBUG - Checking if Extract() is complete
2025-06-07 10:03:27,225 - INFO - Informed scheduler that task   Extract__99914b932b   has status   PENDING
2025-06-07 10:03:27,227 - INFO - Done scheduling tasks
2025-06-07 10:03:27,228 - INFO - Running Worker with 1 processes
2025-06-07 10:03:27,229 - DEBUG - Asking scheduler for work...
2025-06-07 10:03:27,229 - DEBUG - Pending tasks: 1
2025-06-07 10:03:27,232 - INFO - [pid 19900] Worker Worker(salt=2883309378, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) running   Extract()
2025-06-07 10:03:27,235 - INFO - ==================================STARTING EXTRACT DATA=======================================
2025-06-07 10:03:27,842 - INFO - EXTRACT 'public.geolocation' - SUCCESS.
2025-06-07 10:03:27,851 - INFO - EXTRACT 'public.product_category_name_translation' - SUCCESS.
2025-06-07 10:03:27,887 - INFO - EXTRACT 'public.sellers' - SUCCESS.
2025-06-07 10:03:28,930 - INFO - EXTRACT 'public.customers' - SUCCESS.
2025-06-07 10:03:29,384 - INFO - EXTRACT 'public.products' - SUCCESS.
2025-06-07 10:03:30,555 - INFO - EXTRACT 'public.orders' - SUCCESS.
2025-06-07 10:03:31,893 - INFO - EXTRACT 'public.order_items' - SUCCESS.
2025-06-07 10:03:33,000 - INFO - EXTRACT 'public.order_payments' - SUCCESS.
2025-06-07 10:03:34,092 - INFO - EXTRACT 'public.order_reviews' - SUCCESS.
2025-06-07 10:03:34,093 - INFO - Extract All Tables From Sources - SUCCESS
2025-06-07 10:03:34,096 - INFO - ==================================ENDING EXTRACT DATA=======================================
2025-06-07 10:03:34,114 - INFO - [pid 19900] Worker Worker(salt=2883309378, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) done      Extract()
2025-06-07 10:03:34,117 - DEBUG - 1 running tasks, waiting for next task to finish
2025-06-07 10:03:34,119 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2025-06-07 10:03:34,122 - DEBUG - Asking scheduler for work...
2025-06-07 10:03:34,123 - DEBUG - Done
2025-06-07 10:03:34,124 - DEBUG - There are no more tasks to run at this time
2025-06-07 10:03:34,128 - INFO - Worker Worker(salt=2883309378, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) was stopped. Shutting down Keep-Alive thread
2025-06-07 10:03:34,190 - INFO - 
===== Luigi Execution Summary =====

Scheduled 1 tasks of which:
* 1 ran successfully:
    - 1 Extract()

This progress looks :) because there were no failed tasks or missing dependencies

===== Luigi Execution Summary =====

2025-06-07 10:03:38,001 - INFO - logging already configured
2025-06-07 10:03:38,005 - DEBUG - Checking if Extract() is complete
2025-06-07 10:03:38,007 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2025-06-07 10:03:38,009 - DEBUG - Checking if Load() is complete
2025-06-07 10:03:38,011 - DEBUG - Checking if Extract() is complete
2025-06-07 10:03:38,013 - INFO - Informed scheduler that task   Load__99914b932b   has status   PENDING
2025-06-07 10:03:38,014 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2025-06-07 10:03:38,015 - INFO - Done scheduling tasks
2025-06-07 10:03:38,017 - INFO - Running Worker with 1 processes
2025-06-07 10:03:38,018 - DEBUG - Asking scheduler for work...
2025-06-07 10:03:38,019 - DEBUG - Pending tasks: 1
2025-06-07 10:03:38,020 - INFO - [pid 19900] Worker Worker(salt=9230235003, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) running   Load()
2025-06-07 10:03:38,024 - INFO - Read Load Query - SUCCESS
2025-06-07 10:03:39,980 - INFO - Read Extracted Data - SUCCESS
2025-06-07 10:03:39,981 - INFO - Connect to olist-dwh - SUCCESS
2025-06-07 10:03:40,164 - INFO - Truncate `public` Schema in olist-dwh - SUCCESS
2025-06-07 10:03:40,165 - INFO - ==================================STARTING LOAD DATA=======================================
2025-06-07 10:04:24,844 - INFO - LOAD All Tables To olist-dwh-public - SUCCESS
2025-06-07 10:04:32,160 - INFO - LOAD All Tables To DWH-Staging - SUCCESS
2025-06-07 10:04:32,163 - INFO - ==================================ENDING LOAD DATA=======================================
2025-06-07 10:04:32,214 - INFO - [pid 19900] Worker Worker(salt=9230235003, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) done      Load()
2025-06-07 10:04:32,219 - DEBUG - 1 running tasks, waiting for next task to finish
2025-06-07 10:04:32,221 - INFO - Informed scheduler that task   Load__99914b932b   has status   DONE
2025-06-07 10:04:32,222 - DEBUG - Asking scheduler for work...
2025-06-07 10:04:32,224 - DEBUG - Done
2025-06-07 10:04:32,225 - DEBUG - There are no more tasks to run at this time
2025-06-07 10:04:32,227 - INFO - Worker Worker(salt=9230235003, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) was stopped. Shutting down Keep-Alive thread
2025-06-07 10:04:32,233 - INFO - 
===== Luigi Execution Summary =====

Scheduled 2 tasks of which:
* 1 complete ones were encountered:
    - 1 Extract()
* 1 ran successfully:
    - 1 Load()

This progress looks :) because there were no failed tasks or missing dependencies

===== Luigi Execution Summary =====

2025-06-07 10:04:36,817 - INFO - logging already configured
2025-06-07 10:04:36,822 - DEBUG - Checking if Extract() is complete
2025-06-07 10:04:36,824 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2025-06-07 10:04:36,824 - DEBUG - Checking if Load() is complete
2025-06-07 10:04:36,827 - INFO - Informed scheduler that task   Load__99914b932b   has status   DONE
2025-06-07 10:04:36,827 - DEBUG - Checking if Transform() is complete
2025-06-07 10:04:36,830 - DEBUG - Checking if Load() is complete
2025-06-07 10:04:36,831 - INFO - Informed scheduler that task   Transform__99914b932b   has status   PENDING
2025-06-07 10:04:36,833 - INFO - Informed scheduler that task   Load__99914b932b   has status   DONE
2025-06-07 10:04:36,835 - INFO - Done scheduling tasks
2025-06-07 10:04:36,835 - INFO - Running Worker with 1 processes
2025-06-07 10:04:36,836 - DEBUG - Asking scheduler for work...
2025-06-07 10:04:36,838 - DEBUG - Pending tasks: 1
2025-06-07 10:04:36,839 - INFO - [pid 19900] Worker Worker(salt=5072748467, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) running   Transform()
2025-06-07 10:04:36,843 - INFO - Connect to DWH - SUCCESS
2025-06-07 10:04:36,848 - INFO - Read Transform Query - SUCCESS
2025-06-07 10:04:36,848 - INFO - ==================================STARTING TRANSFROM DATA=======================================
2025-06-07 10:04:37,136 - INFO - Transform to 'dwh.dim_geolocation' - SUCCESS
2025-06-07 10:04:37,142 - INFO - Transform to 'dwh.dim_product_category' - SUCCESS
2025-06-07 10:04:37,174 - INFO - Transform to 'dwh.dim_sellers' - SUCCESS
2025-06-07 10:04:38,459 - INFO - Transform to 'dwh.dim_customers' - SUCCESS
2025-06-07 10:04:38,931 - INFO - Transform to 'dwh.dim_products' - SUCCESS
2025-06-07 10:04:39,761 - INFO - Transform to 'dwh.fact_orders_comprehensive' - SUCCESS
2025-06-07 10:04:39,764 - ERROR - Transform to All Dimensions and Fact Tables - FAILED
2025-06-07 10:04:39,768 - ERROR - Transform Tables - FAILED
2025-06-07 10:04:39,769 - ERROR - [pid 19900] Worker Worker(salt=5072748467, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) failed    Transform()
Traceback (most recent call last):
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedColumn: column r.order_compr_id does not exist
LINE 20: join dwh.fact_orders_comprehensive foc on r.order_compr_id =...
                                                   ^
HINT:  Perhaps you meant to reference the column "foc.order_compr_id".


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\LENOVO THINKPAD\AppData\Local\Temp\ipykernel_19900\4240733592.py", line 138, in run
    session.execute(query)
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\orm\session.py", line 2362, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\orm\session.py", line 2256, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1418, in execute
    return meth(
           ^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\sql\elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedColumn) column r.order_compr_id does not exist
LINE 20: join dwh.fact_orders_comprehensive foc on r.order_compr_id =...
                                                   ^
HINT:  Perhaps you meant to reference the column "foc.order_compr_id".

[SQL: INSERT INTO dwh.fact_reviews_sentiment (
    review_id,
    order_compr_id,
    customer_sk,
    product_sk,
    review_title,
    review_comment_message,
    review_score
)
SELECT
    r.review_id,
    foc.order_compr_id,
    foc.customer_sk,
    foc.product_sk,
    r.review_comment_title,
    r.review_comment_message,
    r.review_score

FROM stg.order_reviews r
join dwh.fact_orders_comprehensive foc on r.order_compr_id = foc.order_compr_id
JOIN stg.orders o ON r.order_id = o.order_i

]
(Background on this error at: https://sqlalche.me/e/20/f405)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 210, in run
    new_deps = self._run_get_new_deps()
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 138, in _run_get_new_deps
    task_gen = self.task.run()
               ^^^^^^^^^^^^^^^
  File "C:\Users\LENOVO THINKPAD\AppData\Local\Temp\ipykernel_19900\4240733592.py", line 193, in run
    raise Exception('Failed Transforming Tables')
Exception: Failed Transforming Tables
2025-06-07 10:04:39,778 - DEBUG - 1 running tasks, waiting for next task to finish
2025-06-07 10:04:39,786 - INFO - Informed scheduler that task   Transform__99914b932b   has status   FAILED
2025-06-07 10:04:39,789 - DEBUG - Asking scheduler for work...
2025-06-07 10:04:39,790 - DEBUG - Done
2025-06-07 10:04:39,792 - DEBUG - There are no more tasks to run at this time
2025-06-07 10:04:39,793 - DEBUG - There are 1 pending tasks possibly being run by other workers
2025-06-07 10:04:39,794 - DEBUG - There are 1 pending tasks unique to this worker
2025-06-07 10:04:39,796 - DEBUG - There are 1 pending tasks last scheduled by this worker
2025-06-07 10:04:39,805 - INFO - Worker Worker(salt=5072748467, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) was stopped. Shutting down Keep-Alive thread
2025-06-07 10:04:39,843 - INFO - 
===== Luigi Execution Summary =====

Scheduled 3 tasks of which:
* 2 complete ones were encountered:
    - 1 Extract()
    - 1 Load()
* 1 failed:
    - 1 Transform()

This progress looks :( because there were failed tasks

===== Luigi Execution Summary =====

2025-06-07 10:06:55,884 - INFO - logging already configured
2025-06-07 10:06:55,887 - DEBUG - Checking if Extract() is complete
2025-06-07 10:06:55,889 - INFO - Informed scheduler that task   Extract__99914b932b   has status   PENDING
2025-06-07 10:06:55,890 - INFO - Done scheduling tasks
2025-06-07 10:06:55,892 - INFO - Running Worker with 1 processes
2025-06-07 10:06:55,894 - DEBUG - Asking scheduler for work...
2025-06-07 10:06:55,895 - DEBUG - Pending tasks: 1
2025-06-07 10:06:55,897 - INFO - [pid 19900] Worker Worker(salt=2201195842, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) running   Extract()
2025-06-07 10:06:55,900 - INFO - ==================================STARTING EXTRACT DATA=======================================
2025-06-07 10:06:56,584 - INFO - EXTRACT 'public.geolocation' - SUCCESS.
2025-06-07 10:06:56,600 - INFO - EXTRACT 'public.product_category_name_translation' - SUCCESS.
2025-06-07 10:06:56,628 - INFO - EXTRACT 'public.sellers' - SUCCESS.
2025-06-07 10:06:57,583 - INFO - EXTRACT 'public.customers' - SUCCESS.
2025-06-07 10:06:58,070 - INFO - EXTRACT 'public.products' - SUCCESS.
2025-06-07 10:06:59,252 - INFO - EXTRACT 'public.orders' - SUCCESS.
2025-06-07 10:07:00,653 - INFO - EXTRACT 'public.order_items' - SUCCESS.
2025-06-07 10:07:01,674 - INFO - EXTRACT 'public.order_payments' - SUCCESS.
2025-06-07 10:07:02,770 - INFO - EXTRACT 'public.order_reviews' - SUCCESS.
2025-06-07 10:07:02,770 - INFO - Extract All Tables From Sources - SUCCESS
2025-06-07 10:07:02,770 - INFO - ==================================ENDING EXTRACT DATA=======================================
2025-06-07 10:07:02,794 - INFO - [pid 19900] Worker Worker(salt=2201195842, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) done      Extract()
2025-06-07 10:07:02,801 - DEBUG - 1 running tasks, waiting for next task to finish
2025-06-07 10:07:02,803 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2025-06-07 10:07:02,805 - DEBUG - Asking scheduler for work...
2025-06-07 10:07:02,809 - DEBUG - Done
2025-06-07 10:07:02,812 - DEBUG - There are no more tasks to run at this time
2025-06-07 10:07:02,814 - INFO - Worker Worker(salt=2201195842, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) was stopped. Shutting down Keep-Alive thread
2025-06-07 10:07:02,821 - INFO - 
===== Luigi Execution Summary =====

Scheduled 1 tasks of which:
* 1 ran successfully:
    - 1 Extract()

This progress looks :) because there were no failed tasks or missing dependencies

===== Luigi Execution Summary =====

2025-06-07 10:07:06,979 - INFO - logging already configured
2025-06-07 10:07:06,984 - DEBUG - Checking if Extract() is complete
2025-06-07 10:07:06,987 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2025-06-07 10:07:06,989 - DEBUG - Checking if Load() is complete
2025-06-07 10:07:06,990 - DEBUG - Checking if Extract() is complete
2025-06-07 10:07:06,993 - INFO - Informed scheduler that task   Load__99914b932b   has status   PENDING
2025-06-07 10:07:06,995 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2025-06-07 10:07:06,997 - INFO - Done scheduling tasks
2025-06-07 10:07:06,998 - INFO - Running Worker with 1 processes
2025-06-07 10:07:07,000 - DEBUG - Asking scheduler for work...
2025-06-07 10:07:07,001 - DEBUG - Pending tasks: 1
2025-06-07 10:07:07,003 - INFO - [pid 19900] Worker Worker(salt=2068770299, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) running   Load()
2025-06-07 10:07:07,008 - INFO - Read Load Query - SUCCESS
2025-06-07 10:07:09,085 - INFO - Read Extracted Data - SUCCESS
2025-06-07 10:07:09,086 - INFO - Connect to olist-dwh - SUCCESS
2025-06-07 10:07:09,297 - INFO - Truncate `public` Schema in olist-dwh - SUCCESS
2025-06-07 10:07:09,298 - INFO - ==================================STARTING LOAD DATA=======================================
2025-06-07 10:07:53,385 - INFO - LOAD All Tables To olist-dwh-public - SUCCESS
2025-06-07 10:08:00,087 - INFO - LOAD All Tables To DWH-Staging - SUCCESS
2025-06-07 10:08:00,090 - INFO - ==================================ENDING LOAD DATA=======================================
2025-06-07 10:08:00,152 - INFO - [pid 19900] Worker Worker(salt=2068770299, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) done      Load()
2025-06-07 10:08:00,155 - DEBUG - 1 running tasks, waiting for next task to finish
2025-06-07 10:08:00,157 - INFO - Informed scheduler that task   Load__99914b932b   has status   DONE
2025-06-07 10:08:00,159 - DEBUG - Asking scheduler for work...
2025-06-07 10:08:00,160 - DEBUG - Done
2025-06-07 10:08:00,162 - DEBUG - There are no more tasks to run at this time
2025-06-07 10:08:00,164 - INFO - Worker Worker(salt=2068770299, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) was stopped. Shutting down Keep-Alive thread
2025-06-07 10:08:00,170 - INFO - 
===== Luigi Execution Summary =====

Scheduled 2 tasks of which:
* 1 complete ones were encountered:
    - 1 Extract()
* 1 ran successfully:
    - 1 Load()

This progress looks :) because there were no failed tasks or missing dependencies

===== Luigi Execution Summary =====

2025-06-07 10:08:30,505 - INFO - logging already configured
2025-06-07 10:08:30,509 - DEBUG - Checking if Extract() is complete
2025-06-07 10:08:30,511 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2025-06-07 10:08:30,512 - DEBUG - Checking if Load() is complete
2025-06-07 10:08:30,514 - INFO - Informed scheduler that task   Load__99914b932b   has status   DONE
2025-06-07 10:08:30,515 - DEBUG - Checking if Transform() is complete
2025-06-07 10:08:30,517 - DEBUG - Checking if Load() is complete
2025-06-07 10:08:30,518 - INFO - Informed scheduler that task   Transform__99914b932b   has status   PENDING
2025-06-07 10:08:30,520 - INFO - Informed scheduler that task   Load__99914b932b   has status   DONE
2025-06-07 10:08:30,520 - INFO - Done scheduling tasks
2025-06-07 10:08:30,521 - INFO - Running Worker with 1 processes
2025-06-07 10:08:30,523 - DEBUG - Asking scheduler for work...
2025-06-07 10:08:30,524 - DEBUG - Pending tasks: 1
2025-06-07 10:08:30,526 - INFO - [pid 19900] Worker Worker(salt=1812038517, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) running   Transform()
2025-06-07 10:08:30,529 - INFO - Connect to DWH - SUCCESS
2025-06-07 10:08:30,555 - INFO - Read Transform Query - SUCCESS
2025-06-07 10:08:30,555 - INFO - ==================================STARTING TRANSFROM DATA=======================================
2025-06-07 10:08:30,862 - INFO - Transform to 'dwh.dim_geolocation' - SUCCESS
2025-06-07 10:08:30,867 - INFO - Transform to 'dwh.dim_product_category' - SUCCESS
2025-06-07 10:08:30,899 - INFO - Transform to 'dwh.dim_sellers' - SUCCESS
2025-06-07 10:08:32,228 - INFO - Transform to 'dwh.dim_customers' - SUCCESS
2025-06-07 10:08:32,706 - INFO - Transform to 'dwh.dim_products' - SUCCESS
2025-06-07 10:08:33,532 - INFO - Transform to 'dwh.fact_orders_comprehensive' - SUCCESS
2025-06-07 10:08:33,532 - ERROR - Transform to All Dimensions and Fact Tables - FAILED
2025-06-07 10:08:33,536 - ERROR - Transform Tables - FAILED
2025-06-07 10:08:33,536 - ERROR - [pid 19900] Worker Worker(salt=1812038517, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) failed    Transform()
Traceback (most recent call last):
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedColumn: column o.order_i does not exist
LINE 21: JOIN stg.orders o ON r.order_id = o.order_i
                                           ^
HINT:  Perhaps you meant to reference the column "o.order_id".


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\LENOVO THINKPAD\AppData\Local\Temp\ipykernel_19900\4240733592.py", line 138, in run
    session.execute(query)
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\orm\session.py", line 2362, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\orm\session.py", line 2256, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1418, in execute
    return meth(
           ^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\sql\elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedColumn) column o.order_i does not exist
LINE 21: JOIN stg.orders o ON r.order_id = o.order_i
                                           ^
HINT:  Perhaps you meant to reference the column "o.order_id".

[SQL: INSERT INTO dwh.fact_reviews_sentiment (
    review_id,
    order_compr_id,
    customer_sk,
    product_sk,
    review_title,
    review_comment_message,
    review_score
)
SELECT
    r.review_id,
    foc.order_compr_id,
    foc.customer_sk,
    foc.product_sk,
    r.review_comment_title,
    r.review_comment_message,
    r.review_score

FROM stg.order_reviews r
join dwh.fact_orders_comprehensive foc on r.order_id = foc.order_id
JOIN stg.orders o ON r.order_id = o.order_i

]
(Background on this error at: https://sqlalche.me/e/20/f405)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 210, in run
    new_deps = self._run_get_new_deps()
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 138, in _run_get_new_deps
    task_gen = self.task.run()
               ^^^^^^^^^^^^^^^
  File "C:\Users\LENOVO THINKPAD\AppData\Local\Temp\ipykernel_19900\4240733592.py", line 193, in run
    raise Exception('Failed Transforming Tables')
Exception: Failed Transforming Tables
2025-06-07 10:08:33,548 - DEBUG - 1 running tasks, waiting for next task to finish
2025-06-07 10:08:33,556 - INFO - Informed scheduler that task   Transform__99914b932b   has status   FAILED
2025-06-07 10:08:33,558 - DEBUG - Asking scheduler for work...
2025-06-07 10:08:33,558 - DEBUG - Done
2025-06-07 10:08:33,560 - DEBUG - There are no more tasks to run at this time
2025-06-07 10:08:33,562 - DEBUG - There are 1 pending tasks possibly being run by other workers
2025-06-07 10:08:33,588 - DEBUG - There are 1 pending tasks unique to this worker
2025-06-07 10:08:33,588 - DEBUG - There are 1 pending tasks last scheduled by this worker
2025-06-07 10:08:33,593 - INFO - Worker Worker(salt=1812038517, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) was stopped. Shutting down Keep-Alive thread
2025-06-07 10:08:33,615 - INFO - 
===== Luigi Execution Summary =====

Scheduled 3 tasks of which:
* 2 complete ones were encountered:
    - 1 Extract()
    - 1 Load()
* 1 failed:
    - 1 Transform()

This progress looks :( because there were failed tasks

===== Luigi Execution Summary =====

2025-06-07 10:09:16,276 - INFO - logging already configured
2025-06-07 10:09:16,279 - DEBUG - Checking if Extract() is complete
2025-06-07 10:09:16,282 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2025-06-07 10:09:16,284 - DEBUG - Checking if Load() is complete
2025-06-07 10:09:16,286 - INFO - Informed scheduler that task   Load__99914b932b   has status   DONE
2025-06-07 10:09:16,287 - DEBUG - Checking if Transform() is complete
2025-06-07 10:09:16,290 - INFO - Informed scheduler that task   Transform__99914b932b   has status   DONE
2025-06-07 10:09:16,290 - INFO - Done scheduling tasks
2025-06-07 10:09:16,292 - INFO - Running Worker with 1 processes
2025-06-07 10:09:16,293 - DEBUG - Asking scheduler for work...
2025-06-07 10:09:16,295 - DEBUG - Done
2025-06-07 10:09:16,296 - DEBUG - There are no more tasks to run at this time
2025-06-07 10:09:16,296 - INFO - Worker Worker(salt=3378034309, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) was stopped. Shutting down Keep-Alive thread
2025-06-07 10:09:16,302 - INFO - 
===== Luigi Execution Summary =====

Scheduled 3 tasks of which:
* 3 complete ones were encountered:
    - 1 Extract()
    - 1 Load()
    - 1 Transform()

Did not run any tasks
This progress looks :) because there were no failed tasks or missing dependencies

===== Luigi Execution Summary =====

2025-06-07 10:09:18,101 - INFO - logging already configured
2025-06-07 10:09:18,105 - DEBUG - Checking if Extract() is complete
2025-06-07 10:09:18,107 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2025-06-07 10:09:18,108 - DEBUG - Checking if Load() is complete
2025-06-07 10:09:18,111 - INFO - Informed scheduler that task   Load__99914b932b   has status   DONE
2025-06-07 10:09:18,111 - DEBUG - Checking if Transform() is complete
2025-06-07 10:09:18,113 - INFO - Informed scheduler that task   Transform__99914b932b   has status   DONE
2025-06-07 10:09:18,114 - INFO - Done scheduling tasks
2025-06-07 10:09:18,116 - INFO - Running Worker with 1 processes
2025-06-07 10:09:18,117 - DEBUG - Asking scheduler for work...
2025-06-07 10:09:18,119 - DEBUG - Done
2025-06-07 10:09:18,121 - DEBUG - There are no more tasks to run at this time
2025-06-07 10:09:18,122 - INFO - Worker Worker(salt=7618806619, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) was stopped. Shutting down Keep-Alive thread
2025-06-07 10:09:18,127 - INFO - 
===== Luigi Execution Summary =====

Scheduled 3 tasks of which:
* 3 complete ones were encountered:
    - 1 Extract()
    - 1 Load()
    - 1 Transform()

Did not run any tasks
This progress looks :) because there were no failed tasks or missing dependencies

===== Luigi Execution Summary =====

2025-06-07 10:09:18,685 - INFO - logging already configured
2025-06-07 10:09:18,689 - DEBUG - Checking if Extract() is complete
2025-06-07 10:09:18,693 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2025-06-07 10:09:18,694 - DEBUG - Checking if Load() is complete
2025-06-07 10:09:18,696 - INFO - Informed scheduler that task   Load__99914b932b   has status   DONE
2025-06-07 10:09:18,697 - DEBUG - Checking if Transform() is complete
2025-06-07 10:09:18,699 - INFO - Informed scheduler that task   Transform__99914b932b   has status   DONE
2025-06-07 10:09:18,700 - INFO - Done scheduling tasks
2025-06-07 10:09:18,701 - INFO - Running Worker with 1 processes
2025-06-07 10:09:18,702 - DEBUG - Asking scheduler for work...
2025-06-07 10:09:18,703 - DEBUG - Done
2025-06-07 10:09:18,704 - DEBUG - There are no more tasks to run at this time
2025-06-07 10:09:18,705 - INFO - Worker Worker(salt=3468135164, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) was stopped. Shutting down Keep-Alive thread
2025-06-07 10:09:18,712 - INFO - 
===== Luigi Execution Summary =====

Scheduled 3 tasks of which:
* 3 complete ones were encountered:
    - 1 Extract()
    - 1 Load()
    - 1 Transform()

Did not run any tasks
This progress looks :) because there were no failed tasks or missing dependencies

===== Luigi Execution Summary =====

2025-06-07 10:09:18,870 - INFO - logging already configured
2025-06-07 10:09:18,873 - DEBUG - Checking if Extract() is complete
2025-06-07 10:09:18,875 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2025-06-07 10:09:18,876 - DEBUG - Checking if Load() is complete
2025-06-07 10:09:18,878 - INFO - Informed scheduler that task   Load__99914b932b   has status   DONE
2025-06-07 10:09:18,879 - DEBUG - Checking if Transform() is complete
2025-06-07 10:09:18,882 - INFO - Informed scheduler that task   Transform__99914b932b   has status   DONE
2025-06-07 10:09:18,884 - INFO - Done scheduling tasks
2025-06-07 10:09:18,885 - INFO - Running Worker with 1 processes
2025-06-07 10:09:18,886 - DEBUG - Asking scheduler for work...
2025-06-07 10:09:18,887 - DEBUG - Done
2025-06-07 10:09:18,889 - DEBUG - There are no more tasks to run at this time
2025-06-07 10:09:18,890 - INFO - Worker Worker(salt=5664044077, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) was stopped. Shutting down Keep-Alive thread
2025-06-07 10:09:18,896 - INFO - 
===== Luigi Execution Summary =====

Scheduled 3 tasks of which:
* 3 complete ones were encountered:
    - 1 Extract()
    - 1 Load()
    - 1 Transform()

Did not run any tasks
This progress looks :) because there were no failed tasks or missing dependencies

===== Luigi Execution Summary =====

2025-06-07 10:09:19,499 - INFO - logging already configured
2025-06-07 10:09:19,514 - DEBUG - Checking if Extract() is complete
2025-06-07 10:09:19,519 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2025-06-07 10:09:19,520 - DEBUG - Checking if Load() is complete
2025-06-07 10:09:19,523 - INFO - Informed scheduler that task   Load__99914b932b   has status   DONE
2025-06-07 10:09:19,525 - DEBUG - Checking if Transform() is complete
2025-06-07 10:09:19,528 - INFO - Informed scheduler that task   Transform__99914b932b   has status   DONE
2025-06-07 10:09:19,529 - INFO - Done scheduling tasks
2025-06-07 10:09:19,532 - INFO - Running Worker with 1 processes
2025-06-07 10:09:19,534 - DEBUG - Asking scheduler for work...
2025-06-07 10:09:19,536 - DEBUG - Done
2025-06-07 10:09:19,537 - DEBUG - There are no more tasks to run at this time
2025-06-07 10:09:19,539 - INFO - Worker Worker(salt=2251882585, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) was stopped. Shutting down Keep-Alive thread
2025-06-07 10:09:19,544 - INFO - 
===== Luigi Execution Summary =====

Scheduled 3 tasks of which:
* 3 complete ones were encountered:
    - 1 Extract()
    - 1 Load()
    - 1 Transform()

Did not run any tasks
This progress looks :) because there were no failed tasks or missing dependencies

===== Luigi Execution Summary =====

2025-06-07 10:10:19,615 - INFO - logging already configured
2025-06-07 10:10:19,619 - DEBUG - Checking if Extract() is complete
2025-06-07 10:10:19,622 - INFO - Informed scheduler that task   Extract__99914b932b   has status   PENDING
2025-06-07 10:10:19,623 - INFO - Done scheduling tasks
2025-06-07 10:10:19,625 - INFO - Running Worker with 1 processes
2025-06-07 10:10:19,625 - DEBUG - Asking scheduler for work...
2025-06-07 10:10:19,626 - DEBUG - Pending tasks: 1
2025-06-07 10:10:19,629 - INFO - [pid 19900] Worker Worker(salt=2122684179, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) running   Extract()
2025-06-07 10:10:19,631 - INFO - ==================================STARTING EXTRACT DATA=======================================
2025-06-07 10:10:20,087 - INFO - EXTRACT 'public.geolocation' - SUCCESS.
2025-06-07 10:10:20,102 - INFO - EXTRACT 'public.product_category_name_translation' - SUCCESS.
2025-06-07 10:10:20,119 - INFO - EXTRACT 'public.sellers' - SUCCESS.
2025-06-07 10:10:21,137 - INFO - EXTRACT 'public.customers' - SUCCESS.
2025-06-07 10:10:21,620 - INFO - EXTRACT 'public.products' - SUCCESS.
2025-06-07 10:10:22,881 - INFO - EXTRACT 'public.orders' - SUCCESS.
2025-06-07 10:10:24,248 - INFO - EXTRACT 'public.order_items' - SUCCESS.
2025-06-07 10:10:25,464 - INFO - EXTRACT 'public.order_payments' - SUCCESS.
2025-06-07 10:10:26,519 - INFO - EXTRACT 'public.order_reviews' - SUCCESS.
2025-06-07 10:10:26,519 - INFO - Extract All Tables From Sources - SUCCESS
2025-06-07 10:10:26,521 - INFO - ==================================ENDING EXTRACT DATA=======================================
2025-06-07 10:10:26,538 - INFO - [pid 19900] Worker Worker(salt=2122684179, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) done      Extract()
2025-06-07 10:10:26,541 - DEBUG - 1 running tasks, waiting for next task to finish
2025-06-07 10:10:26,544 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2025-06-07 10:10:26,545 - DEBUG - Asking scheduler for work...
2025-06-07 10:10:26,546 - DEBUG - Done
2025-06-07 10:10:26,548 - DEBUG - There are no more tasks to run at this time
2025-06-07 10:10:26,549 - INFO - Worker Worker(salt=2122684179, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) was stopped. Shutting down Keep-Alive thread
2025-06-07 10:10:26,555 - INFO - 
===== Luigi Execution Summary =====

Scheduled 1 tasks of which:
* 1 ran successfully:
    - 1 Extract()

This progress looks :) because there were no failed tasks or missing dependencies

===== Luigi Execution Summary =====

2025-06-07 10:10:31,580 - INFO - logging already configured
2025-06-07 10:10:31,582 - DEBUG - Checking if Extract() is complete
2025-06-07 10:10:31,585 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2025-06-07 10:10:31,587 - DEBUG - Checking if Load() is complete
2025-06-07 10:10:31,588 - DEBUG - Checking if Extract() is complete
2025-06-07 10:10:31,590 - INFO - Informed scheduler that task   Load__99914b932b   has status   PENDING
2025-06-07 10:10:31,591 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2025-06-07 10:10:31,593 - INFO - Done scheduling tasks
2025-06-07 10:10:31,593 - INFO - Running Worker with 1 processes
2025-06-07 10:10:31,595 - DEBUG - Asking scheduler for work...
2025-06-07 10:10:31,596 - DEBUG - Pending tasks: 1
2025-06-07 10:10:31,598 - INFO - [pid 19900] Worker Worker(salt=6365795857, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) running   Load()
2025-06-07 10:10:31,602 - INFO - Read Load Query - SUCCESS
2025-06-07 10:10:33,553 - INFO - Read Extracted Data - SUCCESS
2025-06-07 10:10:33,553 - INFO - Connect to olist-dwh - SUCCESS
2025-06-07 10:10:33,747 - INFO - Truncate `public` Schema in olist-dwh - SUCCESS
2025-06-07 10:10:33,747 - INFO - ==================================STARTING LOAD DATA=======================================
2025-06-07 10:11:16,771 - INFO - LOAD All Tables To olist-dwh-public - SUCCESS
2025-06-07 10:11:23,102 - INFO - LOAD All Tables To DWH-Staging - SUCCESS
2025-06-07 10:11:23,106 - INFO - ==================================ENDING LOAD DATA=======================================
2025-06-07 10:11:23,155 - INFO - [pid 19900] Worker Worker(salt=6365795857, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) done      Load()
2025-06-07 10:11:23,158 - DEBUG - 1 running tasks, waiting for next task to finish
2025-06-07 10:11:23,161 - INFO - Informed scheduler that task   Load__99914b932b   has status   DONE
2025-06-07 10:11:23,164 - DEBUG - Asking scheduler for work...
2025-06-07 10:11:23,166 - DEBUG - Done
2025-06-07 10:11:23,168 - DEBUG - There are no more tasks to run at this time
2025-06-07 10:11:23,170 - INFO - Worker Worker(salt=6365795857, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) was stopped. Shutting down Keep-Alive thread
2025-06-07 10:11:23,181 - INFO - 
===== Luigi Execution Summary =====

Scheduled 2 tasks of which:
* 1 complete ones were encountered:
    - 1 Extract()
* 1 ran successfully:
    - 1 Load()

This progress looks :) because there were no failed tasks or missing dependencies

===== Luigi Execution Summary =====

2025-06-07 10:11:34,891 - INFO - logging already configured
2025-06-07 10:11:34,893 - DEBUG - Checking if Extract() is complete
2025-06-07 10:11:34,898 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2025-06-07 10:11:34,898 - DEBUG - Checking if Load() is complete
2025-06-07 10:11:34,902 - INFO - Informed scheduler that task   Load__99914b932b   has status   DONE
2025-06-07 10:11:34,902 - DEBUG - Checking if Transform() is complete
2025-06-07 10:11:34,907 - DEBUG - Checking if Load() is complete
2025-06-07 10:11:34,907 - INFO - Informed scheduler that task   Transform__99914b932b   has status   PENDING
2025-06-07 10:11:34,907 - INFO - Informed scheduler that task   Load__99914b932b   has status   DONE
2025-06-07 10:11:34,912 - INFO - Done scheduling tasks
2025-06-07 10:11:34,912 - INFO - Running Worker with 1 processes
2025-06-07 10:11:34,912 - DEBUG - Asking scheduler for work...
2025-06-07 10:11:34,915 - DEBUG - Pending tasks: 1
2025-06-07 10:11:34,915 - INFO - [pid 19900] Worker Worker(salt=4387478804, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) running   Transform()
2025-06-07 10:11:34,915 - INFO - Connect to DWH - SUCCESS
2025-06-07 10:11:34,924 - INFO - Read Transform Query - SUCCESS
2025-06-07 10:11:34,924 - INFO - ==================================STARTING TRANSFROM DATA=======================================
2025-06-07 10:11:35,245 - INFO - Transform to 'dwh.dim_geolocation' - SUCCESS
2025-06-07 10:11:35,252 - INFO - Transform to 'dwh.dim_product_category' - SUCCESS
2025-06-07 10:11:35,333 - INFO - Transform to 'dwh.dim_sellers' - SUCCESS
2025-06-07 10:11:36,552 - INFO - Transform to 'dwh.dim_customers' - SUCCESS
2025-06-07 10:11:37,025 - INFO - Transform to 'dwh.dim_products' - SUCCESS
2025-06-07 10:11:37,787 - INFO - Transform to 'dwh.fact_orders_comprehensive' - SUCCESS
2025-06-07 10:11:37,791 - INFO - Transform to 'dwh.fact_reviews_sentiment' - SUCCESS
2025-06-07 10:11:37,820 - ERROR - Transform to All Dimensions and Fact Tables - FAILED
2025-06-07 10:11:37,823 - ERROR - Transform Tables - FAILED
2025-06-07 10:11:37,823 - ERROR - [pid 19900] Worker Worker(salt=4387478804, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) failed    Transform()
Traceback (most recent call last):
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.GroupingError: column "dd.date_only" must appear in the GROUP BY clause or be used in an aggregate function
LINE 16:     dd.date_only AS order_date,
             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\LENOVO THINKPAD\AppData\Local\Temp\ipykernel_19900\4240733592.py", line 142, in run
    session.execute(query)
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\orm\session.py", line 2362, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\orm\session.py", line 2256, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1418, in execute
    return meth(
           ^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\sql\elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.GroupingError) column "dd.date_only" must appear in the GROUP BY clause or be used in an aggregate function
LINE 16:     dd.date_only AS order_date,
             ^

[SQL: INSERT INTO dwh.daily_periodical_snapshot_order_trends (
    order_date,
    year_day,
    year_week,
    year_month,
    year_quarter,
    year_semester,
    distinct_customer_count,
    distinct_seller_count,
    order_id_count,
    product_id_count,
    sum_price,
    sum_freight_value
)
SELECT
    dd.date_only AS order_date,
    dd.year_day,
    dd.year_week,
    dd.year_month,
    dd.year_quarter,
    dd.year_semester,

    COUNT(DISTINCT o.customer_id) AS distinct_customer_count,
    COUNT(DISTINCT oi.seller_id) AS distinct_seller_count,
    COUNT(DISTINCT o.order_id) AS order_id_count,
    COUNT(DISTINCT oi.product_id) AS product_id_count,
    SUM(oi.price) AS sum_price,
    SUM(oi.freight_value) AS sum_freight_value

FROM stg.orders o
JOIN stg.order_items oi ON oi.order_id = o.order_id
JOIN dwh.dim_date dd ON dd.full_date = TO_TIMESTAMP(o.order_approved_at, 'YYYY-MM-DD HH24:MI:SS')::DATE

-- Optional: avoid duplicate snapshot inserts
LEFT JOIN dwh.daily_periodical_snapshot_order_trends EXISTING
    ON existing.order_date = dd.full_date
WHERE o.order_approved_at IS NOT NULL
  AND existing.order_date IS NULL

GROUP BY
    dd.full_date,
    dd.year_day,
    dd.year_week,
    dd.year_month,
    dd.year_quarter,
    dd.year_semester;
]
(Background on this error at: https://sqlalche.me/e/20/f405)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 210, in run
    new_deps = self._run_get_new_deps()
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 138, in _run_get_new_deps
    task_gen = self.task.run()
               ^^^^^^^^^^^^^^^
  File "C:\Users\LENOVO THINKPAD\AppData\Local\Temp\ipykernel_19900\4240733592.py", line 193, in run
    raise Exception('Failed Transforming Tables')
Exception: Failed Transforming Tables
2025-06-07 10:11:37,832 - DEBUG - 1 running tasks, waiting for next task to finish
2025-06-07 10:11:37,842 - INFO - Informed scheduler that task   Transform__99914b932b   has status   FAILED
2025-06-07 10:11:37,844 - DEBUG - Asking scheduler for work...
2025-06-07 10:11:37,846 - DEBUG - Done
2025-06-07 10:11:37,848 - DEBUG - There are no more tasks to run at this time
2025-06-07 10:11:37,850 - DEBUG - There are 1 pending tasks possibly being run by other workers
2025-06-07 10:11:37,851 - DEBUG - There are 1 pending tasks unique to this worker
2025-06-07 10:11:37,854 - DEBUG - There are 1 pending tasks last scheduled by this worker
2025-06-07 10:11:37,856 - INFO - Worker Worker(salt=4387478804, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) was stopped. Shutting down Keep-Alive thread
2025-06-07 10:11:37,863 - INFO - 
===== Luigi Execution Summary =====

Scheduled 3 tasks of which:
* 2 complete ones were encountered:
    - 1 Extract()
    - 1 Load()
* 1 failed:
    - 1 Transform()

This progress looks :( because there were failed tasks

===== Luigi Execution Summary =====

2025-06-07 10:12:34,104 - INFO - logging already configured
2025-06-07 10:12:34,107 - DEBUG - Checking if Extract() is complete
2025-06-07 10:12:34,110 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2025-06-07 10:12:34,111 - INFO - Done scheduling tasks
2025-06-07 10:12:34,112 - INFO - Running Worker with 1 processes
2025-06-07 10:12:34,112 - DEBUG - Asking scheduler for work...
2025-06-07 10:12:34,114 - DEBUG - Done
2025-06-07 10:12:34,115 - DEBUG - There are no more tasks to run at this time
2025-06-07 10:12:34,117 - INFO - Worker Worker(salt=5007949406, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) was stopped. Shutting down Keep-Alive thread
2025-06-07 10:12:34,121 - INFO - 
===== Luigi Execution Summary =====

Scheduled 1 tasks of which:
* 1 complete ones were encountered:
    - 1 Extract()

Did not run any tasks
This progress looks :) because there were no failed tasks or missing dependencies

===== Luigi Execution Summary =====

2025-06-07 10:12:50,693 - INFO - logging already configured
2025-06-07 10:12:50,698 - DEBUG - Checking if Extract() is complete
2025-06-07 10:12:50,700 - INFO - Informed scheduler that task   Extract__99914b932b   has status   PENDING
2025-06-07 10:12:50,701 - INFO - Done scheduling tasks
2025-06-07 10:12:50,702 - INFO - Running Worker with 1 processes
2025-06-07 10:12:50,704 - DEBUG - Asking scheduler for work...
2025-06-07 10:12:50,705 - DEBUG - Pending tasks: 1
2025-06-07 10:12:50,706 - INFO - [pid 19900] Worker Worker(salt=1912601154, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) running   Extract()
2025-06-07 10:12:50,709 - INFO - ==================================STARTING EXTRACT DATA=======================================
2025-06-07 10:12:51,028 - INFO - EXTRACT 'public.geolocation' - SUCCESS.
2025-06-07 10:12:51,040 - INFO - EXTRACT 'public.product_category_name_translation' - SUCCESS.
2025-06-07 10:12:51,074 - INFO - EXTRACT 'public.sellers' - SUCCESS.
2025-06-07 10:12:52,098 - INFO - EXTRACT 'public.customers' - SUCCESS.
2025-06-07 10:12:52,643 - INFO - EXTRACT 'public.products' - SUCCESS.
2025-06-07 10:12:53,854 - INFO - EXTRACT 'public.orders' - SUCCESS.
2025-06-07 10:12:55,423 - INFO - EXTRACT 'public.order_items' - SUCCESS.
2025-06-07 10:12:56,363 - INFO - EXTRACT 'public.order_payments' - SUCCESS.
2025-06-07 10:12:57,463 - INFO - EXTRACT 'public.order_reviews' - SUCCESS.
2025-06-07 10:12:57,463 - INFO - Extract All Tables From Sources - SUCCESS
2025-06-07 10:12:57,466 - INFO - ==================================ENDING EXTRACT DATA=======================================
2025-06-07 10:12:57,488 - INFO - [pid 19900] Worker Worker(salt=1912601154, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) done      Extract()
2025-06-07 10:12:57,491 - DEBUG - 1 running tasks, waiting for next task to finish
2025-06-07 10:12:57,492 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2025-06-07 10:12:57,493 - DEBUG - Asking scheduler for work...
2025-06-07 10:12:57,496 - DEBUG - Done
2025-06-07 10:12:57,498 - DEBUG - There are no more tasks to run at this time
2025-06-07 10:12:57,499 - INFO - Worker Worker(salt=1912601154, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) was stopped. Shutting down Keep-Alive thread
2025-06-07 10:12:57,504 - INFO - 
===== Luigi Execution Summary =====

Scheduled 1 tasks of which:
* 1 ran successfully:
    - 1 Extract()

This progress looks :) because there were no failed tasks or missing dependencies

===== Luigi Execution Summary =====

2025-06-07 10:13:02,606 - INFO - logging already configured
2025-06-07 10:13:02,614 - DEBUG - Checking if Extract() is complete
2025-06-07 10:13:02,617 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2025-06-07 10:13:02,617 - DEBUG - Checking if Load() is complete
2025-06-07 10:13:02,620 - DEBUG - Checking if Extract() is complete
2025-06-07 10:13:02,623 - INFO - Informed scheduler that task   Load__99914b932b   has status   PENDING
2025-06-07 10:13:02,623 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2025-06-07 10:13:02,624 - INFO - Done scheduling tasks
2025-06-07 10:13:02,626 - INFO - Running Worker with 1 processes
2025-06-07 10:13:02,626 - DEBUG - Asking scheduler for work...
2025-06-07 10:13:02,627 - DEBUG - Pending tasks: 1
2025-06-07 10:13:02,629 - INFO - [pid 19900] Worker Worker(salt=6260164996, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) running   Load()
2025-06-07 10:13:02,633 - INFO - Read Load Query - SUCCESS
2025-06-07 10:13:04,698 - INFO - Read Extracted Data - SUCCESS
2025-06-07 10:13:04,699 - INFO - Connect to olist-dwh - SUCCESS
2025-06-07 10:13:04,935 - INFO - Truncate `public` Schema in olist-dwh - SUCCESS
2025-06-07 10:13:04,935 - INFO - ==================================STARTING LOAD DATA=======================================
2025-06-07 10:13:48,419 - INFO - LOAD All Tables To olist-dwh-public - SUCCESS
2025-06-07 10:13:54,798 - INFO - LOAD All Tables To DWH-Staging - SUCCESS
2025-06-07 10:13:54,801 - INFO - ==================================ENDING LOAD DATA=======================================
2025-06-07 10:13:54,846 - INFO - [pid 19900] Worker Worker(salt=6260164996, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) done      Load()
2025-06-07 10:13:54,849 - DEBUG - 1 running tasks, waiting for next task to finish
2025-06-07 10:13:54,851 - INFO - Informed scheduler that task   Load__99914b932b   has status   DONE
2025-06-07 10:13:54,853 - DEBUG - Asking scheduler for work...
2025-06-07 10:13:54,855 - DEBUG - Done
2025-06-07 10:13:54,856 - DEBUG - There are no more tasks to run at this time
2025-06-07 10:13:54,858 - INFO - Worker Worker(salt=6260164996, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) was stopped. Shutting down Keep-Alive thread
2025-06-07 10:13:54,863 - INFO - 
===== Luigi Execution Summary =====

Scheduled 2 tasks of which:
* 1 complete ones were encountered:
    - 1 Extract()
* 1 ran successfully:
    - 1 Load()

This progress looks :) because there were no failed tasks or missing dependencies

===== Luigi Execution Summary =====

2025-06-07 10:14:07,768 - INFO - logging already configured
2025-06-07 10:14:07,771 - DEBUG - Checking if Extract() is complete
2025-06-07 10:14:07,774 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2025-06-07 10:14:07,775 - DEBUG - Checking if Load() is complete
2025-06-07 10:14:07,777 - INFO - Informed scheduler that task   Load__99914b932b   has status   DONE
2025-06-07 10:14:07,778 - DEBUG - Checking if Transform() is complete
2025-06-07 10:14:07,781 - DEBUG - Checking if Load() is complete
2025-06-07 10:14:07,782 - INFO - Informed scheduler that task   Transform__99914b932b   has status   PENDING
2025-06-07 10:14:07,784 - INFO - Informed scheduler that task   Load__99914b932b   has status   DONE
2025-06-07 10:14:07,785 - INFO - Done scheduling tasks
2025-06-07 10:14:07,786 - INFO - Running Worker with 1 processes
2025-06-07 10:14:07,787 - DEBUG - Asking scheduler for work...
2025-06-07 10:14:07,788 - DEBUG - Pending tasks: 1
2025-06-07 10:14:07,789 - INFO - [pid 19900] Worker Worker(salt=9506182906, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) running   Transform()
2025-06-07 10:14:07,794 - INFO - Connect to DWH - SUCCESS
2025-06-07 10:14:07,828 - INFO - Read Transform Query - SUCCESS
2025-06-07 10:14:07,828 - INFO - ==================================STARTING TRANSFROM DATA=======================================
2025-06-07 10:14:08,154 - INFO - Transform to 'dwh.dim_geolocation' - SUCCESS
2025-06-07 10:14:08,160 - INFO - Transform to 'dwh.dim_product_category' - SUCCESS
2025-06-07 10:14:08,212 - INFO - Transform to 'dwh.dim_sellers' - SUCCESS
2025-06-07 10:14:09,475 - INFO - Transform to 'dwh.dim_customers' - SUCCESS
2025-06-07 10:14:09,969 - INFO - Transform to 'dwh.dim_products' - SUCCESS
2025-06-07 10:14:10,896 - INFO - Transform to 'dwh.fact_orders_comprehensive' - SUCCESS
2025-06-07 10:14:10,901 - INFO - Transform to 'dwh.fact_reviews_sentiment' - SUCCESS
2025-06-07 10:14:10,906 - INFO - Transform to 'dwh.fact_daily_periodicals_order_trends' - SUCCESS
2025-06-07 10:14:16,272 - ERROR - Transform to All Dimensions and Fact Tables - FAILED
2025-06-07 10:14:16,272 - ERROR - Transform Tables - FAILED
2025-06-07 10:14:16,272 - ERROR - [pid 19900] Worker Worker(salt=9506182906, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) failed    Transform()
Traceback (most recent call last):
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UniqueViolation: duplicate key value violates unique constraint "accumulating_snapshot_logistic_performance_pkey"
DETAIL:  Key (order_id)=(679d507d-acd3-5ecf-587d-994177d06871) already exists.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\LENOVO THINKPAD\AppData\Local\Temp\ipykernel_19900\4240733592.py", line 146, in run
    session.execute(query)
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\orm\session.py", line 2362, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\orm\session.py", line 2256, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1418, in execute
    return meth(
           ^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\sql\elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "accumulating_snapshot_logistic_performance_pkey"
DETAIL:  Key (order_id)=(679d507d-acd3-5ecf-587d-994177d06871) already exists.

[SQL: INSERT INTO dwh.accumulating_snapshot_logistic_performance (
    order_id,
    product_sk,
    seller_sk,
    customer_sk,
    order_purchase_timestamp,
    order_approved_at,
    purchase_approve_difference,
    order_estimated_delivery_date,
    order_shipping_limit_date,
    order_delivered_carrier_date,
    order_delivered_customer_date,
    approved_carrier_difference,
    approved_delivered_difference,
    order_purchase_date_id,
    order_delivered_date_id,
    last_updated,
    order_status_code
)

SELECT
    o.order_id::UUID,

    dp.product_sk,
    ds.seller_sk,
    dc.customer_sk,

    TO_TIMESTAMP(o.order_purchase_timestamp, 'YYYY-MM-DD HH24:MI:SS') AS order_purchase_ts,
    TO_TIMESTAMP(o.order_approved_at, 'YYYY-MM-DD HH24:MI:SS') AS approved_ts,

    CASE 
        WHEN o.order_approved_at IS NOT NULL 
        THEN TO_TIMESTAMP(o.order_approved_at, 'YYYY-MM-DD HH24:MI:SS') - TO_TIMESTAMP(o.order_purchase_timestamp, 'YYYY-MM-DD HH24:MI:SS')
        ELSE NULL
    END AS purchase_approve_diff,

    TO_TIMESTAMP(o.order_estimated_delivery_date, 'YYYY-MM-DD') AS estimated_delivery,
    TO_TIMESTAMP(oi.shipping_limit_date, 'YYYY-MM-DD HH24:MI:SS') AS shipping_limit,
    TO_TIMESTAMP(o.order_delivered_carrier_date, 'YYYY-MM-DD HH24:MI:SS') AS delivered_carrier,
    TO_TIMESTAMP(o.order_delivered_customer_date, 'YYYY-MM-DD HH24:MI:SS') AS delivered_customer,

    CASE 
        WHEN o.order_delivered_carrier_date IS NOT NULL AND o.order_approved_at IS NOT NULL
        THEN TO_TIMESTAMP(o.order_delivered_carrier_date, 'YYYY-MM-DD HH24:MI:SS') - TO_TIMESTAMP(o.order_approved_at, 'YYYY-MM-DD HH24:MI:SS')
        ELSE NULL
    END AS approved_carrier_diff,

    CASE 
        WHEN o.order_delivered_customer_date IS NOT NULL AND o.order_approved_at IS NOT NULL
        THEN TO_TIMESTAMP(o.order_delivered_customer_date, 'YYYY-MM-DD HH24:MI:SS') - TO_TIMESTAMP(o.order_approved_at, 'YYYY-MM-DD HH24:MI:SS')
        ELSE NULL
    END AS approved_delivered_diff,

    dd_order.date_id AS order_purchase_date_id,
    dd_delivered.date_id AS order_delivered_date_id,

    NOW() AS last_updated,

    o.order_status AS order_status_code

FROM stg.orders o
JOIN stg.order_items oi ON o.order_id = oi.order_id

-- Dimension lookups with SCD type 2 handling
JOIN dwh.dim_customers dc ON o.customer_id = dc.customer_id AND dc.is_current = TRUE
JOIN dwh.dim_sellers ds ON oi.seller_id = ds.seller_id AND ds.is_current = TRUE
JOIN dwh.dim_products dp ON oi.product_id = dp.product_id

-- Dates
LEFT JOIN dwh.dim_date dd_order ON dd_order.full_date = TO_DATE(o.order_purchase_timestamp, 'YYYY-MM-DD')
LEFT JOIN dwh.dim_date dd_delivered ON dd_delivered.full_date = TO_DATE(o.order_delivered_customer_date, 'YYYY-MM-DD')

-- Only if order_purchase_timestamp is present
WHERE o.order_purchase_timestamp IS NOT NULL;
]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 210, in run
    new_deps = self._run_get_new_deps()
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 138, in _run_get_new_deps
    task_gen = self.task.run()
               ^^^^^^^^^^^^^^^
  File "C:\Users\LENOVO THINKPAD\AppData\Local\Temp\ipykernel_19900\4240733592.py", line 193, in run
    raise Exception('Failed Transforming Tables')
Exception: Failed Transforming Tables
2025-06-07 10:14:16,283 - DEBUG - 1 running tasks, waiting for next task to finish
2025-06-07 10:14:16,293 - INFO - Informed scheduler that task   Transform__99914b932b   has status   FAILED
2025-06-07 10:14:16,295 - DEBUG - Asking scheduler for work...
2025-06-07 10:14:16,298 - DEBUG - Done
2025-06-07 10:14:16,298 - DEBUG - There are no more tasks to run at this time
2025-06-07 10:14:16,298 - DEBUG - There are 1 pending tasks possibly being run by other workers
2025-06-07 10:14:16,298 - DEBUG - There are 1 pending tasks unique to this worker
2025-06-07 10:14:16,303 - DEBUG - There are 1 pending tasks last scheduled by this worker
2025-06-07 10:14:16,304 - INFO - Worker Worker(salt=9506182906, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) was stopped. Shutting down Keep-Alive thread
2025-06-07 10:14:16,308 - INFO - 
===== Luigi Execution Summary =====

Scheduled 3 tasks of which:
* 2 complete ones were encountered:
    - 1 Extract()
    - 1 Load()
* 1 failed:
    - 1 Transform()

This progress looks :( because there were failed tasks

===== Luigi Execution Summary =====

2025-06-07 10:14:54,289 - INFO - logging already configured
2025-06-07 10:14:54,293 - DEBUG - Checking if Extract() is complete
2025-06-07 10:14:54,296 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2025-06-07 10:14:54,297 - DEBUG - Checking if Load() is complete
2025-06-07 10:14:54,300 - INFO - Informed scheduler that task   Load__99914b932b   has status   DONE
2025-06-07 10:14:54,301 - DEBUG - Checking if Transform() is complete
2025-06-07 10:14:54,303 - DEBUG - Checking if Load() is complete
2025-06-07 10:14:54,305 - INFO - Informed scheduler that task   Transform__99914b932b   has status   PENDING
2025-06-07 10:14:54,307 - INFO - Informed scheduler that task   Load__99914b932b   has status   DONE
2025-06-07 10:14:54,308 - INFO - Done scheduling tasks
2025-06-07 10:14:54,309 - INFO - Running Worker with 1 processes
2025-06-07 10:14:54,310 - DEBUG - Asking scheduler for work...
2025-06-07 10:14:54,312 - DEBUG - Pending tasks: 1
2025-06-07 10:14:54,315 - INFO - [pid 19900] Worker Worker(salt=6636379678, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) running   Transform()
2025-06-07 10:14:54,317 - INFO - Connect to DWH - SUCCESS
2025-06-07 10:14:54,320 - INFO - Read Transform Query - SUCCESS
2025-06-07 10:14:54,320 - INFO - ==================================STARTING TRANSFROM DATA=======================================
2025-06-07 10:14:54,556 - INFO - Transform to 'dwh.dim_geolocation' - SUCCESS
2025-06-07 10:14:54,561 - INFO - Transform to 'dwh.dim_product_category' - SUCCESS
2025-06-07 10:14:54,595 - INFO - Transform to 'dwh.dim_sellers' - SUCCESS
2025-06-07 10:14:56,147 - INFO - Transform to 'dwh.dim_customers' - SUCCESS
2025-06-07 10:14:56,648 - INFO - Transform to 'dwh.dim_products' - SUCCESS
2025-06-07 10:14:57,443 - INFO - Transform to 'dwh.fact_orders_comprehensive' - SUCCESS
2025-06-07 10:14:57,446 - INFO - Transform to 'dwh.fact_reviews_sentiment' - SUCCESS
2025-06-07 10:14:57,451 - INFO - Transform to 'dwh.fact_daily_periodicals_order_trends' - SUCCESS
2025-06-07 10:15:05,262 - ERROR - Transform to All Dimensions and Fact Tables - FAILED
2025-06-07 10:15:05,266 - ERROR - Transform Tables - FAILED
2025-06-07 10:15:05,266 - ERROR - [pid 19900] Worker Worker(salt=6636379678, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) failed    Transform()
Traceback (most recent call last):
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UniqueViolation: duplicate key value violates unique constraint "accumulating_snapshot_logistic_performance_pkey"
DETAIL:  Key (order_id)=(f30149f4-a888-2a08-895b-6a242aa0d612) already exists.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\LENOVO THINKPAD\AppData\Local\Temp\ipykernel_19900\4240733592.py", line 146, in run
    session.execute(query)
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\orm\session.py", line 2362, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\orm\session.py", line 2256, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1418, in execute
    return meth(
           ^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\sql\elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "accumulating_snapshot_logistic_performance_pkey"
DETAIL:  Key (order_id)=(f30149f4-a888-2a08-895b-6a242aa0d612) already exists.

[SQL: INSERT INTO dwh.accumulating_snapshot_logistic_performance (
    order_id,
    product_sk,
    seller_sk,
    customer_sk,
    order_purchase_timestamp,
    order_approved_at,
    purchase_approve_difference,
    order_estimated_delivery_date,
    order_shipping_limit_date,
    order_delivered_carrier_date,
    order_delivered_customer_date,
    approved_carrier_difference,
    approved_delivered_difference,
    order_purchase_date_id,
    order_delivered_date_id,
    last_updated,
    order_status_code
)

SELECT
    o.order_id::UUID,

    dp.product_sk,
    ds.seller_sk,
    dc.customer_sk,

    TO_TIMESTAMP(o.order_purchase_timestamp, 'YYYY-MM-DD HH24:MI:SS') AS order_purchase_ts,
    TO_TIMESTAMP(o.order_approved_at, 'YYYY-MM-DD HH24:MI:SS') AS approved_ts,

    CASE 
        WHEN o.order_approved_at IS NOT NULL 
        THEN TO_TIMESTAMP(o.order_approved_at, 'YYYY-MM-DD HH24:MI:SS') - TO_TIMESTAMP(o.order_purchase_timestamp, 'YYYY-MM-DD HH24:MI:SS')
        ELSE NULL
    END AS purchase_approve_diff,

    TO_TIMESTAMP(o.order_estimated_delivery_date, 'YYYY-MM-DD') AS estimated_delivery,
    TO_TIMESTAMP(oi.shipping_limit_date, 'YYYY-MM-DD HH24:MI:SS') AS shipping_limit,
    TO_TIMESTAMP(o.order_delivered_carrier_date, 'YYYY-MM-DD HH24:MI:SS') AS delivered_carrier,
    TO_TIMESTAMP(o.order_delivered_customer_date, 'YYYY-MM-DD HH24:MI:SS') AS delivered_customer,

    CASE 
        WHEN o.order_delivered_carrier_date IS NOT NULL AND o.order_approved_at IS NOT NULL
        THEN TO_TIMESTAMP(o.order_delivered_carrier_date, 'YYYY-MM-DD HH24:MI:SS') - TO_TIMESTAMP(o.order_approved_at, 'YYYY-MM-DD HH24:MI:SS')
        ELSE NULL
    END AS approved_carrier_diff,

    CASE 
        WHEN o.order_delivered_customer_date IS NOT NULL AND o.order_approved_at IS NOT NULL
        THEN TO_TIMESTAMP(o.order_delivered_customer_date, 'YYYY-MM-DD HH24:MI:SS') - TO_TIMESTAMP(o.order_approved_at, 'YYYY-MM-DD HH24:MI:SS')
        ELSE NULL
    END AS approved_delivered_diff,

    dd_order.date_id AS order_purchase_date_id,
    dd_delivered.date_id AS order_delivered_date_id,

    NOW() AS last_updated,

    o.order_status AS order_status_code

FROM stg.orders o
JOIN stg.order_items oi ON o.order_id = oi.order_id

-- Dimension lookups with SCD type 2 handling
JOIN dwh.dim_customers dc ON o.customer_id = dc.customer_id AND dc.is_current = TRUE
JOIN dwh.dim_sellers ds ON oi.seller_id = ds.seller_id AND ds.is_current = TRUE
JOIN dwh.dim_products dp ON oi.product_id = dp.product_id

-- Dates
LEFT JOIN dwh.dim_date dd_order ON dd_order.full_date = TO_DATE(o.order_purchase_timestamp, 'YYYY-MM-DD')
LEFT JOIN dwh.dim_date dd_delivered ON dd_delivered.full_date = TO_DATE(o.order_delivered_customer_date, 'YYYY-MM-DD')

-- Only if order_purchase_timestamp is present
WHERE o.order_purchase_timestamp IS NOT NULL;
]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 210, in run
    new_deps = self._run_get_new_deps()
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 138, in _run_get_new_deps
    task_gen = self.task.run()
               ^^^^^^^^^^^^^^^
  File "C:\Users\LENOVO THINKPAD\AppData\Local\Temp\ipykernel_19900\4240733592.py", line 193, in run
    raise Exception('Failed Transforming Tables')
Exception: Failed Transforming Tables
2025-06-07 10:15:05,273 - DEBUG - 1 running tasks, waiting for next task to finish
2025-06-07 10:15:05,282 - INFO - Informed scheduler that task   Transform__99914b932b   has status   FAILED
2025-06-07 10:15:05,285 - DEBUG - Asking scheduler for work...
2025-06-07 10:15:05,286 - DEBUG - Done
2025-06-07 10:15:05,288 - DEBUG - There are no more tasks to run at this time
2025-06-07 10:15:05,289 - DEBUG - There are 1 pending tasks possibly being run by other workers
2025-06-07 10:15:05,290 - DEBUG - There are 1 pending tasks unique to this worker
2025-06-07 10:15:05,291 - DEBUG - There are 1 pending tasks last scheduled by this worker
2025-06-07 10:15:05,292 - INFO - Worker Worker(salt=6636379678, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) was stopped. Shutting down Keep-Alive thread
2025-06-07 10:15:05,299 - INFO - 
===== Luigi Execution Summary =====

Scheduled 3 tasks of which:
* 2 complete ones were encountered:
    - 1 Extract()
    - 1 Load()
* 1 failed:
    - 1 Transform()

This progress looks :( because there were failed tasks

===== Luigi Execution Summary =====

2025-06-07 11:59:30,848 - INFO - logging already configured
2025-06-07 11:59:30,852 - DEBUG - Checking if Extract() is complete
2025-06-07 11:59:30,854 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2025-06-07 11:59:30,855 - DEBUG - Checking if Load() is complete
2025-06-07 11:59:30,858 - INFO - Informed scheduler that task   Load__99914b932b   has status   DONE
2025-06-07 11:59:30,858 - DEBUG - Checking if Transform() is complete
2025-06-07 11:59:30,861 - DEBUG - Checking if Load() is complete
2025-06-07 11:59:30,863 - INFO - Informed scheduler that task   Transform__99914b932b   has status   PENDING
2025-06-07 11:59:30,864 - INFO - Informed scheduler that task   Load__99914b932b   has status   DONE
2025-06-07 11:59:30,864 - INFO - Done scheduling tasks
2025-06-07 11:59:30,866 - INFO - Running Worker with 1 processes
2025-06-07 11:59:30,866 - DEBUG - Asking scheduler for work...
2025-06-07 11:59:30,868 - DEBUG - Pending tasks: 1
2025-06-07 11:59:30,869 - INFO - [pid 19900] Worker Worker(salt=888497434, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) running   Transform()
2025-06-07 11:59:30,873 - INFO - Connect to DWH - SUCCESS
2025-06-07 11:59:30,901 - INFO - Read Transform Query - SUCCESS
2025-06-07 11:59:30,901 - INFO - ==================================STARTING TRANSFROM DATA=======================================
2025-06-07 11:59:31,000 - ERROR - Transform to All Dimensions and Fact Tables - FAILED
2025-06-07 11:59:31,007 - ERROR - Transform Tables - FAILED
2025-06-07 11:59:31,007 - ERROR - [pid 19900] Worker Worker(salt=888497434, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) failed    Transform()
Traceback (most recent call last):
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedTable: relation "dwh.dim_geolocation" does not exist
LINE 1: INSERT INTO dwh.dim_geolocation (
                    ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\LENOVO THINKPAD\AppData\Local\Temp\ipykernel_19900\4240733592.py", line 114, in run
    session.execute(query)
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\orm\session.py", line 2362, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\orm\session.py", line 2256, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1418, in execute
    return meth(
           ^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\sql\elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedTable) relation "dwh.dim_geolocation" does not exist
LINE 1: INSERT INTO dwh.dim_geolocation (
                    ^

[SQL: INSERT INTO dwh.dim_geolocation (
    geolocation_zip_code_prefix,
    geolocation_lat, geolocation_lng,
    geolocation_city, geolocation_state
)
SELECT geolocation_zip_code_prefix, 
  geolocation_lat, geolocation_lng, 
  geolocation_city, geolocation_state
FROM stg.geolocation
WHERE geolocation_zip_code_prefix IS NOT NULL
ON CONFLICT (geolocation_zip_code_prefix) DO NOTHING;]
(Background on this error at: https://sqlalche.me/e/20/f405)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 210, in run
    new_deps = self._run_get_new_deps()
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 138, in _run_get_new_deps
    task_gen = self.task.run()
               ^^^^^^^^^^^^^^^
  File "C:\Users\LENOVO THINKPAD\AppData\Local\Temp\ipykernel_19900\4240733592.py", line 193, in run
    raise Exception('Failed Transforming Tables')
Exception: Failed Transforming Tables
2025-06-07 11:59:31,016 - DEBUG - 1 running tasks, waiting for next task to finish
2025-06-07 11:59:31,022 - INFO - Informed scheduler that task   Transform__99914b932b   has status   FAILED
2025-06-07 11:59:31,023 - DEBUG - Asking scheduler for work...
2025-06-07 11:59:31,024 - DEBUG - Done
2025-06-07 11:59:31,025 - DEBUG - There are no more tasks to run at this time
2025-06-07 11:59:31,026 - DEBUG - There are 1 pending tasks possibly being run by other workers
2025-06-07 11:59:31,027 - DEBUG - There are 1 pending tasks unique to this worker
2025-06-07 11:59:31,028 - DEBUG - There are 1 pending tasks last scheduled by this worker
2025-06-07 11:59:31,030 - INFO - Worker Worker(salt=888497434, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) was stopped. Shutting down Keep-Alive thread
2025-06-07 11:59:31,036 - INFO - 
===== Luigi Execution Summary =====

Scheduled 3 tasks of which:
* 2 complete ones were encountered:
    - 1 Extract()
    - 1 Load()
* 1 failed:
    - 1 Transform()

This progress looks :( because there were failed tasks

===== Luigi Execution Summary =====

2025-06-07 11:59:39,566 - INFO - logging already configured
2025-06-07 11:59:39,572 - DEBUG - Checking if Extract() is complete
2025-06-07 11:59:39,573 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2025-06-07 11:59:39,575 - DEBUG - Checking if Load() is complete
2025-06-07 11:59:39,577 - INFO - Informed scheduler that task   Load__99914b932b   has status   DONE
2025-06-07 11:59:39,579 - DEBUG - Checking if Transform() is complete
2025-06-07 11:59:39,580 - INFO - Informed scheduler that task   Transform__99914b932b   has status   DONE
2025-06-07 11:59:39,581 - INFO - Done scheduling tasks
2025-06-07 11:59:39,583 - INFO - Running Worker with 1 processes
2025-06-07 11:59:39,584 - DEBUG - Asking scheduler for work...
2025-06-07 11:59:39,584 - DEBUG - Done
2025-06-07 11:59:39,586 - DEBUG - There are no more tasks to run at this time
2025-06-07 11:59:39,588 - INFO - Worker Worker(salt=1754733891, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) was stopped. Shutting down Keep-Alive thread
2025-06-07 11:59:39,591 - INFO - 
===== Luigi Execution Summary =====

Scheduled 3 tasks of which:
* 3 complete ones were encountered:
    - 1 Extract()
    - 1 Load()
    - 1 Transform()

Did not run any tasks
This progress looks :) because there were no failed tasks or missing dependencies

===== Luigi Execution Summary =====

2025-06-07 11:59:53,679 - INFO - logging already configured
2025-06-07 11:59:53,684 - DEBUG - Checking if Extract() is complete
2025-06-07 11:59:53,687 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2025-06-07 11:59:53,689 - DEBUG - Checking if Load() is complete
2025-06-07 11:59:53,690 - INFO - Informed scheduler that task   Load__99914b932b   has status   DONE
2025-06-07 11:59:53,692 - DEBUG - Checking if Transform() is complete
2025-06-07 11:59:53,695 - DEBUG - Checking if Load() is complete
2025-06-07 11:59:53,697 - INFO - Informed scheduler that task   Transform__99914b932b   has status   PENDING
2025-06-07 11:59:53,698 - INFO - Informed scheduler that task   Load__99914b932b   has status   DONE
2025-06-07 11:59:53,700 - INFO - Done scheduling tasks
2025-06-07 11:59:53,701 - INFO - Running Worker with 1 processes
2025-06-07 11:59:53,701 - DEBUG - Asking scheduler for work...
2025-06-07 11:59:53,704 - DEBUG - Pending tasks: 1
2025-06-07 11:59:53,705 - INFO - [pid 19900] Worker Worker(salt=447526724, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) running   Transform()
2025-06-07 11:59:53,709 - INFO - Connect to DWH - SUCCESS
2025-06-07 11:59:53,712 - INFO - Read Transform Query - SUCCESS
2025-06-07 11:59:53,713 - INFO - ==================================STARTING TRANSFROM DATA=======================================
2025-06-07 11:59:54,022 - INFO - Transform to 'dwh.dim_geolocation' - SUCCESS
2025-06-07 11:59:54,033 - INFO - Transform to 'dwh.dim_product_category' - SUCCESS
2025-06-07 11:59:54,078 - INFO - Transform to 'dwh.dim_sellers' - SUCCESS
2025-06-07 11:59:55,351 - INFO - Transform to 'dwh.dim_customers' - SUCCESS
2025-06-07 11:59:55,840 - INFO - Transform to 'dwh.dim_products' - SUCCESS
2025-06-07 11:59:56,674 - INFO - Transform to 'dwh.fact_orders_comprehensive' - SUCCESS
2025-06-07 11:59:56,677 - INFO - Transform to 'dwh.fact_reviews_sentiment' - SUCCESS
2025-06-07 11:59:56,680 - INFO - Transform to 'dwh.fact_daily_periodicals_order_trends' - SUCCESS
2025-06-07 12:00:01,942 - ERROR - Transform to All Dimensions and Fact Tables - FAILED
2025-06-07 12:00:01,945 - ERROR - Transform Tables - FAILED
2025-06-07 12:00:01,945 - ERROR - [pid 19900] Worker Worker(salt=447526724, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) failed    Transform()
Traceback (most recent call last):
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.NotNullViolation: null value in column "accm_order_id" of relation "accumulating_snapshot_logistic_performance" violates not-null constraint
DETAIL:  Failing row contains (null, 679d507dacd35ecf587d994177d06871, 22, 72, 16480, 2017-03-01 20:57:25, 2017-03-01 21:05:22, 00:07:57, 2017-03-20 00:00:00, 2017-03-07 21:05:22, 2017-03-03 11:35:54, 2017-03-07 14:52:47, 1 day 14:30:32, 5 days 17:47:25, null, null, 2025-06-07 03:59:53.82352, delivered).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\LENOVO THINKPAD\AppData\Local\Temp\ipykernel_19900\4240733592.py", line 146, in run
    session.execute(query)
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\orm\session.py", line 2362, in execute
    return self._execute_internal(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\orm\session.py", line 2256, in _execute_internal
    result = conn.execute(
             ^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1418, in execute
    return meth(
           ^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\sql\elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "accm_order_id" of relation "accumulating_snapshot_logistic_performance" violates not-null constraint
DETAIL:  Failing row contains (null, 679d507dacd35ecf587d994177d06871, 22, 72, 16480, 2017-03-01 20:57:25, 2017-03-01 21:05:22, 00:07:57, 2017-03-20 00:00:00, 2017-03-07 21:05:22, 2017-03-03 11:35:54, 2017-03-07 14:52:47, 1 day 14:30:32, 5 days 17:47:25, null, null, 2025-06-07 03:59:53.82352, delivered).

[SQL: INSERT INTO dwh.accumulating_snapshot_logistic_performance (
    order_id,
    product_sk,
    seller_sk,
    customer_sk,
    order_purchase_timestamp,
    order_approved_at,
    purchase_approve_difference,
    order_estimated_delivery_date,
    order_shipping_limit_date,
    order_delivered_carrier_date,
    order_delivered_customer_date,
    approved_carrier_difference,
    approved_delivered_difference,
    order_purchase_date_id,
    order_delivered_date_id,
    last_updated,
    order_status_code
)

SELECT
    o.order_id,
    dp.product_sk,
    ds.seller_sk,
    dc.customer_sk,

    TO_TIMESTAMP(o.order_purchase_timestamp, 'YYYY-MM-DD HH24:MI:SS') AS order_purchase_ts,
    TO_TIMESTAMP(o.order_approved_at, 'YYYY-MM-DD HH24:MI:SS') AS approved_ts,

    CASE 
        WHEN o.order_approved_at IS NOT NULL 
        THEN TO_TIMESTAMP(o.order_approved_at, 'YYYY-MM-DD HH24:MI:SS') - TO_TIMESTAMP(o.order_purchase_timestamp, 'YYYY-MM-DD HH24:MI:SS')
        ELSE NULL
    END AS purchase_approve_diff,

    TO_TIMESTAMP(o.order_estimated_delivery_date, 'YYYY-MM-DD') AS estimated_delivery,
    TO_TIMESTAMP(oi.shipping_limit_date, 'YYYY-MM-DD HH24:MI:SS') AS shipping_limit,
    TO_TIMESTAMP(o.order_delivered_carrier_date, 'YYYY-MM-DD HH24:MI:SS') AS delivered_carrier,
    TO_TIMESTAMP(o.order_delivered_customer_date, 'YYYY-MM-DD HH24:MI:SS') AS delivered_customer,

    CASE 
        WHEN o.order_delivered_carrier_date IS NOT NULL AND o.order_approved_at IS NOT NULL
        THEN TO_TIMESTAMP(o.order_delivered_carrier_date, 'YYYY-MM-DD HH24:MI:SS') - TO_TIMESTAMP(o.order_approved_at, 'YYYY-MM-DD HH24:MI:SS')
        ELSE NULL
    END AS approved_carrier_diff,

    CASE 
        WHEN o.order_delivered_customer_date IS NOT NULL AND o.order_approved_at IS NOT NULL
        THEN TO_TIMESTAMP(o.order_delivered_customer_date, 'YYYY-MM-DD HH24:MI:SS') - TO_TIMESTAMP(o.order_approved_at, 'YYYY-MM-DD HH24:MI:SS')
        ELSE NULL
    END AS approved_delivered_diff,

    dd_order.date_id AS order_purchase_date_id,
    dd_delivered.date_id AS order_delivered_date_id,

    NOW() AS last_updated,

    o.order_status AS order_status_code

FROM stg.orders o
JOIN stg.order_items oi ON o.order_id = oi.order_id

-- Dimension lookups with SCD type 2 handling
JOIN dwh.dim_customers dc ON o.customer_id = dc.customer_id AND dc.is_current = TRUE
JOIN dwh.dim_sellers ds ON oi.seller_id = ds.seller_id AND ds.is_current = TRUE
JOIN dwh.dim_products dp ON oi.product_id = dp.product_id

-- Dates
LEFT JOIN dwh.dim_date dd_order ON dd_order.full_date = TO_DATE(o.order_purchase_timestamp, 'YYYY-MM-DD')
LEFT JOIN dwh.dim_date dd_delivered ON dd_delivered.full_date = TO_DATE(o.order_delivered_customer_date, 'YYYY-MM-DD')

-- Only if order_purchase_timestamp is present
WHERE o.order_purchase_timestamp IS NOT NULL;
]
(Background on this error at: https://sqlalche.me/e/20/gkpj)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 210, in run
    new_deps = self._run_get_new_deps()
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 138, in _run_get_new_deps
    task_gen = self.task.run()
               ^^^^^^^^^^^^^^^
  File "C:\Users\LENOVO THINKPAD\AppData\Local\Temp\ipykernel_19900\4240733592.py", line 193, in run
    raise Exception('Failed Transforming Tables')
Exception: Failed Transforming Tables
2025-06-07 12:00:01,953 - DEBUG - 1 running tasks, waiting for next task to finish
2025-06-07 12:00:01,959 - INFO - Informed scheduler that task   Transform__99914b932b   has status   FAILED
2025-06-07 12:00:01,961 - DEBUG - Asking scheduler for work...
2025-06-07 12:00:01,962 - DEBUG - Done
2025-06-07 12:00:01,964 - DEBUG - There are no more tasks to run at this time
2025-06-07 12:00:01,965 - DEBUG - There are 1 pending tasks possibly being run by other workers
2025-06-07 12:00:01,967 - DEBUG - There are 1 pending tasks unique to this worker
2025-06-07 12:00:01,968 - DEBUG - There are 1 pending tasks last scheduled by this worker
2025-06-07 12:00:01,971 - INFO - Worker Worker(salt=447526724, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) was stopped. Shutting down Keep-Alive thread
2025-06-07 12:00:01,987 - INFO - 
===== Luigi Execution Summary =====

Scheduled 3 tasks of which:
* 2 complete ones were encountered:
    - 1 Extract()
    - 1 Load()
* 1 failed:
    - 1 Transform()

This progress looks :( because there were failed tasks

===== Luigi Execution Summary =====

2025-06-07 12:00:54,218 - INFO - logging already configured
2025-06-07 12:00:54,221 - DEBUG - Checking if Extract() is complete
2025-06-07 12:00:54,225 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2025-06-07 12:00:54,226 - DEBUG - Checking if Load() is complete
2025-06-07 12:00:54,226 - INFO - Informed scheduler that task   Load__99914b932b   has status   DONE
2025-06-07 12:00:54,226 - DEBUG - Checking if Transform() is complete
2025-06-07 12:00:54,226 - DEBUG - Checking if Load() is complete
2025-06-07 12:00:54,226 - INFO - Informed scheduler that task   Transform__99914b932b   has status   PENDING
2025-06-07 12:00:54,237 - INFO - Informed scheduler that task   Load__99914b932b   has status   DONE
2025-06-07 12:00:54,237 - INFO - Done scheduling tasks
2025-06-07 12:00:54,240 - INFO - Running Worker with 1 processes
2025-06-07 12:00:54,240 - DEBUG - Asking scheduler for work...
2025-06-07 12:00:54,240 - DEBUG - Pending tasks: 1
2025-06-07 12:00:54,240 - INFO - [pid 19900] Worker Worker(salt=812361917, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) running   Transform()
2025-06-07 12:00:54,240 - INFO - Connect to DWH - SUCCESS
2025-06-07 12:00:54,250 - INFO - Read Transform Query - SUCCESS
2025-06-07 12:00:54,250 - INFO - ==================================STARTING TRANSFROM DATA=======================================
2025-06-07 12:00:54,541 - INFO - Transform to 'dwh.dim_geolocation' - SUCCESS
2025-06-07 12:00:54,541 - INFO - Transform to 'dwh.dim_product_category' - SUCCESS
2025-06-07 12:00:54,629 - INFO - Transform to 'dwh.dim_sellers' - SUCCESS
2025-06-07 12:00:55,852 - INFO - Transform to 'dwh.dim_customers' - SUCCESS
2025-06-07 12:00:56,361 - INFO - Transform to 'dwh.dim_products' - SUCCESS
2025-06-07 12:00:57,185 - INFO - Transform to 'dwh.fact_orders_comprehensive' - SUCCESS
2025-06-07 12:00:57,191 - INFO - Transform to 'dwh.fact_reviews_sentiment' - SUCCESS
2025-06-07 12:00:57,194 - INFO - Transform to 'dwh.fact_daily_periodicals_order_trends' - SUCCESS
2025-06-07 12:02:00,952 - INFO - Transform to 'dwh.fact_accumulating_snapshot_logistic_performance' - SUCCESS
2025-06-07 12:02:00,981 - INFO - Transform to All Dimensions and Fact Tables - SUCCESS
2025-06-07 12:02:00,985 - INFO - ==================================ENDING TRANSFROM DATA=======================================
2025-06-07 12:02:00,985 - INFO - [pid 19900] Worker Worker(salt=812361917, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) done      Transform()
2025-06-07 12:02:00,988 - DEBUG - 1 running tasks, waiting for next task to finish
2025-06-07 12:02:00,991 - INFO - Informed scheduler that task   Transform__99914b932b   has status   DONE
2025-06-07 12:02:00,992 - DEBUG - Asking scheduler for work...
2025-06-07 12:02:00,995 - DEBUG - Done
2025-06-07 12:02:00,996 - DEBUG - There are no more tasks to run at this time
2025-06-07 12:02:00,999 - INFO - Worker Worker(salt=812361917, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) was stopped. Shutting down Keep-Alive thread
2025-06-07 12:02:01,005 - INFO - 
===== Luigi Execution Summary =====

Scheduled 3 tasks of which:
* 2 complete ones were encountered:
    - 1 Extract()
    - 1 Load()
* 1 ran successfully:
    - 1 Transform()

This progress looks :) because there were no failed tasks or missing dependencies

===== Luigi Execution Summary =====

2025-06-07 15:17:16,549 - INFO - logging already configured
2025-06-07 15:17:16,553 - DEBUG - Checking if Extract() is complete
2025-06-07 15:17:20,660 - WARNING - Failed connecting to remote scheduler 'http://localhost:8082'
NoneType: None
2025-06-07 15:17:20,662 - INFO - Retrying attempt 2 of 3 (max)
2025-06-07 15:17:20,663 - INFO - Wait for 30 seconds
2025-06-07 15:17:21,655 - WARNING - Failed connecting to remote scheduler 'http://localhost:8082'
NoneType: None
2025-06-07 15:17:21,660 - INFO - Retrying attempt 2 of 3 (max)
2025-06-07 15:17:21,661 - INFO - Wait for 30 seconds
2025-06-07 15:17:54,770 - WARNING - Failed connecting to remote scheduler 'http://localhost:8082'
NoneType: None
2025-06-07 15:17:54,770 - INFO - Retrying attempt 3 of 3 (max)
2025-06-07 15:17:54,774 - INFO - Wait for 30 seconds
2025-06-07 15:17:55,749 - WARNING - Failed connecting to remote scheduler 'http://localhost:8082'
NoneType: None
2025-06-07 15:17:55,753 - INFO - Retrying attempt 3 of 3 (max)
2025-06-07 15:17:55,754 - INFO - Wait for 30 seconds
2025-06-07 15:18:28,848 - WARNING - Failed connecting to remote scheduler 'http://localhost:8082'
NoneType: None
2025-06-07 15:18:28,850 - INFO - Retrying attempt 4 of 3 (max)
2025-06-07 15:18:28,851 - INFO - Wait for 30 seconds
2025-06-07 15:18:29,132 - ERROR - Luigi unexpected framework error while scheduling Extract()
Traceback (most recent call last):
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\urllib3\connection.py", line 199, in _new_conn
    sock = connection.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\urllib3\util\connection.py", line 85, in create_connection
    raise err
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\urllib3\util\connection.py", line 73, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\urllib3\connectionpool.py", line 789, in urlopen
    response = self._make_request(
               ^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\urllib3\connectionpool.py", line 495, in _make_request
    conn.request(
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\urllib3\connection.py", line 441, in request
    self.endheaders()
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\http\client.py", line 1331, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\http\client.py", line 1091, in _send_output
    self.send(msg)
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\http\client.py", line 1035, in send
    self.connect()
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\urllib3\connection.py", line 279, in connect
    self.sock = self._new_conn()
                ^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\urllib3\connection.py", line 214, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x000002E5DCC79190>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\requests\adapters.py", line 667, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\urllib3\connectionpool.py", line 843, in urlopen
    retries = retries.increment(
              ^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\urllib3\util\retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=8082): Max retries exceeded with url: /api/add_task (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x000002E5DCC79190>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\rpc.py", line 185, in _fetch
    response = scheduler_retry(self._fetcher.fetch, full_url, body, self._connect_timeout)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\tenacity\__init__.py", line 475, in __call__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\tenacity\__init__.py", line 376, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\tenacity\__init__.py", line 418, in exc_check
    raise retry_exc.reraise()
          ^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\tenacity\__init__.py", line 185, in reraise
    raise self.last_attempt.result()
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\tenacity\__init__.py", line 478, in __call__
    result = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\rpc.py", line 131, in fetch
    resp = self.session.post(full_url, data=body, timeout=timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\requests\sessions.py", line 637, in post
    return self.request("POST", url, data=data, json=json, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\requests\sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\requests\sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\requests\adapters.py", line 700, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=8082): Max retries exceeded with url: /api/add_task (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x000002E5DCC79190>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 806, in add
    for next in self._add(item, is_complete):
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 911, in _add
    self._add_task(
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 635, in _add_task
    self._scheduler.add_task(*args, **kwargs)
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\scheduler.py", line 114, in rpc_func
    return self._request('/api/{}'.format(fn_name), actual_args, **request_args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\rpc.py", line 198, in _request
    page = self._fetch(url, body)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\rpc.py", line 187, in _fetch
    raise RPCError(
luigi.rpc.RPCError: Errors (3 attempts) when connecting to remote scheduler 'http://localhost:8082'
2025-06-07 15:18:29,827 - WARNING - Failed connecting to remote scheduler 'http://localhost:8082'
NoneType: None
2025-06-07 15:18:29,832 - INFO - Retrying attempt 4 of 3 (max)
2025-06-07 15:18:29,834 - INFO - Wait for 30 seconds
2025-06-07 15:18:29,837 - WARNING - Failed pinging scheduler
2025-06-07 15:18:29,838 - INFO - Worker Worker(salt=8239238845, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) was stopped. Shutting down Keep-Alive thread
2025-06-07 15:24:22,117 - INFO - logging already configured
2025-06-07 15:24:22,120 - DEBUG - Checking if Extract() is complete
2025-06-07 15:24:22,123 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2025-06-07 15:24:22,125 - DEBUG - Checking if Load() is complete
2025-06-07 15:24:22,128 - INFO - Informed scheduler that task   Load__99914b932b   has status   DONE
2025-06-07 15:24:22,129 - DEBUG - Checking if Transform() is complete
2025-06-07 15:24:22,132 - INFO - Informed scheduler that task   Transform__99914b932b   has status   DONE
2025-06-07 15:24:22,134 - INFO - Done scheduling tasks
2025-06-07 15:24:22,136 - INFO - Running Worker with 1 processes
2025-06-07 15:24:22,138 - DEBUG - Asking scheduler for work...
2025-06-07 15:24:22,139 - DEBUG - Done
2025-06-07 15:24:22,140 - DEBUG - There are no more tasks to run at this time
2025-06-07 15:24:22,142 - INFO - Worker Worker(salt=7333942203, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) was stopped. Shutting down Keep-Alive thread
2025-06-07 15:24:22,148 - INFO - 
===== Luigi Execution Summary =====

Scheduled 3 tasks of which:
* 3 complete ones were encountered:
    - 1 Extract()
    - 1 Load()
    - 1 Transform()

Did not run any tasks
This progress looks :) because there were no failed tasks or missing dependencies

===== Luigi Execution Summary =====

2025-06-07 15:25:00,758 - INFO - logging already configured
2025-06-07 15:25:00,762 - DEBUG - Checking if Extract() is complete
2025-06-07 15:25:00,766 - INFO - Informed scheduler that task   Extract__99914b932b   has status   PENDING
2025-06-07 15:25:00,768 - DEBUG - Checking if Load() is complete
2025-06-07 15:25:00,770 - DEBUG - Checking if Extract() is complete
2025-06-07 15:25:00,773 - INFO - Informed scheduler that task   Load__99914b932b   has status   PENDING
2025-06-07 15:25:00,775 - INFO - Informed scheduler that task   Extract__99914b932b   has status   PENDING
2025-06-07 15:25:00,778 - DEBUG - Checking if Transform() is complete
2025-06-07 15:25:00,780 - DEBUG - Checking if Load() is complete
2025-06-07 15:25:00,783 - INFO - Informed scheduler that task   Transform__99914b932b   has status   PENDING
2025-06-07 15:25:00,784 - DEBUG - Checking if Extract() is complete
2025-06-07 15:25:00,787 - INFO - Informed scheduler that task   Load__99914b932b   has status   PENDING
2025-06-07 15:25:00,789 - INFO - Informed scheduler that task   Extract__99914b932b   has status   PENDING
2025-06-07 15:25:00,790 - INFO - Done scheduling tasks
2025-06-07 15:25:00,792 - INFO - Running Worker with 1 processes
2025-06-07 15:25:00,793 - DEBUG - Asking scheduler for work...
2025-06-07 15:25:00,796 - DEBUG - Pending tasks: 3
2025-06-07 15:25:00,797 - INFO - [pid 19900] Worker Worker(salt=6962724553, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) running   Extract()
2025-06-07 15:25:00,799 - ERROR - [pid 19900] Worker Worker(salt=6962724553, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) failed    Extract()
Traceback (most recent call last):
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 210, in run
    new_deps = self._run_get_new_deps()
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 138, in _run_get_new_deps
    task_gen = self.task.run()
               ^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\Documents\Github\Pacmann---Data-Storage_-Warehouse--Mart---Lake\mentoring 2\olist-dwh-project\pipeline\extract.py", line 43, in run
    os.makedirs(os.path.dirname(self.output().path), exist_ok=True)
                                ^^^^^^^^^^^^^^^^^^
AttributeError: 'list' object has no attribute 'path'
2025-06-07 15:25:00,804 - DEBUG - 1 running tasks, waiting for next task to finish
2025-06-07 15:25:00,810 - INFO - Informed scheduler that task   Extract__99914b932b   has status   FAILED
2025-06-07 15:25:00,811 - DEBUG - Asking scheduler for work...
2025-06-07 15:25:00,814 - DEBUG - Done
2025-06-07 15:25:00,815 - DEBUG - There are no more tasks to run at this time
2025-06-07 15:25:00,816 - DEBUG - There are 3 pending tasks possibly being run by other workers
2025-06-07 15:25:00,818 - DEBUG - There are 3 pending tasks unique to this worker
2025-06-07 15:25:00,819 - DEBUG - There are 3 pending tasks last scheduled by this worker
2025-06-07 15:25:00,822 - INFO - Worker Worker(salt=6962724553, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) was stopped. Shutting down Keep-Alive thread
2025-06-07 15:25:00,829 - INFO - 
===== Luigi Execution Summary =====

Scheduled 5 tasks of which:
* 1 failed:
    - 1 Extract()
* 4 were left pending, among these:
    * 3 had failed dependencies:
        - 2 Load()
        - 1 Transform()
    * 1 was not granted run permission by the scheduler:
        - 1 Extract()

This progress looks :( because there were failed tasks

===== Luigi Execution Summary =====

2025-06-07 15:27:27,759 - INFO - logging already configured
2025-06-07 15:27:27,762 - DEBUG - Checking if Extract() is complete
2025-06-07 15:27:27,766 - INFO - Informed scheduler that task   Extract__99914b932b   has status   PENDING
2025-06-07 15:27:27,767 - DEBUG - Checking if Load() is complete
2025-06-07 15:27:27,770 - DEBUG - Checking if Extract() is complete
2025-06-07 15:27:27,773 - INFO - Informed scheduler that task   Load__99914b932b   has status   PENDING
2025-06-07 15:27:27,777 - INFO - Informed scheduler that task   Extract__99914b932b   has status   PENDING
2025-06-07 15:27:27,780 - DEBUG - Checking if Transform() is complete
2025-06-07 15:27:27,782 - DEBUG - Checking if Load() is complete
2025-06-07 15:27:27,786 - INFO - Informed scheduler that task   Transform__99914b932b   has status   PENDING
2025-06-07 15:27:27,786 - DEBUG - Checking if Extract() is complete
2025-06-07 15:27:27,788 - INFO - Informed scheduler that task   Load__99914b932b   has status   PENDING
2025-06-07 15:27:27,790 - INFO - Informed scheduler that task   Extract__99914b932b   has status   PENDING
2025-06-07 15:27:27,791 - INFO - Done scheduling tasks
2025-06-07 15:27:27,791 - INFO - Running Worker with 1 processes
2025-06-07 15:27:27,791 - DEBUG - Asking scheduler for work...
2025-06-07 15:27:27,797 - DEBUG - Pending tasks: 3
2025-06-07 15:27:27,797 - INFO - [pid 19900] Worker Worker(salt=2972588394, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) running   Extract()
2025-06-07 15:27:27,797 - ERROR - [pid 19900] Worker Worker(salt=2972588394, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) failed    Extract()
Traceback (most recent call last):
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 210, in run
    new_deps = self._run_get_new_deps()
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 138, in _run_get_new_deps
    task_gen = self.task.run()
               ^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\Documents\Github\Pacmann---Data-Storage_-Warehouse--Mart---Lake\mentoring 2\olist-dwh-project\pipeline\extract.py", line 43, in run
    os.makedirs(os.path.dirname(self.output().path), exist_ok=True)
                                ^^^^^^^^^^^^^^^^^^
AttributeError: 'list' object has no attribute 'path'
2025-06-07 15:27:27,805 - DEBUG - 1 running tasks, waiting for next task to finish
2025-06-07 15:27:27,813 - INFO - Informed scheduler that task   Extract__99914b932b   has status   FAILED
2025-06-07 15:27:27,815 - DEBUG - Asking scheduler for work...
2025-06-07 15:27:27,817 - DEBUG - Done
2025-06-07 15:27:27,817 - DEBUG - There are no more tasks to run at this time
2025-06-07 15:27:27,817 - DEBUG - There are 3 pending tasks possibly being run by other workers
2025-06-07 15:27:27,817 - DEBUG - There are 3 pending tasks unique to this worker
2025-06-07 15:27:27,824 - DEBUG - There are 3 pending tasks last scheduled by this worker
2025-06-07 15:27:27,824 - INFO - Worker Worker(salt=2972588394, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) was stopped. Shutting down Keep-Alive thread
2025-06-07 15:27:27,832 - INFO - 
===== Luigi Execution Summary =====

Scheduled 5 tasks of which:
* 1 failed:
    - 1 Extract()
* 4 were left pending, among these:
    * 3 had failed dependencies:
        - 2 Load()
        - 1 Transform()
    * 1 was not granted run permission by the scheduler:
        - 1 Extract()

This progress looks :( because there were failed tasks

===== Luigi Execution Summary =====

2025-06-07 15:28:03,337 - INFO - logging already configured
2025-06-07 15:28:03,342 - DEBUG - Checking if Extract() is complete
2025-06-07 15:28:03,345 - INFO - Informed scheduler that task   Extract__99914b932b   has status   PENDING
2025-06-07 15:28:03,347 - DEBUG - Checking if Load() is complete
2025-06-07 15:28:03,350 - DEBUG - Checking if Extract() is complete
2025-06-07 15:28:03,353 - INFO - Informed scheduler that task   Load__99914b932b   has status   PENDING
2025-06-07 15:28:03,354 - INFO - Informed scheduler that task   Extract__99914b932b   has status   PENDING
2025-06-07 15:28:03,355 - DEBUG - Checking if Transform() is complete
2025-06-07 15:28:03,359 - DEBUG - Checking if Load() is complete
2025-06-07 15:28:03,362 - INFO - Informed scheduler that task   Transform__99914b932b   has status   PENDING
2025-06-07 15:28:03,367 - DEBUG - Checking if Extract() is complete
2025-06-07 15:28:03,369 - INFO - Informed scheduler that task   Load__99914b932b   has status   PENDING
2025-06-07 15:28:03,372 - INFO - Informed scheduler that task   Extract__99914b932b   has status   PENDING
2025-06-07 15:28:03,374 - INFO - Done scheduling tasks
2025-06-07 15:28:03,376 - INFO - Running Worker with 1 processes
2025-06-07 15:28:03,378 - DEBUG - Asking scheduler for work...
2025-06-07 15:28:03,380 - DEBUG - Pending tasks: 3
2025-06-07 15:28:03,382 - INFO - [pid 19900] Worker Worker(salt=6813685024, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) running   Extract()
2025-06-07 15:28:03,383 - ERROR - [pid 19900] Worker Worker(salt=6813685024, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) failed    Extract()
Traceback (most recent call last):
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 210, in run
    new_deps = self._run_get_new_deps()
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 138, in _run_get_new_deps
    task_gen = self.task.run()
               ^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\Documents\Github\Pacmann---Data-Storage_-Warehouse--Mart---Lake\mentoring 2\olist-dwh-project\pipeline\extract.py", line 43, in run
    os.makedirs(os.path.dirname(self.output().path), exist_ok=True)
                                ^^^^^^^^^^^^^^^^^^
AttributeError: 'list' object has no attribute 'path'
2025-06-07 15:28:03,388 - DEBUG - 1 running tasks, waiting for next task to finish
2025-06-07 15:28:03,396 - INFO - Informed scheduler that task   Extract__99914b932b   has status   FAILED
2025-06-07 15:28:03,397 - DEBUG - Asking scheduler for work...
2025-06-07 15:28:03,398 - DEBUG - Done
2025-06-07 15:28:03,401 - DEBUG - There are no more tasks to run at this time
2025-06-07 15:28:03,402 - DEBUG - There are 3 pending tasks possibly being run by other workers
2025-06-07 15:28:03,404 - DEBUG - There are 3 pending tasks unique to this worker
2025-06-07 15:28:03,405 - DEBUG - There are 3 pending tasks last scheduled by this worker
2025-06-07 15:28:03,407 - INFO - Worker Worker(salt=6813685024, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) was stopped. Shutting down Keep-Alive thread
2025-06-07 15:28:03,416 - INFO - 
===== Luigi Execution Summary =====

Scheduled 5 tasks of which:
* 1 failed:
    - 1 Extract()
* 4 were left pending, among these:
    * 3 had failed dependencies:
        - 2 Load()
        - 1 Transform()
    * 1 was not granted run permission by the scheduler:
        - 1 Extract()

This progress looks :( because there were failed tasks

===== Luigi Execution Summary =====

2025-06-07 15:38:35,055 - INFO - logging already configured
2025-06-07 15:38:35,060 - DEBUG - Checking if Extract() is complete
2025-06-07 15:38:35,063 - INFO - Informed scheduler that task   Extract__99914b932b   has status   PENDING
2025-06-07 15:38:35,066 - DEBUG - Checking if Load() is complete
2025-06-07 15:38:35,068 - DEBUG - Checking if Extract() is complete
2025-06-07 15:38:35,071 - INFO - Informed scheduler that task   Load__99914b932b   has status   PENDING
2025-06-07 15:38:35,073 - INFO - Informed scheduler that task   Extract__99914b932b   has status   PENDING
2025-06-07 15:38:35,075 - DEBUG - Checking if Transform() is complete
2025-06-07 15:38:35,079 - DEBUG - Checking if Load() is complete
2025-06-07 15:38:35,082 - INFO - Informed scheduler that task   Transform__99914b932b   has status   PENDING
2025-06-07 15:38:35,084 - DEBUG - Checking if Extract() is complete
2025-06-07 15:38:35,087 - INFO - Informed scheduler that task   Load__99914b932b   has status   PENDING
2025-06-07 15:38:35,088 - INFO - Informed scheduler that task   Extract__99914b932b   has status   PENDING
2025-06-07 15:38:35,090 - INFO - Done scheduling tasks
2025-06-07 15:38:35,092 - INFO - Running Worker with 1 processes
2025-06-07 15:38:35,093 - DEBUG - Asking scheduler for work...
2025-06-07 15:38:35,094 - DEBUG - Pending tasks: 3
2025-06-07 15:38:35,096 - INFO - [pid 19900] Worker Worker(salt=8356196822, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) running   Extract()
2025-06-07 15:38:35,097 - ERROR - [pid 19900] Worker Worker(salt=8356196822, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) failed    Extract()
Traceback (most recent call last):
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 210, in run
    new_deps = self._run_get_new_deps()
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 138, in _run_get_new_deps
    task_gen = self.task.run()
               ^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\Documents\Github\Pacmann---Data-Storage_-Warehouse--Mart---Lake\mentoring 2\olist-dwh-project\pipeline\extract.py", line 43, in run
    os.makedirs(os.path.dirname(self.output().path), exist_ok=True)
                                ^^^^^^^^^^^^^^^^^^
AttributeError: 'list' object has no attribute 'path'
2025-06-07 15:38:35,103 - DEBUG - 1 running tasks, waiting for next task to finish
2025-06-07 15:38:35,108 - INFO - Informed scheduler that task   Extract__99914b932b   has status   FAILED
2025-06-07 15:38:35,109 - DEBUG - Asking scheduler for work...
2025-06-07 15:38:35,110 - DEBUG - Done
2025-06-07 15:38:35,112 - DEBUG - There are no more tasks to run at this time
2025-06-07 15:38:35,113 - DEBUG - There are 3 pending tasks possibly being run by other workers
2025-06-07 15:38:35,114 - DEBUG - There are 3 pending tasks unique to this worker
2025-06-07 15:38:35,115 - DEBUG - There are 3 pending tasks last scheduled by this worker
2025-06-07 15:38:35,117 - INFO - Worker Worker(salt=8356196822, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) was stopped. Shutting down Keep-Alive thread
2025-06-07 15:38:35,125 - INFO - 
===== Luigi Execution Summary =====

Scheduled 5 tasks of which:
* 1 failed:
    - 1 Extract()
* 4 were left pending, among these:
    * 3 had failed dependencies:
        - 2 Load()
        - 1 Transform()
    * 1 was not granted run permission by the scheduler:
        - 1 Extract()

This progress looks :( because there were failed tasks

===== Luigi Execution Summary =====

2025-06-07 15:39:43,251 - INFO - logging already configured
2025-06-07 15:39:43,254 - DEBUG - Checking if Extract() is complete
2025-06-07 15:39:43,258 - INFO - Informed scheduler that task   Extract__99914b932b   has status   PENDING
2025-06-07 15:39:43,259 - DEBUG - Checking if Load() is complete
2025-06-07 15:39:43,262 - DEBUG - Checking if Extract() is complete
2025-06-07 15:39:43,265 - INFO - Informed scheduler that task   Load__99914b932b   has status   PENDING
2025-06-07 15:39:43,267 - INFO - Informed scheduler that task   Extract__99914b932b   has status   PENDING
2025-06-07 15:39:43,268 - DEBUG - Checking if Transform() is complete
2025-06-07 15:39:43,271 - DEBUG - Checking if Load() is complete
2025-06-07 15:39:43,273 - INFO - Informed scheduler that task   Transform__99914b932b   has status   PENDING
2025-06-07 15:39:43,275 - DEBUG - Checking if Extract() is complete
2025-06-07 15:39:43,277 - INFO - Informed scheduler that task   Load__99914b932b   has status   PENDING
2025-06-07 15:39:43,279 - INFO - Informed scheduler that task   Extract__99914b932b   has status   PENDING
2025-06-07 15:39:43,280 - INFO - Done scheduling tasks
2025-06-07 15:39:43,282 - INFO - Running Worker with 1 processes
2025-06-07 15:39:43,283 - DEBUG - Asking scheduler for work...
2025-06-07 15:39:43,285 - DEBUG - Pending tasks: 3
2025-06-07 15:39:43,286 - INFO - [pid 19900] Worker Worker(salt=7386405138, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) running   Extract()
2025-06-07 15:39:43,288 - ERROR - [pid 19900] Worker Worker(salt=7386405138, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) failed    Extract()
Traceback (most recent call last):
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 210, in run
    new_deps = self._run_get_new_deps()
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 138, in _run_get_new_deps
    task_gen = self.task.run()
               ^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\Documents\Github\Pacmann---Data-Storage_-Warehouse--Mart---Lake\mentoring 2\olist-dwh-project\pipeline\extract.py", line 43, in run
    os.makedirs(os.path.dirname(self.output().path), exist_ok=True)
                                ^^^^^^^^^^^^^^^^^^
AttributeError: 'list' object has no attribute 'path'
2025-06-07 15:39:43,292 - DEBUG - 1 running tasks, waiting for next task to finish
2025-06-07 15:39:43,298 - INFO - Informed scheduler that task   Extract__99914b932b   has status   FAILED
2025-06-07 15:39:43,300 - DEBUG - Asking scheduler for work...
2025-06-07 15:39:43,302 - DEBUG - Done
2025-06-07 15:39:43,303 - DEBUG - There are no more tasks to run at this time
2025-06-07 15:39:43,304 - DEBUG - There are 3 pending tasks possibly being run by other workers
2025-06-07 15:39:43,306 - DEBUG - There are 3 pending tasks unique to this worker
2025-06-07 15:39:43,307 - DEBUG - There are 3 pending tasks last scheduled by this worker
2025-06-07 15:39:43,309 - INFO - Worker Worker(salt=7386405138, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) was stopped. Shutting down Keep-Alive thread
2025-06-07 15:39:43,316 - INFO - 
===== Luigi Execution Summary =====

Scheduled 5 tasks of which:
* 1 failed:
    - 1 Extract()
* 4 were left pending, among these:
    * 3 had failed dependencies:
        - 2 Load()
        - 1 Transform()
    * 1 was not granted run permission by the scheduler:
        - 1 Extract()

This progress looks :( because there were failed tasks

===== Luigi Execution Summary =====

2025-06-07 15:41:15,239 - INFO - logging already configured
2025-06-07 15:41:15,242 - DEBUG - Checking if Extract() is complete
2025-06-07 15:41:15,245 - INFO - Informed scheduler that task   Extract__99914b932b   has status   PENDING
2025-06-07 15:41:15,247 - DEBUG - Checking if Load() is complete
2025-06-07 15:41:15,248 - DEBUG - Checking if Extract() is complete
2025-06-07 15:41:15,252 - INFO - Informed scheduler that task   Load__99914b932b   has status   PENDING
2025-06-07 15:41:15,252 - INFO - Informed scheduler that task   Extract__99914b932b   has status   PENDING
2025-06-07 15:41:15,252 - DEBUG - Checking if Transform() is complete
2025-06-07 15:41:15,252 - DEBUG - Checking if Load() is complete
2025-06-07 15:41:15,260 - INFO - Informed scheduler that task   Transform__99914b932b   has status   PENDING
2025-06-07 15:41:15,260 - DEBUG - Checking if Extract() is complete
2025-06-07 15:41:15,263 - INFO - Informed scheduler that task   Load__99914b932b   has status   PENDING
2025-06-07 15:41:15,263 - INFO - Informed scheduler that task   Extract__99914b932b   has status   PENDING
2025-06-07 15:41:15,263 - INFO - Done scheduling tasks
2025-06-07 15:41:15,263 - INFO - Running Worker with 1 processes
2025-06-07 15:41:15,270 - DEBUG - Asking scheduler for work...
2025-06-07 15:41:15,272 - DEBUG - Pending tasks: 3
2025-06-07 15:41:15,272 - INFO - [pid 19900] Worker Worker(salt=8850494569, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) running   Extract()
2025-06-07 15:41:15,274 - ERROR - [pid 19900] Worker Worker(salt=8850494569, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) failed    Extract()
Traceback (most recent call last):
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 210, in run
    new_deps = self._run_get_new_deps()
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 138, in _run_get_new_deps
    task_gen = self.task.run()
               ^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\Documents\Github\Pacmann---Data-Storage_-Warehouse--Mart---Lake\mentoring 2\olist-dwh-project\pipeline\extract.py", line 43, in run
    os.makedirs(os.path.dirname(self.output().path), exist_ok=True)
                                ^^^^^^^^^^^^^^^^^^
AttributeError: 'list' object has no attribute 'path'
2025-06-07 15:41:15,278 - DEBUG - 1 running tasks, waiting for next task to finish
2025-06-07 15:41:15,284 - INFO - Informed scheduler that task   Extract__99914b932b   has status   FAILED
2025-06-07 15:41:15,286 - DEBUG - Asking scheduler for work...
2025-06-07 15:41:15,286 - DEBUG - Done
2025-06-07 15:41:15,289 - DEBUG - There are no more tasks to run at this time
2025-06-07 15:41:15,289 - DEBUG - There are 3 pending tasks possibly being run by other workers
2025-06-07 15:41:15,292 - DEBUG - There are 3 pending tasks unique to this worker
2025-06-07 15:41:15,294 - DEBUG - There are 3 pending tasks last scheduled by this worker
2025-06-07 15:41:15,294 - INFO - Worker Worker(salt=8850494569, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) was stopped. Shutting down Keep-Alive thread
2025-06-07 15:41:15,303 - INFO - 
===== Luigi Execution Summary =====

Scheduled 5 tasks of which:
* 1 failed:
    - 1 Extract()
* 4 were left pending, among these:
    * 3 had failed dependencies:
        - 2 Load()
        - 1 Transform()
    * 1 was not granted run permission by the scheduler:
        - 1 Extract()

This progress looks :( because there were failed tasks

===== Luigi Execution Summary =====

2025-06-07 15:42:34,807 - INFO - logging already configured
2025-06-07 15:42:34,811 - DEBUG - Checking if Extract() is complete
2025-06-07 15:42:34,814 - INFO - Informed scheduler that task   Extract__99914b932b   has status   PENDING
2025-06-07 15:42:34,815 - DEBUG - Checking if Load() is complete
2025-06-07 15:42:34,820 - DEBUG - Checking if Extract() is complete
2025-06-07 15:42:34,822 - INFO - Informed scheduler that task   Load__99914b932b   has status   PENDING
2025-06-07 15:42:34,823 - INFO - Informed scheduler that task   Extract__99914b932b   has status   PENDING
2025-06-07 15:42:34,825 - DEBUG - Checking if Transform() is complete
2025-06-07 15:42:34,827 - DEBUG - Checking if Load() is complete
2025-06-07 15:42:34,829 - INFO - Informed scheduler that task   Transform__99914b932b   has status   PENDING
2025-06-07 15:42:34,831 - DEBUG - Checking if Extract() is complete
2025-06-07 15:42:34,833 - INFO - Informed scheduler that task   Load__99914b932b   has status   PENDING
2025-06-07 15:42:34,835 - INFO - Informed scheduler that task   Extract__99914b932b   has status   PENDING
2025-06-07 15:42:34,837 - INFO - Done scheduling tasks
2025-06-07 15:42:34,838 - INFO - Running Worker with 1 processes
2025-06-07 15:42:34,840 - DEBUG - Asking scheduler for work...
2025-06-07 15:42:34,842 - DEBUG - Pending tasks: 3
2025-06-07 15:42:34,843 - INFO - [pid 19900] Worker Worker(salt=9781474018, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) running   Extract()
2025-06-07 15:42:34,844 - ERROR - [pid 19900] Worker Worker(salt=9781474018, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) failed    Extract()
Traceback (most recent call last):
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 210, in run
    new_deps = self._run_get_new_deps()
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 138, in _run_get_new_deps
    task_gen = self.task.run()
               ^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\Documents\Github\Pacmann---Data-Storage_-Warehouse--Mart---Lake\mentoring 2\olist-dwh-project\pipeline\extract.py", line 43, in run
    os.makedirs(os.path.dirname(self.output().path), exist_ok=True)
                                ^^^^^^^^^^^^^^^^^^
AttributeError: 'list' object has no attribute 'path'
2025-06-07 15:42:34,848 - DEBUG - 1 running tasks, waiting for next task to finish
2025-06-07 15:42:34,852 - INFO - Informed scheduler that task   Extract__99914b932b   has status   FAILED
2025-06-07 15:42:34,854 - DEBUG - Asking scheduler for work...
2025-06-07 15:42:34,855 - DEBUG - Done
2025-06-07 15:42:34,858 - DEBUG - There are no more tasks to run at this time
2025-06-07 15:42:34,860 - DEBUG - There are 3 pending tasks possibly being run by other workers
2025-06-07 15:42:34,862 - DEBUG - There are 3 pending tasks unique to this worker
2025-06-07 15:42:34,863 - DEBUG - There are 3 pending tasks last scheduled by this worker
2025-06-07 15:42:34,864 - INFO - Worker Worker(salt=9781474018, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) was stopped. Shutting down Keep-Alive thread
2025-06-07 15:42:34,871 - INFO - 
===== Luigi Execution Summary =====

Scheduled 5 tasks of which:
* 1 failed:
    - 1 Extract()
* 4 were left pending, among these:
    * 3 had failed dependencies:
        - 2 Load()
        - 1 Transform()
    * 1 was not granted run permission by the scheduler:
        - 1 Extract()

This progress looks :( because there were failed tasks

===== Luigi Execution Summary =====

2025-06-07 19:35:39,462 - INFO - logging already configured
2025-06-07 19:35:39,465 - DEBUG - Checking if Extract() is complete
2025-06-07 19:35:39,466 - INFO - Informed scheduler that task   Extract__99914b932b   has status   PENDING
2025-06-07 19:35:39,467 - DEBUG - Checking if Load() is complete
2025-06-07 19:35:39,468 - DEBUG - Checking if Extract() is complete
2025-06-07 19:35:39,469 - INFO - Informed scheduler that task   Load__99914b932b   has status   PENDING
2025-06-07 19:35:39,471 - INFO - Informed scheduler that task   Extract__99914b932b   has status   PENDING
2025-06-07 19:35:39,472 - DEBUG - Checking if Transform() is complete
2025-06-07 19:35:39,474 - DEBUG - Checking if Load() is complete
2025-06-07 19:35:39,475 - INFO - Informed scheduler that task   Transform__99914b932b   has status   PENDING
2025-06-07 19:35:39,476 - DEBUG - Checking if Extract() is complete
2025-06-07 19:35:39,477 - INFO - Informed scheduler that task   Load__99914b932b   has status   PENDING
2025-06-07 19:35:39,478 - INFO - Informed scheduler that task   Extract__99914b932b   has status   PENDING
2025-06-07 19:35:39,478 - INFO - Done scheduling tasks
2025-06-07 19:35:39,479 - INFO - Running Worker with 1 processes
2025-06-07 19:35:39,479 - DEBUG - Asking scheduler for work...
2025-06-07 19:35:39,481 - DEBUG - Pending tasks: 3
2025-06-07 19:35:39,481 - INFO - [pid 19900] Worker Worker(salt=3681823757, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) running   Extract()
2025-06-07 19:35:39,482 - ERROR - [pid 19900] Worker Worker(salt=3681823757, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) failed    Extract()
Traceback (most recent call last):
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 210, in run
    new_deps = self._run_get_new_deps()
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 138, in _run_get_new_deps
    task_gen = self.task.run()
               ^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\Documents\Github\Pacmann---Data-Storage_-Warehouse--Mart---Lake\mentoring 2\olist-dwh-project\pipeline\extract.py", line 43, in run
    os.makedirs(os.path.dirname(self.output().path), exist_ok=True)
                                ^^^^^^^^^^^^^^^^^^
AttributeError: 'list' object has no attribute 'path'
2025-06-07 19:35:39,485 - DEBUG - 1 running tasks, waiting for next task to finish
2025-06-07 19:35:39,489 - INFO - Informed scheduler that task   Extract__99914b932b   has status   FAILED
2025-06-07 19:35:39,489 - DEBUG - Asking scheduler for work...
2025-06-07 19:35:39,490 - DEBUG - Done
2025-06-07 19:35:39,491 - DEBUG - There are no more tasks to run at this time
2025-06-07 19:35:39,492 - DEBUG - There are 3 pending tasks possibly being run by other workers
2025-06-07 19:35:39,492 - DEBUG - There are 3 pending tasks unique to this worker
2025-06-07 19:35:39,493 - DEBUG - There are 3 pending tasks last scheduled by this worker
2025-06-07 19:35:39,493 - INFO - Worker Worker(salt=3681823757, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) was stopped. Shutting down Keep-Alive thread
2025-06-07 19:35:39,498 - INFO - 
===== Luigi Execution Summary =====

Scheduled 5 tasks of which:
* 1 failed:
    - 1 Extract()
* 4 were left pending, among these:
    * 3 had failed dependencies:
        - 2 Load()
        - 1 Transform()
    * 1 was not granted run permission by the scheduler:
        - 1 Extract()

This progress looks :( because there were failed tasks

===== Luigi Execution Summary =====

2025-06-08 06:44:44,973 - INFO - logging already configured
2025-06-08 06:44:44,976 - DEBUG - Checking if Extract() is complete
2025-06-08 06:44:44,978 - INFO - Informed scheduler that task   Extract__99914b932b   has status   PENDING
2025-06-08 06:44:44,978 - DEBUG - Checking if Load() is complete
2025-06-08 06:44:44,979 - DEBUG - Checking if Extract() is complete
2025-06-08 06:44:44,981 - INFO - Informed scheduler that task   Load__99914b932b   has status   PENDING
2025-06-08 06:44:44,982 - INFO - Informed scheduler that task   Extract__99914b932b   has status   PENDING
2025-06-08 06:44:44,982 - DEBUG - Checking if Transform() is complete
2025-06-08 06:44:44,983 - DEBUG - Checking if Load() is complete
2025-06-08 06:44:44,984 - INFO - Informed scheduler that task   Transform__99914b932b   has status   PENDING
2025-06-08 06:44:44,985 - DEBUG - Checking if Extract() is complete
2025-06-08 06:44:44,987 - INFO - Informed scheduler that task   Load__99914b932b   has status   PENDING
2025-06-08 06:44:44,987 - INFO - Informed scheduler that task   Extract__99914b932b   has status   PENDING
2025-06-08 06:44:44,988 - INFO - Done scheduling tasks
2025-06-08 06:44:44,988 - INFO - Running Worker with 1 processes
2025-06-08 06:44:44,989 - DEBUG - Asking scheduler for work...
2025-06-08 06:44:44,989 - DEBUG - Pending tasks: 3
2025-06-08 06:44:44,990 - INFO - [pid 19900] Worker Worker(salt=9778963845, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) running   Extract()
2025-06-08 06:44:44,991 - ERROR - [pid 19900] Worker Worker(salt=9778963845, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) failed    Extract()
Traceback (most recent call last):
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 210, in run
    new_deps = self._run_get_new_deps()
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 138, in _run_get_new_deps
    task_gen = self.task.run()
               ^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\Documents\Github\Pacmann---Data-Storage_-Warehouse--Mart---Lake\mentoring 2\olist-dwh-project\pipeline\extract.py", line 43, in run
    os.makedirs(os.path.dirname(self.output().path), exist_ok=True)
                                ^^^^^^^^^^^^^^^^^^
AttributeError: 'list' object has no attribute 'path'
2025-06-08 06:44:44,995 - DEBUG - 1 running tasks, waiting for next task to finish
2025-06-08 06:44:45,000 - INFO - Informed scheduler that task   Extract__99914b932b   has status   FAILED
2025-06-08 06:44:45,002 - DEBUG - Asking scheduler for work...
2025-06-08 06:44:45,004 - DEBUG - Done
2025-06-08 06:44:45,006 - DEBUG - There are no more tasks to run at this time
2025-06-08 06:44:45,007 - DEBUG - There are 3 pending tasks possibly being run by other workers
2025-06-08 06:44:45,008 - DEBUG - There are 3 pending tasks unique to this worker
2025-06-08 06:44:45,009 - DEBUG - There are 3 pending tasks last scheduled by this worker
2025-06-08 06:44:45,011 - INFO - Worker Worker(salt=9778963845, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) was stopped. Shutting down Keep-Alive thread
2025-06-08 06:44:45,016 - INFO - 
===== Luigi Execution Summary =====

Scheduled 5 tasks of which:
* 1 failed:
    - 1 Extract()
* 4 were left pending, among these:
    * 3 had failed dependencies:
        - 2 Load()
        - 1 Transform()
    * 1 was not granted run permission by the scheduler:
        - 1 Extract()

This progress looks :( because there were failed tasks

===== Luigi Execution Summary =====

2025-06-08 06:45:42,592 - INFO - logging already configured
2025-06-08 06:45:42,611 - DEBUG - Checking if Extract() is complete
2025-06-08 06:45:46,739 - WARNING - Failed connecting to remote scheduler 'http://localhost:8082'
NoneType: None
2025-06-08 06:45:46,741 - INFO - Retrying attempt 2 of 3 (max)
2025-06-08 06:45:46,743 - INFO - Wait for 30 seconds
2025-06-08 06:45:47,732 - WARNING - Failed connecting to remote scheduler 'http://localhost:8082'
NoneType: None
2025-06-08 06:45:47,737 - INFO - Retrying attempt 2 of 3 (max)
2025-06-08 06:45:47,737 - INFO - Wait for 30 seconds
2025-06-08 06:46:20,837 - WARNING - Failed connecting to remote scheduler 'http://localhost:8082'
NoneType: None
2025-06-08 06:46:20,839 - INFO - Retrying attempt 3 of 3 (max)
2025-06-08 06:46:20,840 - INFO - Wait for 30 seconds
2025-06-08 06:46:21,814 - WARNING - Failed connecting to remote scheduler 'http://localhost:8082'
NoneType: None
2025-06-08 06:46:21,816 - INFO - Retrying attempt 3 of 3 (max)
2025-06-08 06:46:21,817 - INFO - Wait for 30 seconds
2025-06-08 06:46:54,911 - WARNING - Failed connecting to remote scheduler 'http://localhost:8082'
NoneType: None
2025-06-08 06:46:54,913 - INFO - Retrying attempt 4 of 3 (max)
2025-06-08 06:46:54,913 - INFO - Wait for 30 seconds
2025-06-08 06:46:54,965 - ERROR - Luigi unexpected framework error while scheduling Extract()
Traceback (most recent call last):
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\urllib3\connection.py", line 199, in _new_conn
    sock = connection.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\urllib3\util\connection.py", line 85, in create_connection
    raise err
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\urllib3\util\connection.py", line 73, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\urllib3\connectionpool.py", line 789, in urlopen
    response = self._make_request(
               ^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\urllib3\connectionpool.py", line 495, in _make_request
    conn.request(
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\urllib3\connection.py", line 441, in request
    self.endheaders()
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\http\client.py", line 1331, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\http\client.py", line 1091, in _send_output
    self.send(msg)
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\http\client.py", line 1035, in send
    self.connect()
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\urllib3\connection.py", line 279, in connect
    self.sock = self._new_conn()
                ^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\urllib3\connection.py", line 214, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x000002E5DA8D40B0>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\requests\adapters.py", line 667, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\urllib3\connectionpool.py", line 843, in urlopen
    retries = retries.increment(
              ^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\urllib3\util\retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=8082): Max retries exceeded with url: /api/add_task (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x000002E5DA8D40B0>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\rpc.py", line 185, in _fetch
    response = scheduler_retry(self._fetcher.fetch, full_url, body, self._connect_timeout)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\tenacity\__init__.py", line 475, in __call__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\tenacity\__init__.py", line 376, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\tenacity\__init__.py", line 418, in exc_check
    raise retry_exc.reraise()
          ^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\tenacity\__init__.py", line 185, in reraise
    raise self.last_attempt.result()
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\tenacity\__init__.py", line 478, in __call__
    result = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\rpc.py", line 131, in fetch
    resp = self.session.post(full_url, data=body, timeout=timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\requests\sessions.py", line 637, in post
    return self.request("POST", url, data=data, json=json, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\requests\sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\requests\sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\requests\adapters.py", line 700, in send
    raise ConnectionError(e, request=request)
requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=8082): Max retries exceeded with url: /api/add_task (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x000002E5DA8D40B0>: Failed to establish a new connection: [WinError 10061] No connection could be made because the target machine actively refused it'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 806, in add
    for next in self._add(item, is_complete):
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 911, in _add
    self._add_task(
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 635, in _add_task
    self._scheduler.add_task(*args, **kwargs)
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\scheduler.py", line 114, in rpc_func
    return self._request('/api/{}'.format(fn_name), actual_args, **request_args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\rpc.py", line 198, in _request
    page = self._fetch(url, body)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\rpc.py", line 187, in _fetch
    raise RPCError(
luigi.rpc.RPCError: Errors (3 attempts) when connecting to remote scheduler 'http://localhost:8082'
2025-06-08 06:46:55,896 - WARNING - Failed connecting to remote scheduler 'http://localhost:8082'
NoneType: None
2025-06-08 06:46:55,896 - INFO - Retrying attempt 4 of 3 (max)
2025-06-08 06:46:55,896 - INFO - Wait for 30 seconds
2025-06-08 06:46:55,896 - WARNING - Failed pinging scheduler
2025-06-08 06:46:55,902 - INFO - Worker Worker(salt=8766746346, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) was stopped. Shutting down Keep-Alive thread
2025-06-08 06:47:11,363 - INFO - logging already configured
2025-06-08 06:47:11,367 - DEBUG - Checking if Extract() is complete
2025-06-08 06:47:11,370 - INFO - Informed scheduler that task   Extract__99914b932b   has status   PENDING
2025-06-08 06:47:11,371 - DEBUG - Checking if Load() is complete
2025-06-08 06:47:11,374 - DEBUG - Checking if Extract() is complete
2025-06-08 06:47:11,376 - INFO - Informed scheduler that task   Load__99914b932b   has status   PENDING
2025-06-08 06:47:11,377 - INFO - Informed scheduler that task   Extract__99914b932b   has status   PENDING
2025-06-08 06:47:11,380 - DEBUG - Checking if Transform() is complete
2025-06-08 06:47:11,382 - DEBUG - Checking if Load() is complete
2025-06-08 06:47:11,385 - INFO - Informed scheduler that task   Transform__99914b932b   has status   PENDING
2025-06-08 06:47:11,386 - DEBUG - Checking if Extract() is complete
2025-06-08 06:47:11,388 - INFO - Informed scheduler that task   Load__99914b932b   has status   PENDING
2025-06-08 06:47:11,390 - INFO - Informed scheduler that task   Extract__99914b932b   has status   PENDING
2025-06-08 06:47:11,392 - INFO - Done scheduling tasks
2025-06-08 06:47:11,393 - INFO - Running Worker with 1 processes
2025-06-08 06:47:11,395 - DEBUG - Asking scheduler for work...
2025-06-08 06:47:11,397 - DEBUG - Pending tasks: 3
2025-06-08 06:47:11,399 - INFO - [pid 19900] Worker Worker(salt=7060865460, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) running   Extract()
2025-06-08 06:47:11,401 - ERROR - [pid 19900] Worker Worker(salt=7060865460, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) failed    Extract()
Traceback (most recent call last):
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 210, in run
    new_deps = self._run_get_new_deps()
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 138, in _run_get_new_deps
    task_gen = self.task.run()
               ^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\Documents\Github\Pacmann---Data-Storage_-Warehouse--Mart---Lake\mentoring 2\olist-dwh-project\pipeline\extract.py", line 43, in run
    os.makedirs(os.path.dirname(self.output().path), exist_ok=True)
                                ^^^^^^^^^^^^^^^^^^
AttributeError: 'list' object has no attribute 'path'
2025-06-08 06:47:11,407 - DEBUG - 1 running tasks, waiting for next task to finish
2025-06-08 06:47:11,413 - INFO - Informed scheduler that task   Extract__99914b932b   has status   FAILED
2025-06-08 06:47:11,414 - DEBUG - Asking scheduler for work...
2025-06-08 06:47:11,416 - DEBUG - Done
2025-06-08 06:47:11,417 - DEBUG - There are no more tasks to run at this time
2025-06-08 06:47:11,419 - DEBUG - There are 3 pending tasks possibly being run by other workers
2025-06-08 06:47:11,420 - DEBUG - There are 3 pending tasks unique to this worker
2025-06-08 06:47:11,422 - DEBUG - There are 3 pending tasks last scheduled by this worker
2025-06-08 06:47:11,423 - INFO - Worker Worker(salt=7060865460, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) was stopped. Shutting down Keep-Alive thread
2025-06-08 06:47:11,431 - INFO - 
===== Luigi Execution Summary =====

Scheduled 5 tasks of which:
* 1 failed:
    - 1 Extract()
* 4 were left pending, among these:
    * 3 had failed dependencies:
        - 2 Load()
        - 1 Transform()
    * 1 was not granted run permission by the scheduler:
        - 1 Extract()

This progress looks :( because there were failed tasks

===== Luigi Execution Summary =====

2025-06-08 06:48:19,859 - INFO - logging already configured
2025-06-08 06:48:19,860 - DEBUG - Checking if Extract() is complete
2025-06-08 06:48:19,863 - INFO - Informed scheduler that task   Extract__99914b932b   has status   PENDING
2025-06-08 06:48:19,865 - DEBUG - Checking if Load() is complete
2025-06-08 06:48:19,866 - DEBUG - Checking if Extract() is complete
2025-06-08 06:48:19,868 - INFO - Informed scheduler that task   Load__99914b932b   has status   PENDING
2025-06-08 06:48:19,870 - INFO - Informed scheduler that task   Extract__99914b932b   has status   PENDING
2025-06-08 06:48:19,871 - DEBUG - Checking if Transform() is complete
2025-06-08 06:48:19,874 - DEBUG - Checking if Load() is complete
2025-06-08 06:48:19,875 - INFO - Informed scheduler that task   Transform__99914b932b   has status   PENDING
2025-06-08 06:48:19,876 - DEBUG - Checking if Extract() is complete
2025-06-08 06:48:19,878 - INFO - Informed scheduler that task   Load__99914b932b   has status   PENDING
2025-06-08 06:48:19,879 - INFO - Informed scheduler that task   Extract__99914b932b   has status   PENDING
2025-06-08 06:48:19,880 - INFO - Done scheduling tasks
2025-06-08 06:48:19,882 - INFO - Running Worker with 1 processes
2025-06-08 06:48:19,883 - DEBUG - Asking scheduler for work...
2025-06-08 06:48:19,885 - DEBUG - Pending tasks: 3
2025-06-08 06:48:19,887 - INFO - [pid 19900] Worker Worker(salt=3135301880, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) running   Extract()
2025-06-08 06:48:19,889 - ERROR - [pid 19900] Worker Worker(salt=3135301880, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) failed    Extract()
Traceback (most recent call last):
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 210, in run
    new_deps = self._run_get_new_deps()
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 138, in _run_get_new_deps
    task_gen = self.task.run()
               ^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\Documents\Github\Pacmann---Data-Storage_-Warehouse--Mart---Lake\mentoring 2\olist-dwh-project\pipeline\extract.py", line 43, in run
    os.makedirs(os.path.dirname(self.output().path), exist_ok=True)
                                ^^^^^^^^^^^^^^^^^^
AttributeError: 'list' object has no attribute 'path'
2025-06-08 06:48:19,896 - DEBUG - 1 running tasks, waiting for next task to finish
2025-06-08 06:48:19,901 - INFO - Informed scheduler that task   Extract__99914b932b   has status   FAILED
2025-06-08 06:48:19,902 - DEBUG - Asking scheduler for work...
2025-06-08 06:48:19,904 - DEBUG - Done
2025-06-08 06:48:19,905 - DEBUG - There are no more tasks to run at this time
2025-06-08 06:48:19,907 - DEBUG - There are 3 pending tasks possibly being run by other workers
2025-06-08 06:48:19,908 - DEBUG - There are 3 pending tasks unique to this worker
2025-06-08 06:48:19,910 - DEBUG - There are 3 pending tasks last scheduled by this worker
2025-06-08 06:48:19,912 - INFO - Worker Worker(salt=3135301880, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=19900) was stopped. Shutting down Keep-Alive thread
2025-06-08 06:48:19,917 - INFO - 
===== Luigi Execution Summary =====

Scheduled 5 tasks of which:
* 1 failed:
    - 1 Extract()
* 4 were left pending, among these:
    * 3 had failed dependencies:
        - 2 Load()
        - 1 Transform()
    * 1 was not granted run permission by the scheduler:
        - 1 Extract()

This progress looks :( because there were failed tasks

===== Luigi Execution Summary =====

2025-06-08 13:30:59,609 - INFO - ==================================STARTING EXTRACT DATA=======================================
2025-06-08 13:31:00,284 - INFO - EXTRACT 'public.geolocation' - SUCCESS.
2025-06-08 13:31:00,302 - INFO - EXTRACT 'public.product_category_name_translation' - SUCCESS.
2025-06-08 13:31:00,335 - INFO - EXTRACT 'public.sellers' - SUCCESS.
2025-06-08 13:31:01,327 - INFO - EXTRACT 'public.customers' - SUCCESS.
2025-06-08 13:31:01,821 - INFO - EXTRACT 'public.products' - SUCCESS.
2025-06-08 13:31:03,390 - INFO - EXTRACT 'public.orders' - SUCCESS.
2025-06-08 13:31:05,062 - INFO - EXTRACT 'public.order_items' - SUCCESS.
2025-06-08 13:31:05,872 - INFO - EXTRACT 'public.order_payments' - SUCCESS.
2025-06-08 13:31:07,191 - INFO - EXTRACT 'public.order_reviews' - SUCCESS.
2025-06-08 13:31:07,191 - INFO - Extract All Tables From Sources - SUCCESS
2025-06-08 13:31:07,234 - INFO - ==================================ENDING EXTRACT DATA=======================================
2025-06-08 13:31:07,253 - INFO - [pid 21524] Worker Worker(salt=9733203241, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=21524) done      Extract()
2025-06-08 13:31:07,256 - DEBUG - 1 running tasks, waiting for next task to finish
2025-06-08 13:31:07,257 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2025-06-08 13:31:07,259 - DEBUG - Asking scheduler for work...
2025-06-08 13:31:07,261 - DEBUG - Done
2025-06-08 13:31:07,262 - DEBUG - There are no more tasks to run at this time
2025-06-08 13:31:07,264 - INFO - Worker Worker(salt=9733203241, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=21524) was stopped. Shutting down Keep-Alive thread
2025-06-08 13:31:07,270 - INFO - 
===== Luigi Execution Summary =====

Scheduled 1 tasks of which:
* 1 ran successfully:
    - 1 Extract()

This progress looks :) because there were no failed tasks or missing dependencies

===== Luigi Execution Summary =====

2025-06-08 13:31:12,153 - INFO - logging already configured
2025-06-08 13:31:12,156 - DEBUG - Checking if Extract() is complete
2025-06-08 13:31:12,158 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2025-06-08 13:31:12,160 - DEBUG - Checking if Load() is complete
2025-06-08 13:31:12,163 - DEBUG - Checking if Extract() is complete
2025-06-08 13:31:12,164 - INFO - Informed scheduler that task   Load__99914b932b   has status   PENDING
2025-06-08 13:31:12,164 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2025-06-08 13:31:12,166 - DEBUG - Checking if Transform() is complete
2025-06-08 13:31:12,169 - DEBUG - Checking if Load() is complete
2025-06-08 13:31:12,172 - INFO - Informed scheduler that task   Transform__99914b932b   has status   PENDING
2025-06-08 13:31:12,172 - DEBUG - Checking if Extract() is complete
2025-06-08 13:31:12,172 - INFO - Informed scheduler that task   Load__99914b932b   has status   PENDING
2025-06-08 13:31:12,172 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2025-06-08 13:31:12,178 - INFO - Done scheduling tasks
2025-06-08 13:31:12,181 - INFO - Running Worker with 1 processes
2025-06-08 13:31:12,182 - DEBUG - Asking scheduler for work...
2025-06-08 13:31:12,182 - DEBUG - Pending tasks: 2
2025-06-08 13:31:12,182 - INFO - [pid 21524] Worker Worker(salt=2076613884, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=21524) running   Load()
2025-06-08 13:31:12,381 - INFO - Read Load Query - SUCCESS
2025-06-08 13:31:14,331 - INFO - Read Extracted Data - SUCCESS
2025-06-08 13:31:14,333 - INFO - Connect to olist-dwh - SUCCESS
2025-06-08 13:31:14,643 - INFO - Truncate `public` Schema in olist-dwh - SUCCESS
2025-06-08 13:31:14,643 - INFO - ==================================STARTING LOAD DATA=======================================
2025-06-08 13:31:52,317 - ERROR - LOAD All Tables To olist-dwh-public - FAILED
2025-06-08 13:31:52,321 - ERROR - LOAD All Tables To DWH - FAILED
2025-06-08 13:31:52,321 - ERROR - [pid 21524] Worker Worker(salt=2076613884, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=21524) failed    Load()
Traceback (most recent call last):
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 2118, in _exec_insertmany_context
    dialect.do_execute(
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedColumn: column "False" of relation "order_reviews" does not exist
LINE 1: INSERT INTO public.order_reviews ("False", review_id, order_...
                                          ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "c:\Users\LENOVO THINKPAD\Documents\Github\Pacmann---Data-Storage_-Warehouse--Mart---Lake\mentoring 2\olist-dwh-project\pipeline\load.py", line 216, in run
    order_reviews.to_sql('order_reviews',
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\pandas\util\_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\pandas\core\generic.py", line 3087, in to_sql
    return sql.to_sql(
           ^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\pandas\io\sql.py", line 842, in to_sql
    return pandas_sql.to_sql(
           ^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\pandas\io\sql.py", line 2018, in to_sql
    total_inserted = sql_engine.insert_records(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\pandas\io\sql.py", line 1567, in insert_records
    raise err
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\pandas\io\sql.py", line 1558, in insert_records
    return table.insert(chunksize=chunksize, method=method)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\pandas\io\sql.py", line 1119, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\pandas\io\sql.py", line 1010, in _execute_insert
    result = conn.execute(self.table.insert(), data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1418, in execute
    return meth(
           ^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\sql\elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1844, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 2126, in _exec_insertmany_context
    self._handle_dbapi_exception(
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 2118, in _exec_insertmany_context
    dialect.do_execute(
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedColumn) column "False" of relation "order_reviews" does not exist
LINE 1: INSERT INTO public.order_reviews ("False", review_id, order_...
                                          ^

[SQL: INSERT INTO public.order_reviews ("False", review_id, order_id, review_score, review_comment_title, review_comment_message, review_creation_date) VALUES (%(False__0)s, %(review_id__0)s, %(order_id__0)s, %(review_score__0)s, %(review_comment_title__0) ... 174031 characters truncated ... 99)s, %(review_comment_title__999)s, %(review_comment_message__999)s, %(review_creation_date__999)s)]
[parameters: {'review_comment_message__0': None, 'order_id__0': '73fc7af87114b39712e6da79b0a377eb', 'review_creation_date__0': '2018-01-18 21:46:59', 'False__0': 0, 'review_comment_title__0': None, 'review_id__0': '7bc2406110b926393aa56f80a40eba40', 'review_score__0': 4, 'review_comment_message__1': None, 'order_id__1': 'a548910a1c6147796b98fdf73dbeba33', 'review_creation_date__1': '2018-03-11 03:05:13', 'False__1': 1, 'review_comment_title__1': None, 'review_id__1': '80e641a11e56f04c1ad469d5645fdfde', 'review_score__1': 5, 'review_comment_message__2': None, 'order_id__2': 'f9e4b658b201a9f2ecdecbb34bed034b', 'review_creation_date__2': '2018-02-18 14:36:24', 'False__2': 2, 'review_comment_title__2': None, 'review_id__2': '228ce5500dc1d8e020d8d1322874b6f0', 'review_score__2': 5, 'review_comment_message__3': 'Recebi bem antes do prazo estipulado.', 'order_id__3': '658677c97b385a9be170737859d3511b', 'review_creation_date__3': '2017-04-21 22:02:06', 'False__3': 3, 'review_comment_title__3': None, 'review_id__3': 'e64fb393e7b32834bb789ff8bb30750e', 'review_score__3': 5, 'review_comment_message__4': 'Parabns lojas lannister adorei comprar pela Internet seguro e prtico Parabns a todos feliz Pscoa', 'order_id__4': '8e6bfb81e283fa7e4f11123a3fb894f1', 'review_creation_date__4': '2018-03-02 10:26:53', 'False__4': 4, 'review_comment_title__4': None, 'review_id__4': 'f7c4243c7fe1938f181bec41a392bdeb', 'review_score__4': 5, 'review_comment_message__5': None, 'order_id__5': 'b18dcdf73be66366873cd26c5724d1dc', 'review_creation_date__5': '2018-04-16 00:39:37', 'False__5': 5, 'review_comment_title__5': None, 'review_id__5': '15197aa66ff4d0650b5434f1b46cda19', 'review_score__5': 1, 'review_comment_message__6': None, 'order_id__6': 'e48aa0d2dcec3a2e87348811bcfdf22b', 'review_creation_date__6': '2017-07-18 19:30:34', 'False__6': 6, 'review_comment_title__6': None, 'review_id__6': '07f9bee5d1b850860defd761afa7ff16', 'review_score__6': 5, 'review_comment_message__7': None ... 6900 parameters truncated ... 'review_score__992': 5, 'review_comment_message__993': None, 'order_id__993': '9d244b9671e094280e0da0b5edec38bb', 'review_creation_date__993': '2018-04-13 13:03:21', 'False__993': 993, 'review_comment_title__993': None, 'review_id__993': '6e6dbad466c0eef2b679927dfe89c052', 'review_score__993': 4, 'review_comment_message__994': None, 'order_id__994': '3b42ad87f3292fab60e143988d332da1', 'review_creation_date__994': '2018-03-17 12:18:46', 'False__994': 994, 'review_comment_title__994': None, 'review_id__994': '0a354009b25a2fbe0b25a6dd5c2a00ac', 'review_score__994': 5, 'review_comment_message__995': 'O produto no corresponde ao que eu comprei, a pelcula  muito menor que a tela do celular e no cobre toda a tela.', 'order_id__995': '286a461fcd1b94e24227817fa93f8a57', 'review_creation_date__995': '2018-03-23 18:24:18', 'False__995': 995, 'review_comment_title__995': None, 'review_id__995': 'affce0d83d9e8f6af570bc097c2e424f', 'review_score__995': 2, 'review_comment_message__996': 'produto conforme anunciado, e veio antes do prazo...perfeito', 'order_id__996': '9e7752c172e3994115a2cd609a18de29', 'review_creation_date__996': '2017-09-12 20:58:07', 'False__996': 996, 'review_comment_title__996': None, 'review_id__996': 'ca5bc3c72f83c6fb95f7f72b290a492c', 'review_score__996': 5, 'review_comment_message__997': 'Produto bom e entregue antes do previsto.', 'order_id__997': '4ab8b7a8e23908984157974ae4ad6436', 'review_creation_date__997': '2018-06-04 19:53:33', 'False__997': 997, 'review_comment_title__997': 'Produto entregue', 'review_id__997': '4d59d6249215713bfda42353af53f255', 'review_score__997': 4, 'review_comment_message__998': 'Ainda no usei em nenhuma viagem, mas parece ser muito boa.', 'order_id__998': 'b8615aa7e6248212cab23e120279acf2', 'review_creation_date__998': '2018-06-17 14:05:57', 'False__998': 998, 'review_comment_title__998': 'Boa', 'review_id__998': 'eaeafb542d4447da454cf68e302ae2bf', 'review_score__998': 4, 'review_comment_message__999': None, 'order_id__999': 'e1410714b40ecb7735ebc3f823d60745', 'review_creation_date__999': '2018-08-22 02:00:13', 'False__999': 999, 'review_comment_title__999': None, 'review_id__999': '2282d9d2a99fa789b0eb9843cfeab97e', 'review_score__999': 4}]
(Background on this error at: https://sqlalche.me/e/20/f405)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\Users\LENOVO THINKPAD\Documents\Github\Pacmann---Data-Storage_-Warehouse--Mart---Lake\mentoring 2\olist-dwh-project\pipeline\load.py", line 226, in run
    raise Exception('Failed Load Tables To olist-dwh-public')
Exception: Failed Load Tables To olist-dwh-public

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 210, in run
    new_deps = self._run_get_new_deps()
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 138, in _run_get_new_deps
    task_gen = self.task.run()
               ^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\Documents\Github\Pacmann---Data-Storage_-Warehouse--Mart---Lake\mentoring 2\olist-dwh-project\pipeline\load.py", line 294, in run
    raise Exception('Failed Load Tables To DWH')
Exception: Failed Load Tables To DWH
2025-06-08 13:31:52,525 - DEBUG - 1 running tasks, waiting for next task to finish
2025-06-08 13:31:52,541 - INFO - Informed scheduler that task   Load__99914b932b   has status   FAILED
2025-06-08 13:31:52,543 - DEBUG - Asking scheduler for work...
2025-06-08 13:31:52,543 - DEBUG - Done
2025-06-08 13:31:52,543 - DEBUG - There are no more tasks to run at this time
2025-06-08 13:31:52,547 - DEBUG - There are 2 pending tasks possibly being run by other workers
2025-06-08 13:31:52,547 - DEBUG - There are 2 pending tasks unique to this worker
2025-06-08 13:31:52,549 - DEBUG - There are 2 pending tasks last scheduled by this worker
2025-06-08 13:31:52,549 - INFO - Worker Worker(salt=2076613884, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=21524) was stopped. Shutting down Keep-Alive thread
2025-06-08 13:31:52,555 - INFO - 
===== Luigi Execution Summary =====

Scheduled 3 tasks of which:
* 1 complete ones were encountered:
    - 1 Extract()
* 1 failed:
    - 1 Load()
* 1 were left pending, among these:
    * 1 had failed dependencies:
        - 1 Transform()

This progress looks :( because there were failed tasks

===== Luigi Execution Summary =====

2025-06-08 13:33:40,750 - INFO - logging already configured
2025-06-08 13:33:40,754 - DEBUG - Checking if Extract() is complete
2025-06-08 13:33:40,757 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2025-06-08 13:33:40,758 - DEBUG - Checking if Load() is complete
2025-06-08 13:33:40,760 - INFO - Informed scheduler that task   Load__99914b932b   has status   DONE
2025-06-08 13:33:40,761 - DEBUG - Checking if Transform() is complete
2025-06-08 13:33:40,764 - DEBUG - Checking if Load() is complete
2025-06-08 13:33:40,766 - INFO - Informed scheduler that task   Transform__99914b932b   has status   PENDING
2025-06-08 13:33:40,767 - INFO - Informed scheduler that task   Load__99914b932b   has status   DONE
2025-06-08 13:33:40,769 - INFO - Done scheduling tasks
2025-06-08 13:33:40,770 - INFO - Running Worker with 1 processes
2025-06-08 13:33:40,771 - DEBUG - Asking scheduler for work...
2025-06-08 13:33:40,773 - DEBUG - Pending tasks: 1
2025-06-08 13:33:40,774 - INFO - [pid 21524] Worker Worker(salt=8516523235, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=21524) running   Transform()
2025-06-08 13:33:40,778 - INFO - Connect to DWH - SUCCESS
2025-06-08 13:33:40,941 - INFO - Read Transform Query - SUCCESS
2025-06-08 13:33:40,942 - INFO - ==================================STARTING TRANSFROM DATA=======================================
2025-06-08 13:33:41,191 - INFO - Transform to 'dwh.dim_geolocation' - SUCCESS
2025-06-08 13:33:41,201 - INFO - Transform to 'dwh.dim_product_category' - SUCCESS
2025-06-08 13:33:41,240 - INFO - Transform to 'dwh.dim_sellers' - SUCCESS
2025-06-08 13:33:41,939 - INFO - Transform to 'dwh.dim_customers' - SUCCESS
2025-06-08 13:33:41,939 - ERROR - Transform to All Dimensions and Fact Tables - FAILED
2025-06-08 13:33:41,939 - ERROR - Transform Tables - FAILED
2025-06-08 13:33:41,939 - ERROR - [pid 21524] Worker Worker(salt=8516523235, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=21524) failed    Transform()
Traceback (most recent call last):
  File "c:\Users\LENOVO THINKPAD\Documents\Github\Pacmann---Data-Storage_-Warehouse--Mart---Lake\mentoring 2\olist-dwh-project\pipeline\transform.py", line 128, in run
    query = sqlalchemy.text(dim_product_query)
                            ^^^^^^^^^^^^^^^^^
NameError: name 'dim_product_query' is not defined. Did you mean: 'dim_products_query'?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 210, in run
    new_deps = self._run_get_new_deps()
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 138, in _run_get_new_deps
    task_gen = self.task.run()
               ^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\Documents\Github\Pacmann---Data-Storage_-Warehouse--Mart---Lake\mentoring 2\olist-dwh-project\pipeline\transform.py", line 192, in run
    raise Exception('Failed Transforming Tables')
Exception: Failed Transforming Tables
2025-06-08 13:33:41,955 - DEBUG - 1 running tasks, waiting for next task to finish
2025-06-08 13:33:41,955 - INFO - Informed scheduler that task   Transform__99914b932b   has status   FAILED
2025-06-08 13:33:41,962 - DEBUG - Asking scheduler for work...
2025-06-08 13:33:41,964 - DEBUG - Done
2025-06-08 13:33:41,966 - DEBUG - There are no more tasks to run at this time
2025-06-08 13:33:41,966 - DEBUG - There are 1 pending tasks possibly being run by other workers
2025-06-08 13:33:41,966 - DEBUG - There are 1 pending tasks unique to this worker
2025-06-08 13:33:41,970 - DEBUG - There are 1 pending tasks last scheduled by this worker
2025-06-08 13:33:41,970 - INFO - Worker Worker(salt=8516523235, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=21524) was stopped. Shutting down Keep-Alive thread
2025-06-08 13:33:42,104 - INFO - 
===== Luigi Execution Summary =====

Scheduled 3 tasks of which:
* 2 complete ones were encountered:
    - 1 Extract()
    - 1 Load()
* 1 failed:
    - 1 Transform()

This progress looks :( because there were failed tasks

===== Luigi Execution Summary =====

2025-06-08 13:34:43,424 - INFO - logging already configured
2025-06-08 13:34:43,428 - DEBUG - Checking if Extract() is complete
2025-06-08 13:34:43,430 - INFO - Informed scheduler that task   Extract__99914b932b   has status   PENDING
2025-06-08 13:34:43,433 - DEBUG - Checking if Load() is complete
2025-06-08 13:34:43,434 - DEBUG - Checking if Extract() is complete
2025-06-08 13:34:43,437 - INFO - Informed scheduler that task   Load__99914b932b   has status   PENDING
2025-06-08 13:34:43,437 - INFO - Informed scheduler that task   Extract__99914b932b   has status   PENDING
2025-06-08 13:34:43,440 - DEBUG - Checking if Transform() is complete
2025-06-08 13:34:43,442 - DEBUG - Checking if Load() is complete
2025-06-08 13:34:43,445 - INFO - Informed scheduler that task   Transform__99914b932b   has status   PENDING
2025-06-08 13:34:43,446 - DEBUG - Checking if Extract() is complete
2025-06-08 13:34:43,448 - INFO - Informed scheduler that task   Load__99914b932b   has status   PENDING
2025-06-08 13:34:43,450 - INFO - Informed scheduler that task   Extract__99914b932b   has status   PENDING
2025-06-08 13:34:43,451 - INFO - Done scheduling tasks
2025-06-08 13:34:43,453 - INFO - Running Worker with 1 processes
2025-06-08 13:34:43,454 - DEBUG - Asking scheduler for work...
2025-06-08 13:34:43,455 - DEBUG - Pending tasks: 3
2025-06-08 13:34:43,457 - INFO - [pid 21524] Worker Worker(salt=5774065101, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=21524) running   Extract()
2025-06-08 13:34:43,460 - ERROR - [pid 21524] Worker Worker(salt=5774065101, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=21524) failed    Extract()
Traceback (most recent call last):
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 210, in run
    new_deps = self._run_get_new_deps()
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 138, in _run_get_new_deps
    task_gen = self.task.run()
               ^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\Documents\Github\Pacmann---Data-Storage_-Warehouse--Mart---Lake\mentoring 2\olist-dwh-project\pipeline\extract.py", line 43, in run
    # Configure logging
                        
AttributeError: 'list' object has no attribute 'path'
2025-06-08 13:34:43,506 - DEBUG - 1 running tasks, waiting for next task to finish
2025-06-08 13:34:43,529 - INFO - Informed scheduler that task   Extract__99914b932b   has status   FAILED
2025-06-08 13:34:43,533 - DEBUG - Asking scheduler for work...
2025-06-08 13:34:43,536 - DEBUG - Done
2025-06-08 13:34:43,537 - DEBUG - There are no more tasks to run at this time
2025-06-08 13:34:43,539 - DEBUG - There are 3 pending tasks possibly being run by other workers
2025-06-08 13:34:43,540 - DEBUG - There are 3 pending tasks unique to this worker
2025-06-08 13:34:43,541 - DEBUG - There are 3 pending tasks last scheduled by this worker
2025-06-08 13:34:43,553 - INFO - Worker Worker(salt=5774065101, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=21524) was stopped. Shutting down Keep-Alive thread
2025-06-08 13:34:43,565 - INFO - 
===== Luigi Execution Summary =====

Scheduled 3 tasks of which:
* 1 failed:
    - 1 Extract()
* 2 were left pending, among these:
    * 2 had failed dependencies:
        - 1 Load()
        - 1 Transform()

This progress looks :( because there were failed tasks

===== Luigi Execution Summary =====

2025-06-08 13:35:33,348 - INFO - logging already configured
2025-06-08 13:35:33,353 - DEBUG - Checking if Extract() is complete
2025-06-08 13:35:33,356 - INFO - Informed scheduler that task   Extract__99914b932b   has status   PENDING
2025-06-08 13:35:33,359 - DEBUG - Checking if Load() is complete
2025-06-08 13:35:33,361 - DEBUG - Checking if Extract() is complete
2025-06-08 13:35:33,362 - INFO - Informed scheduler that task   Load__99914b932b   has status   PENDING
2025-06-08 13:35:33,364 - INFO - Informed scheduler that task   Extract__99914b932b   has status   PENDING
2025-06-08 13:35:33,365 - DEBUG - Checking if Transform() is complete
2025-06-08 13:35:33,369 - DEBUG - Checking if Load() is complete
2025-06-08 13:35:33,371 - INFO - Informed scheduler that task   Transform__99914b932b   has status   PENDING
2025-06-08 13:35:33,373 - DEBUG - Checking if Extract() is complete
2025-06-08 13:35:33,375 - INFO - Informed scheduler that task   Load__99914b932b   has status   PENDING
2025-06-08 13:35:33,377 - INFO - Informed scheduler that task   Extract__99914b932b   has status   PENDING
2025-06-08 13:35:33,378 - INFO - Done scheduling tasks
2025-06-08 13:35:33,379 - INFO - Running Worker with 1 processes
2025-06-08 13:35:33,380 - DEBUG - Asking scheduler for work...
2025-06-08 13:35:33,382 - DEBUG - Pending tasks: 3
2025-06-08 13:35:33,384 - INFO - [pid 21524] Worker Worker(salt=052335110, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=21524) running   Extract()
2025-06-08 13:35:33,387 - ERROR - [pid 21524] Worker Worker(salt=052335110, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=21524) failed    Extract()
Traceback (most recent call last):
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 210, in run
    new_deps = self._run_get_new_deps()
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 138, in _run_get_new_deps
    task_gen = self.task.run()
               ^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\Documents\Github\Pacmann---Data-Storage_-Warehouse--Mart---Lake\mentoring 2\olist-dwh-project\pipeline\extract.py", line 43, in run
    # Configure logging
                        
AttributeError: 'list' object has no attribute 'path'
2025-06-08 13:35:33,393 - DEBUG - 1 running tasks, waiting for next task to finish
2025-06-08 13:35:33,400 - INFO - Informed scheduler that task   Extract__99914b932b   has status   FAILED
2025-06-08 13:35:33,402 - DEBUG - Asking scheduler for work...
2025-06-08 13:35:33,403 - DEBUG - Done
2025-06-08 13:35:33,405 - DEBUG - There are no more tasks to run at this time
2025-06-08 13:35:33,407 - DEBUG - There are 3 pending tasks possibly being run by other workers
2025-06-08 13:35:33,408 - DEBUG - There are 3 pending tasks unique to this worker
2025-06-08 13:35:33,409 - DEBUG - There are 3 pending tasks last scheduled by this worker
2025-06-08 13:35:33,410 - INFO - Worker Worker(salt=052335110, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=21524) was stopped. Shutting down Keep-Alive thread
2025-06-08 13:35:33,436 - INFO - 
===== Luigi Execution Summary =====

Scheduled 3 tasks of which:
* 1 failed:
    - 1 Extract()
* 2 were left pending, among these:
    * 2 had failed dependencies:
        - 1 Load()
        - 1 Transform()

This progress looks :( because there were failed tasks

===== Luigi Execution Summary =====

2025-06-08 13:35:37,721 - INFO - logging already configured
2025-06-08 13:35:37,724 - DEBUG - Checking if Extract() is complete
2025-06-08 13:35:37,727 - INFO - Informed scheduler that task   Extract__99914b932b   has status   PENDING
2025-06-08 13:35:37,729 - DEBUG - Checking if Load() is complete
2025-06-08 13:35:37,731 - DEBUG - Checking if Extract() is complete
2025-06-08 13:35:37,734 - INFO - Informed scheduler that task   Load__99914b932b   has status   PENDING
2025-06-08 13:35:37,735 - INFO - Informed scheduler that task   Extract__99914b932b   has status   PENDING
2025-06-08 13:35:37,735 - DEBUG - Checking if Transform() is complete
2025-06-08 13:35:37,738 - DEBUG - Checking if Load() is complete
2025-06-08 13:35:37,740 - INFO - Informed scheduler that task   Transform__99914b932b   has status   PENDING
2025-06-08 13:35:37,741 - DEBUG - Checking if Extract() is complete
2025-06-08 13:35:37,743 - INFO - Informed scheduler that task   Load__99914b932b   has status   PENDING
2025-06-08 13:35:37,745 - INFO - Informed scheduler that task   Extract__99914b932b   has status   PENDING
2025-06-08 13:35:37,746 - INFO - Done scheduling tasks
2025-06-08 13:35:37,748 - INFO - Running Worker with 1 processes
2025-06-08 13:35:37,750 - DEBUG - Asking scheduler for work...
2025-06-08 13:35:37,751 - DEBUG - Pending tasks: 3
2025-06-08 13:35:37,752 - INFO - [pid 21524] Worker Worker(salt=8341598592, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=21524) running   Extract()
2025-06-08 13:35:37,754 - ERROR - [pid 21524] Worker Worker(salt=8341598592, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=21524) failed    Extract()
Traceback (most recent call last):
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 210, in run
    new_deps = self._run_get_new_deps()
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 138, in _run_get_new_deps
    task_gen = self.task.run()
               ^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\Documents\Github\Pacmann---Data-Storage_-Warehouse--Mart---Lake\mentoring 2\olist-dwh-project\pipeline\extract.py", line 43, in run
    # Configure logging
                        
AttributeError: 'list' object has no attribute 'path'
2025-06-08 13:35:37,759 - DEBUG - 1 running tasks, waiting for next task to finish
2025-06-08 13:35:37,765 - INFO - Informed scheduler that task   Extract__99914b932b   has status   FAILED
2025-06-08 13:35:37,767 - DEBUG - Asking scheduler for work...
2025-06-08 13:35:37,768 - DEBUG - Done
2025-06-08 13:35:37,769 - DEBUG - There are no more tasks to run at this time
2025-06-08 13:35:37,770 - DEBUG - There are 3 pending tasks possibly being run by other workers
2025-06-08 13:35:37,771 - DEBUG - There are 3 pending tasks unique to this worker
2025-06-08 13:35:37,773 - DEBUG - There are 3 pending tasks last scheduled by this worker
2025-06-08 13:35:37,775 - INFO - Worker Worker(salt=8341598592, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=21524) was stopped. Shutting down Keep-Alive thread
2025-06-08 13:35:37,782 - INFO - 
===== Luigi Execution Summary =====

Scheduled 3 tasks of which:
* 1 failed:
    - 1 Extract()
* 2 were left pending, among these:
    * 2 had failed dependencies:
        - 1 Load()
        - 1 Transform()

This progress looks :( because there were failed tasks

===== Luigi Execution Summary =====

2025-06-08 13:35:45,041 - INFO - logging already configured
2025-06-08 13:35:45,044 - DEBUG - Checking if Extract() is complete
2025-06-08 13:35:45,047 - INFO - Informed scheduler that task   Extract__99914b932b   has status   PENDING
2025-06-08 13:35:45,050 - DEBUG - Checking if Load() is complete
2025-06-08 13:35:45,053 - DEBUG - Checking if Extract() is complete
2025-06-08 13:35:45,057 - INFO - Informed scheduler that task   Load__99914b932b   has status   PENDING
2025-06-08 13:35:45,058 - INFO - Informed scheduler that task   Extract__99914b932b   has status   PENDING
2025-06-08 13:35:45,058 - DEBUG - Checking if Transform() is complete
2025-06-08 13:35:45,058 - DEBUG - Checking if Load() is complete
2025-06-08 13:35:45,063 - INFO - Informed scheduler that task   Transform__99914b932b   has status   PENDING
2025-06-08 13:35:45,067 - DEBUG - Checking if Extract() is complete
2025-06-08 13:35:45,070 - INFO - Informed scheduler that task   Load__99914b932b   has status   PENDING
2025-06-08 13:35:45,071 - INFO - Informed scheduler that task   Extract__99914b932b   has status   PENDING
2025-06-08 13:35:45,073 - INFO - Done scheduling tasks
2025-06-08 13:35:45,074 - INFO - Running Worker with 1 processes
2025-06-08 13:35:45,076 - DEBUG - Asking scheduler for work...
2025-06-08 13:35:45,078 - DEBUG - Pending tasks: 3
2025-06-08 13:35:45,078 - INFO - [pid 21524] Worker Worker(salt=9201502949, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=21524) running   Extract()
2025-06-08 13:35:45,080 - ERROR - [pid 21524] Worker Worker(salt=9201502949, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=21524) failed    Extract()
Traceback (most recent call last):
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 210, in run
    new_deps = self._run_get_new_deps()
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 138, in _run_get_new_deps
    task_gen = self.task.run()
               ^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\Documents\Github\Pacmann---Data-Storage_-Warehouse--Mart---Lake\mentoring 2\olist-dwh-project\pipeline\extract.py", line 43, in run
    # Configure logging
                        
AttributeError: 'list' object has no attribute 'path'
2025-06-08 13:35:45,111 - DEBUG - 1 running tasks, waiting for next task to finish
2025-06-08 13:35:45,119 - INFO - Informed scheduler that task   Extract__99914b932b   has status   FAILED
2025-06-08 13:35:45,121 - DEBUG - Asking scheduler for work...
2025-06-08 13:35:45,123 - DEBUG - Done
2025-06-08 13:35:45,123 - DEBUG - There are no more tasks to run at this time
2025-06-08 13:35:45,123 - DEBUG - There are 3 pending tasks possibly being run by other workers
2025-06-08 13:35:45,128 - DEBUG - There are 3 pending tasks unique to this worker
2025-06-08 13:35:45,128 - DEBUG - There are 3 pending tasks last scheduled by this worker
2025-06-08 13:35:45,128 - INFO - Worker Worker(salt=9201502949, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=21524) was stopped. Shutting down Keep-Alive thread
2025-06-08 13:35:45,136 - INFO - 
===== Luigi Execution Summary =====

Scheduled 3 tasks of which:
* 1 failed:
    - 1 Extract()
* 2 were left pending, among these:
    * 2 had failed dependencies:
        - 1 Load()
        - 1 Transform()

This progress looks :( because there were failed tasks

===== Luigi Execution Summary =====

2025-06-08 13:35:54,593 - INFO - logging already configured
2025-06-08 13:35:54,604 - DEBUG - Checking if Extract() is complete
2025-06-08 13:35:54,608 - INFO - Informed scheduler that task   Extract__99914b932b   has status   PENDING
2025-06-08 13:35:54,612 - DEBUG - Checking if Load() is complete
2025-06-08 13:35:54,615 - DEBUG - Checking if Extract() is complete
2025-06-08 13:35:54,618 - INFO - Informed scheduler that task   Load__99914b932b   has status   PENDING
2025-06-08 13:35:54,621 - INFO - Informed scheduler that task   Extract__99914b932b   has status   PENDING
2025-06-08 13:35:54,622 - DEBUG - Checking if Transform() is complete
2025-06-08 13:35:54,629 - DEBUG - Checking if Load() is complete
2025-06-08 13:35:54,631 - INFO - Informed scheduler that task   Transform__99914b932b   has status   PENDING
2025-06-08 13:35:54,634 - DEBUG - Checking if Extract() is complete
2025-06-08 13:35:54,636 - INFO - Informed scheduler that task   Load__99914b932b   has status   PENDING
2025-06-08 13:35:54,639 - INFO - Informed scheduler that task   Extract__99914b932b   has status   PENDING
2025-06-08 13:35:54,639 - INFO - Done scheduling tasks
2025-06-08 13:35:54,639 - INFO - Running Worker with 1 processes
2025-06-08 13:35:54,639 - DEBUG - Asking scheduler for work...
2025-06-08 13:35:54,639 - DEBUG - Pending tasks: 3
2025-06-08 13:35:54,639 - INFO - [pid 21524] Worker Worker(salt=6312873605, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=21524) running   Extract()
2025-06-08 13:35:54,647 - ERROR - [pid 21524] Worker Worker(salt=6312873605, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=21524) failed    Extract()
Traceback (most recent call last):
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 210, in run
    new_deps = self._run_get_new_deps()
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 138, in _run_get_new_deps
    task_gen = self.task.run()
               ^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\Documents\Github\Pacmann---Data-Storage_-Warehouse--Mart---Lake\mentoring 2\olist-dwh-project\pipeline\extract.py", line 43, in run
    # Configure logging
                        
AttributeError: 'list' object has no attribute 'path'
2025-06-08 13:35:54,647 - DEBUG - 1 running tasks, waiting for next task to finish
2025-06-08 13:35:54,655 - INFO - Informed scheduler that task   Extract__99914b932b   has status   FAILED
2025-06-08 13:35:54,657 - DEBUG - Asking scheduler for work...
2025-06-08 13:35:54,659 - DEBUG - Done
2025-06-08 13:35:54,659 - DEBUG - There are no more tasks to run at this time
2025-06-08 13:35:54,659 - DEBUG - There are 3 pending tasks possibly being run by other workers
2025-06-08 13:35:54,659 - DEBUG - There are 3 pending tasks unique to this worker
2025-06-08 13:35:54,663 - DEBUG - There are 3 pending tasks last scheduled by this worker
2025-06-08 13:35:54,665 - INFO - Worker Worker(salt=6312873605, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=21524) was stopped. Shutting down Keep-Alive thread
2025-06-08 13:35:54,672 - INFO - 
===== Luigi Execution Summary =====

Scheduled 3 tasks of which:
* 1 failed:
    - 1 Extract()
* 2 were left pending, among these:
    * 2 had failed dependencies:
        - 1 Load()
        - 1 Transform()

This progress looks :( because there were failed tasks

===== Luigi Execution Summary =====

2025-06-08 13:36:10,279 - INFO - logging already configured
2025-06-08 13:36:10,282 - DEBUG - Checking if Extract() is complete
2025-06-08 13:36:10,283 - INFO - Informed scheduler that task   Extract__99914b932b   has status   PENDING
2025-06-08 13:36:10,284 - INFO - Done scheduling tasks
2025-06-08 13:36:10,286 - INFO - Running Worker with 1 processes
2025-06-08 13:36:10,286 - DEBUG - Asking scheduler for work...
2025-06-08 13:36:10,288 - DEBUG - Pending tasks: 1
2025-06-08 13:36:10,289 - INFO - [pid 21524] Worker Worker(salt=4627061099, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=21524) running   Extract()
2025-06-08 13:36:10,291 - ERROR - [pid 21524] Worker Worker(salt=4627061099, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=21524) failed    Extract()
Traceback (most recent call last):
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 210, in run
    new_deps = self._run_get_new_deps()
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 138, in _run_get_new_deps
    task_gen = self.task.run()
               ^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\Documents\Github\Pacmann---Data-Storage_-Warehouse--Mart---Lake\mentoring 2\olist-dwh-project\pipeline\extract.py", line 43, in run
    # Configure logging
                        
AttributeError: 'list' object has no attribute 'path'
2025-06-08 13:36:10,295 - DEBUG - 1 running tasks, waiting for next task to finish
2025-06-08 13:36:10,302 - INFO - Informed scheduler that task   Extract__99914b932b   has status   FAILED
2025-06-08 13:36:10,304 - DEBUG - Asking scheduler for work...
2025-06-08 13:36:10,305 - DEBUG - Done
2025-06-08 13:36:10,307 - DEBUG - There are no more tasks to run at this time
2025-06-08 13:36:10,308 - DEBUG - There are 1 pending tasks possibly being run by other workers
2025-06-08 13:36:10,309 - DEBUG - There are 1 pending tasks unique to this worker
2025-06-08 13:36:10,311 - DEBUG - There are 1 pending tasks last scheduled by this worker
2025-06-08 13:36:10,313 - INFO - Worker Worker(salt=4627061099, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=21524) was stopped. Shutting down Keep-Alive thread
2025-06-08 13:36:10,319 - INFO - 
===== Luigi Execution Summary =====

Scheduled 1 tasks of which:
* 1 failed:
    - 1 Extract()

This progress looks :( because there were failed tasks

===== Luigi Execution Summary =====

2025-06-08 13:36:15,775 - INFO - logging already configured
2025-06-08 13:36:15,781 - DEBUG - Checking if Extract() is complete
2025-06-08 13:36:15,784 - INFO - Informed scheduler that task   Extract__99914b932b   has status   PENDING
2025-06-08 13:36:15,786 - INFO - Done scheduling tasks
2025-06-08 13:36:15,787 - INFO - Running Worker with 1 processes
2025-06-08 13:36:15,788 - DEBUG - Asking scheduler for work...
2025-06-08 13:36:15,791 - DEBUG - Pending tasks: 1
2025-06-08 13:36:15,792 - INFO - [pid 21524] Worker Worker(salt=9629022003, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=21524) running   Extract()
2025-06-08 13:36:15,794 - ERROR - [pid 21524] Worker Worker(salt=9629022003, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=21524) failed    Extract()
Traceback (most recent call last):
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 210, in run
    new_deps = self._run_get_new_deps()
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 138, in _run_get_new_deps
    task_gen = self.task.run()
               ^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\Documents\Github\Pacmann---Data-Storage_-Warehouse--Mart---Lake\mentoring 2\olist-dwh-project\pipeline\extract.py", line 43, in run
    # Configure logging
                        
AttributeError: 'list' object has no attribute 'path'
2025-06-08 13:36:15,798 - DEBUG - 1 running tasks, waiting for next task to finish
2025-06-08 13:36:15,806 - INFO - Informed scheduler that task   Extract__99914b932b   has status   FAILED
2025-06-08 13:36:15,807 - DEBUG - Asking scheduler for work...
2025-06-08 13:36:15,809 - DEBUG - Done
2025-06-08 13:36:15,810 - DEBUG - There are no more tasks to run at this time
2025-06-08 13:36:15,812 - DEBUG - There are 1 pending tasks possibly being run by other workers
2025-06-08 13:36:15,813 - DEBUG - There are 1 pending tasks unique to this worker
2025-06-08 13:36:15,814 - DEBUG - There are 1 pending tasks last scheduled by this worker
2025-06-08 13:36:15,816 - INFO - Worker Worker(salt=9629022003, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=21524) was stopped. Shutting down Keep-Alive thread
2025-06-08 13:36:15,823 - INFO - 
===== Luigi Execution Summary =====

Scheduled 1 tasks of which:
* 1 failed:
    - 1 Extract()

This progress looks :( because there were failed tasks

===== Luigi Execution Summary =====

2025-06-08 13:36:22,169 - INFO - logging already configured
2025-06-08 13:36:22,172 - DEBUG - Checking if Extract() is complete
2025-06-08 13:36:22,175 - INFO - Informed scheduler that task   Extract__99914b932b   has status   PENDING
2025-06-08 13:36:22,175 - INFO - Done scheduling tasks
2025-06-08 13:36:22,176 - INFO - Running Worker with 1 processes
2025-06-08 13:36:22,177 - DEBUG - Asking scheduler for work...
2025-06-08 13:36:22,178 - DEBUG - Pending tasks: 1
2025-06-08 13:36:22,179 - INFO - [pid 21524] Worker Worker(salt=5488709323, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=21524) running   Extract()
2025-06-08 13:36:22,184 - INFO - ==================================STARTING EXTRACT DATA=======================================
2025-06-08 13:36:22,479 - INFO - EXTRACT 'public.geolocation' - SUCCESS.
2025-06-08 13:36:22,491 - INFO - EXTRACT 'public.product_category_name_translation' - SUCCESS.
2025-06-08 13:36:22,521 - INFO - EXTRACT 'public.sellers' - SUCCESS.
2025-06-08 13:36:23,682 - INFO - EXTRACT 'public.customers' - SUCCESS.
2025-06-08 13:36:24,093 - INFO - EXTRACT 'public.products' - SUCCESS.
2025-06-08 13:36:25,436 - INFO - EXTRACT 'public.orders' - SUCCESS.
2025-06-08 13:36:27,189 - INFO - EXTRACT 'public.order_items' - SUCCESS.
2025-06-08 13:36:28,047 - INFO - EXTRACT 'public.order_payments' - SUCCESS.
2025-06-08 13:36:29,203 - INFO - EXTRACT 'public.order_reviews' - SUCCESS.
2025-06-08 13:36:29,204 - INFO - Extract All Tables From Sources - SUCCESS
2025-06-08 13:36:29,207 - INFO - ==================================ENDING EXTRACT DATA=======================================
2025-06-08 13:36:29,224 - INFO - [pid 21524] Worker Worker(salt=5488709323, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=21524) done      Extract()
2025-06-08 13:36:29,227 - DEBUG - 1 running tasks, waiting for next task to finish
2025-06-08 13:36:29,229 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2025-06-08 13:36:29,230 - DEBUG - Asking scheduler for work...
2025-06-08 13:36:29,233 - DEBUG - Done
2025-06-08 13:36:29,234 - DEBUG - There are no more tasks to run at this time
2025-06-08 13:36:29,237 - INFO - Worker Worker(salt=5488709323, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=21524) was stopped. Shutting down Keep-Alive thread
2025-06-08 13:36:29,244 - INFO - 
===== Luigi Execution Summary =====

Scheduled 1 tasks of which:
* 1 ran successfully:
    - 1 Extract()

This progress looks :) because there were no failed tasks or missing dependencies

===== Luigi Execution Summary =====

2025-06-08 13:36:33,562 - INFO - logging already configured
2025-06-08 13:36:33,567 - DEBUG - Checking if Extract() is complete
2025-06-08 13:36:33,570 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2025-06-08 13:36:33,572 - DEBUG - Checking if Load() is complete
2025-06-08 13:36:33,575 - DEBUG - Checking if Extract() is complete
2025-06-08 13:36:33,578 - INFO - Informed scheduler that task   Load__99914b932b   has status   PENDING
2025-06-08 13:36:33,582 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2025-06-08 13:36:33,585 - DEBUG - Checking if Transform() is complete
2025-06-08 13:36:33,589 - DEBUG - Checking if Load() is complete
2025-06-08 13:36:33,595 - INFO - Informed scheduler that task   Transform__99914b932b   has status   PENDING
2025-06-08 13:36:33,599 - DEBUG - Checking if Extract() is complete
2025-06-08 13:36:33,602 - INFO - Informed scheduler that task   Load__99914b932b   has status   PENDING
2025-06-08 13:36:33,606 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2025-06-08 13:36:33,609 - INFO - Done scheduling tasks
2025-06-08 13:36:33,611 - INFO - Running Worker with 1 processes
2025-06-08 13:36:33,612 - DEBUG - Asking scheduler for work...
2025-06-08 13:36:33,614 - DEBUG - Pending tasks: 2
2025-06-08 13:36:33,616 - INFO - [pid 21524] Worker Worker(salt=270523053, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=21524) running   Load()
2025-06-08 13:36:33,621 - INFO - Read Load Query - SUCCESS
2025-06-08 13:36:35,838 - INFO - Read Extracted Data - SUCCESS
2025-06-08 13:36:35,839 - INFO - Connect to olist-dwh - SUCCESS
2025-06-08 13:36:36,077 - INFO - Truncate `public` Schema in olist-dwh - SUCCESS
2025-06-08 13:36:36,078 - INFO - ==================================STARTING LOAD DATA=======================================
2025-06-08 13:37:13,240 - ERROR - LOAD All Tables To olist-dwh-public - FAILED
2025-06-08 13:37:13,248 - ERROR - LOAD All Tables To DWH - FAILED
2025-06-08 13:37:13,248 - ERROR - [pid 21524] Worker Worker(salt=270523053, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=21524) failed    Load()
Traceback (most recent call last):
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 2118, in _exec_insertmany_context
    dialect.do_execute(
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedColumn: column "False" of relation "order_reviews" does not exist
LINE 1: INSERT INTO public.order_reviews ("False", review_id, order_...
                                          ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "c:\Users\LENOVO THINKPAD\Documents\Github\Pacmann---Data-Storage_-Warehouse--Mart---Lake\mentoring 2\olist-dwh-project\pipeline\load.py", line 216, in run
    order_payments.to_sql('order_payments',
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\pandas\util\_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\pandas\core\generic.py", line 3087, in to_sql
    return sql.to_sql(
           ^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\pandas\io\sql.py", line 842, in to_sql
    return pandas_sql.to_sql(
           ^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\pandas\io\sql.py", line 2018, in to_sql
    total_inserted = sql_engine.insert_records(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\pandas\io\sql.py", line 1567, in insert_records
    raise err
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\pandas\io\sql.py", line 1558, in insert_records
    return table.insert(chunksize=chunksize, method=method)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\pandas\io\sql.py", line 1119, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\pandas\io\sql.py", line 1010, in _execute_insert
    result = conn.execute(self.table.insert(), data)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1418, in execute
    return meth(
           ^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\sql\elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 1844, in _execute_context
    return self._exec_insertmany_context(dialect, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 2126, in _exec_insertmany_context
    self._handle_dbapi_exception(
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\base.py", line 2118, in _exec_insertmany_context
    dialect.do_execute(
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedColumn) column "False" of relation "order_reviews" does not exist
LINE 1: INSERT INTO public.order_reviews ("False", review_id, order_...
                                          ^

[SQL: INSERT INTO public.order_reviews ("False", review_id, order_id, review_score, review_comment_title, review_comment_message, review_creation_date) VALUES (%(False__0)s, %(review_id__0)s, %(order_id__0)s, %(review_score__0)s, %(review_comment_title__0) ... 174031 characters truncated ... 99)s, %(review_comment_title__999)s, %(review_comment_message__999)s, %(review_creation_date__999)s)]
[parameters: {'review_comment_message__0': None, 'order_id__0': '73fc7af87114b39712e6da79b0a377eb', 'review_creation_date__0': '2018-01-18 21:46:59', 'False__0': 0, 'review_comment_title__0': None, 'review_id__0': '7bc2406110b926393aa56f80a40eba40', 'review_score__0': 4, 'review_comment_message__1': None, 'order_id__1': 'a548910a1c6147796b98fdf73dbeba33', 'review_creation_date__1': '2018-03-11 03:05:13', 'False__1': 1, 'review_comment_title__1': None, 'review_id__1': '80e641a11e56f04c1ad469d5645fdfde', 'review_score__1': 5, 'review_comment_message__2': None, 'order_id__2': 'f9e4b658b201a9f2ecdecbb34bed034b', 'review_creation_date__2': '2018-02-18 14:36:24', 'False__2': 2, 'review_comment_title__2': None, 'review_id__2': '228ce5500dc1d8e020d8d1322874b6f0', 'review_score__2': 5, 'review_comment_message__3': 'Recebi bem antes do prazo estipulado.', 'order_id__3': '658677c97b385a9be170737859d3511b', 'review_creation_date__3': '2017-04-21 22:02:06', 'False__3': 3, 'review_comment_title__3': None, 'review_id__3': 'e64fb393e7b32834bb789ff8bb30750e', 'review_score__3': 5, 'review_comment_message__4': 'Parabns lojas lannister adorei comprar pela Internet seguro e prtico Parabns a todos feliz Pscoa', 'order_id__4': '8e6bfb81e283fa7e4f11123a3fb894f1', 'review_creation_date__4': '2018-03-02 10:26:53', 'False__4': 4, 'review_comment_title__4': None, 'review_id__4': 'f7c4243c7fe1938f181bec41a392bdeb', 'review_score__4': 5, 'review_comment_message__5': None, 'order_id__5': 'b18dcdf73be66366873cd26c5724d1dc', 'review_creation_date__5': '2018-04-16 00:39:37', 'False__5': 5, 'review_comment_title__5': None, 'review_id__5': '15197aa66ff4d0650b5434f1b46cda19', 'review_score__5': 1, 'review_comment_message__6': None, 'order_id__6': 'e48aa0d2dcec3a2e87348811bcfdf22b', 'review_creation_date__6': '2017-07-18 19:30:34', 'False__6': 6, 'review_comment_title__6': None, 'review_id__6': '07f9bee5d1b850860defd761afa7ff16', 'review_score__6': 5, 'review_comment_message__7': None ... 6900 parameters truncated ... 'review_score__992': 5, 'review_comment_message__993': None, 'order_id__993': '9d244b9671e094280e0da0b5edec38bb', 'review_creation_date__993': '2018-04-13 13:03:21', 'False__993': 993, 'review_comment_title__993': None, 'review_id__993': '6e6dbad466c0eef2b679927dfe89c052', 'review_score__993': 4, 'review_comment_message__994': None, 'order_id__994': '3b42ad87f3292fab60e143988d332da1', 'review_creation_date__994': '2018-03-17 12:18:46', 'False__994': 994, 'review_comment_title__994': None, 'review_id__994': '0a354009b25a2fbe0b25a6dd5c2a00ac', 'review_score__994': 5, 'review_comment_message__995': 'O produto no corresponde ao que eu comprei, a pelcula  muito menor que a tela do celular e no cobre toda a tela.', 'order_id__995': '286a461fcd1b94e24227817fa93f8a57', 'review_creation_date__995': '2018-03-23 18:24:18', 'False__995': 995, 'review_comment_title__995': None, 'review_id__995': 'affce0d83d9e8f6af570bc097c2e424f', 'review_score__995': 2, 'review_comment_message__996': 'produto conforme anunciado, e veio antes do prazo...perfeito', 'order_id__996': '9e7752c172e3994115a2cd609a18de29', 'review_creation_date__996': '2017-09-12 20:58:07', 'False__996': 996, 'review_comment_title__996': None, 'review_id__996': 'ca5bc3c72f83c6fb95f7f72b290a492c', 'review_score__996': 5, 'review_comment_message__997': 'Produto bom e entregue antes do previsto.', 'order_id__997': '4ab8b7a8e23908984157974ae4ad6436', 'review_creation_date__997': '2018-06-04 19:53:33', 'False__997': 997, 'review_comment_title__997': 'Produto entregue', 'review_id__997': '4d59d6249215713bfda42353af53f255', 'review_score__997': 4, 'review_comment_message__998': 'Ainda no usei em nenhuma viagem, mas parece ser muito boa.', 'order_id__998': 'b8615aa7e6248212cab23e120279acf2', 'review_creation_date__998': '2018-06-17 14:05:57', 'False__998': 998, 'review_comment_title__998': 'Boa', 'review_id__998': 'eaeafb542d4447da454cf68e302ae2bf', 'review_score__998': 4, 'review_comment_message__999': None, 'order_id__999': 'e1410714b40ecb7735ebc3f823d60745', 'review_creation_date__999': '2018-08-22 02:00:13', 'False__999': 999, 'review_comment_title__999': None, 'review_id__999': '2282d9d2a99fa789b0eb9843cfeab97e', 'review_score__999': 4}]
(Background on this error at: https://sqlalche.me/e/20/f405)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\Users\LENOVO THINKPAD\Documents\Github\Pacmann---Data-Storage_-Warehouse--Mart---Lake\mentoring 2\olist-dwh-project\pipeline\load.py", line 226, in run
    schema='public')
Exception: Failed Load Tables To olist-dwh-public

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 210, in run
    new_deps = self._run_get_new_deps()
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 138, in _run_get_new_deps
    task_gen = self.task.run()
               ^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\Documents\Github\Pacmann---Data-Storage_-Warehouse--Mart---Lake\mentoring 2\olist-dwh-project\pipeline\load.py", line 294, in run
    summary = pd.DataFrame(summary_data)
Exception: Failed Load Tables To DWH
2025-06-08 13:37:13,264 - DEBUG - 1 running tasks, waiting for next task to finish
2025-06-08 13:37:13,269 - INFO - Informed scheduler that task   Load__99914b932b   has status   FAILED
2025-06-08 13:37:13,269 - DEBUG - Asking scheduler for work...
2025-06-08 13:37:13,269 - DEBUG - Done
2025-06-08 13:37:13,269 - DEBUG - There are no more tasks to run at this time
2025-06-08 13:37:13,278 - DEBUG - There are 2 pending tasks possibly being run by other workers
2025-06-08 13:37:13,279 - DEBUG - There are 2 pending tasks unique to this worker
2025-06-08 13:37:13,282 - DEBUG - There are 2 pending tasks last scheduled by this worker
2025-06-08 13:37:13,288 - INFO - Worker Worker(salt=270523053, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=21524) was stopped. Shutting down Keep-Alive thread
2025-06-08 13:37:13,313 - INFO - 
===== Luigi Execution Summary =====

Scheduled 3 tasks of which:
* 1 complete ones were encountered:
    - 1 Extract()
* 1 failed:
    - 1 Load()
* 1 were left pending, among these:
    * 1 had failed dependencies:
        - 1 Transform()

This progress looks :( because there were failed tasks

===== Luigi Execution Summary =====

2025-06-08 13:39:03,164 - INFO - logging already configured
2025-06-08 13:39:03,168 - DEBUG - Checking if Extract() is complete
2025-06-08 13:39:03,171 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2025-06-08 13:39:03,172 - DEBUG - Checking if Load() is complete
2025-06-08 13:39:03,174 - INFO - Informed scheduler that task   Load__99914b932b   has status   DONE
2025-06-08 13:39:03,175 - DEBUG - Checking if Transform() is complete
2025-06-08 13:39:03,178 - DEBUG - Checking if Load() is complete
2025-06-08 13:39:03,180 - INFO - Informed scheduler that task   Transform__99914b932b   has status   PENDING
2025-06-08 13:39:03,182 - INFO - Informed scheduler that task   Load__99914b932b   has status   DONE
2025-06-08 13:39:03,184 - INFO - Done scheduling tasks
2025-06-08 13:39:03,184 - INFO - Running Worker with 1 processes
2025-06-08 13:39:03,187 - DEBUG - Asking scheduler for work...
2025-06-08 13:39:03,187 - DEBUG - Pending tasks: 1
2025-06-08 13:39:03,187 - INFO - [pid 21524] Worker Worker(salt=694592724, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=21524) running   Transform()
2025-06-08 13:39:03,194 - INFO - Connect to DWH - SUCCESS
2025-06-08 13:39:03,199 - INFO - Read Transform Query - SUCCESS
2025-06-08 13:39:03,199 - INFO - ==================================STARTING TRANSFROM DATA=======================================
2025-06-08 13:39:03,366 - INFO - Transform to 'dwh.dim_geolocation' - SUCCESS
2025-06-08 13:39:03,378 - INFO - Transform to 'dwh.dim_product_category' - SUCCESS
2025-06-08 13:39:03,388 - INFO - Transform to 'dwh.dim_sellers' - SUCCESS
2025-06-08 13:39:03,791 - INFO - Transform to 'dwh.dim_customers' - SUCCESS
2025-06-08 13:39:03,792 - ERROR - Transform to All Dimensions and Fact Tables - FAILED
2025-06-08 13:39:03,794 - ERROR - Transform Tables - FAILED
2025-06-08 13:39:03,794 - ERROR - [pid 21524] Worker Worker(salt=694592724, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=21524) failed    Transform()
Traceback (most recent call last):
  File "c:\Users\LENOVO THINKPAD\Documents\Github\Pacmann---Data-Storage_-Warehouse--Mart---Lake\mentoring 2\olist-dwh-project\pipeline\transform.py", line 128, in run
NameError: name 'dim_product_query' is not defined. Did you mean: 'dim_products_query'?

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 210, in run
    new_deps = self._run_get_new_deps()
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 138, in _run_get_new_deps
    task_gen = self.task.run()
               ^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\Documents\Github\Pacmann---Data-Storage_-Warehouse--Mart---Lake\mentoring 2\olist-dwh-project\pipeline\transform.py", line 192, in run
    logging.error("Transform Tables - FAILED")
Exception: Failed Transforming Tables
2025-06-08 13:39:03,827 - DEBUG - 1 running tasks, waiting for next task to finish
2025-06-08 13:39:03,832 - INFO - Informed scheduler that task   Transform__99914b932b   has status   FAILED
2025-06-08 13:39:03,833 - DEBUG - Asking scheduler for work...
2025-06-08 13:39:03,834 - DEBUG - Done
2025-06-08 13:39:03,836 - DEBUG - There are no more tasks to run at this time
2025-06-08 13:39:03,837 - DEBUG - There are 1 pending tasks possibly being run by other workers
2025-06-08 13:39:03,838 - DEBUG - There are 1 pending tasks unique to this worker
2025-06-08 13:39:03,841 - DEBUG - There are 1 pending tasks last scheduled by this worker
2025-06-08 13:39:03,842 - INFO - Worker Worker(salt=694592724, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=21524) was stopped. Shutting down Keep-Alive thread
2025-06-08 13:39:03,848 - INFO - 
===== Luigi Execution Summary =====

Scheduled 3 tasks of which:
* 2 complete ones were encountered:
    - 1 Extract()
    - 1 Load()
* 1 failed:
    - 1 Transform()

This progress looks :( because there were failed tasks

===== Luigi Execution Summary =====

2025-06-08 13:39:55,840 - INFO - logging already configured
2025-06-08 13:39:55,844 - DEBUG - Checking if Extract() is complete
2025-06-08 13:39:55,847 - INFO - Informed scheduler that task   Extract__99914b932b   has status   PENDING
2025-06-08 13:39:55,848 - DEBUG - Checking if Load() is complete
2025-06-08 13:39:55,850 - DEBUG - Checking if Extract() is complete
2025-06-08 13:39:55,851 - INFO - Informed scheduler that task   Load__99914b932b   has status   PENDING
2025-06-08 13:39:55,852 - INFO - Informed scheduler that task   Extract__99914b932b   has status   PENDING
2025-06-08 13:39:55,853 - INFO - Done scheduling tasks
2025-06-08 13:39:55,854 - INFO - Running Worker with 1 processes
2025-06-08 13:39:55,855 - DEBUG - Asking scheduler for work...
2025-06-08 13:39:55,856 - DEBUG - Pending tasks: 2
2025-06-08 13:39:55,858 - INFO - [pid 21524] Worker Worker(salt=7747426551, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=21524) running   Extract()
2025-06-08 13:39:55,859 - ERROR - [pid 21524] Worker Worker(salt=7747426551, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=21524) failed    Extract()
Traceback (most recent call last):
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 210, in run
    new_deps = self._run_get_new_deps()
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\.conda\envs\conda_general\Lib\site-packages\luigi\worker.py", line 138, in _run_get_new_deps
    task_gen = self.task.run()
               ^^^^^^^^^^^^^^^
  File "c:\Users\LENOVO THINKPAD\Documents\Github\Pacmann---Data-Storage_-Warehouse--Mart---Lake\mentoring 2\olist-dwh-project\pipeline\extract.py", line 43, in run
    # Configure logging
                        
AttributeError: 'list' object has no attribute 'path'
2025-06-08 13:39:55,863 - DEBUG - 1 running tasks, waiting for next task to finish
2025-06-08 13:39:55,868 - INFO - Informed scheduler that task   Extract__99914b932b   has status   FAILED
2025-06-08 13:39:55,870 - DEBUG - Asking scheduler for work...
2025-06-08 13:39:55,871 - DEBUG - Done
2025-06-08 13:39:55,873 - DEBUG - There are no more tasks to run at this time
2025-06-08 13:39:55,874 - DEBUG - There are 2 pending tasks possibly being run by other workers
2025-06-08 13:39:55,875 - DEBUG - There are 2 pending tasks unique to this worker
2025-06-08 13:39:55,876 - DEBUG - There are 2 pending tasks last scheduled by this worker
2025-06-08 13:39:55,879 - INFO - Worker Worker(salt=7747426551, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=21524) was stopped. Shutting down Keep-Alive thread
2025-06-08 13:39:55,899 - INFO - 
===== Luigi Execution Summary =====

Scheduled 2 tasks of which:
* 1 failed:
    - 1 Extract()
* 1 were left pending, among these:
    * 1 had failed dependencies:
        - 1 Load()

This progress looks :( because there were failed tasks

===== Luigi Execution Summary =====

2025-06-08 13:40:01,762 - INFO - logging already configured
2025-06-08 13:40:01,765 - DEBUG - Checking if Extract() is complete
2025-06-08 13:40:01,768 - INFO - Informed scheduler that task   Extract__99914b932b   has status   PENDING
2025-06-08 13:40:01,770 - INFO - Done scheduling tasks
2025-06-08 13:40:01,771 - INFO - Running Worker with 1 processes
2025-06-08 13:40:01,773 - DEBUG - Asking scheduler for work...
2025-06-08 13:40:01,774 - DEBUG - Pending tasks: 1
2025-06-08 13:40:01,776 - INFO - [pid 21524] Worker Worker(salt=6265168950, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=21524) running   Extract()
2025-06-08 13:40:01,777 - INFO - ==================================STARTING EXTRACT DATA=======================================
2025-06-08 13:40:02,036 - INFO - EXTRACT 'public.geolocation' - SUCCESS.
2025-06-08 13:40:02,046 - INFO - EXTRACT 'public.product_category_name_translation' - SUCCESS.
2025-06-08 13:40:02,073 - INFO - EXTRACT 'public.sellers' - SUCCESS.
2025-06-08 13:40:03,075 - INFO - EXTRACT 'public.customers' - SUCCESS.
2025-06-08 13:40:03,508 - INFO - EXTRACT 'public.products' - SUCCESS.
2025-06-08 13:40:04,655 - INFO - EXTRACT 'public.orders' - SUCCESS.
2025-06-08 13:40:06,033 - INFO - EXTRACT 'public.order_items' - SUCCESS.
2025-06-08 13:40:07,010 - INFO - EXTRACT 'public.order_payments' - SUCCESS.
2025-06-08 13:40:08,118 - INFO - EXTRACT 'public.order_reviews' - SUCCESS.
2025-06-08 13:40:08,118 - INFO - Extract All Tables From Sources - SUCCESS
2025-06-08 13:40:08,120 - INFO - ==================================ENDING EXTRACT DATA=======================================
2025-06-08 13:40:08,136 - INFO - [pid 21524] Worker Worker(salt=6265168950, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=21524) done      Extract()
2025-06-08 13:40:08,139 - DEBUG - 1 running tasks, waiting for next task to finish
2025-06-08 13:40:08,141 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2025-06-08 13:40:08,143 - DEBUG - Asking scheduler for work...
2025-06-08 13:40:08,144 - DEBUG - Done
2025-06-08 13:40:08,148 - DEBUG - There are no more tasks to run at this time
2025-06-08 13:40:08,154 - INFO - Worker Worker(salt=6265168950, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=21524) was stopped. Shutting down Keep-Alive thread
2025-06-08 13:40:08,161 - INFO - 
===== Luigi Execution Summary =====

Scheduled 1 tasks of which:
* 1 ran successfully:
    - 1 Extract()

This progress looks :) because there were no failed tasks or missing dependencies

===== Luigi Execution Summary =====

2025-06-08 13:40:11,407 - INFO - logging already configured
2025-06-08 13:40:11,410 - DEBUG - Checking if Extract() is complete
2025-06-08 13:40:11,413 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2025-06-08 13:40:11,415 - DEBUG - Checking if Load() is complete
2025-06-08 13:40:11,417 - DEBUG - Checking if Extract() is complete
2025-06-08 13:40:11,419 - INFO - Informed scheduler that task   Load__99914b932b   has status   PENDING
2025-06-08 13:40:11,420 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2025-06-08 13:40:11,421 - INFO - Done scheduling tasks
2025-06-08 13:40:11,422 - INFO - Running Worker with 1 processes
2025-06-08 13:40:11,423 - DEBUG - Asking scheduler for work...
2025-06-08 13:40:11,424 - DEBUG - Pending tasks: 1
2025-06-08 13:40:11,426 - INFO - [pid 21524] Worker Worker(salt=4202338360, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=21524) running   Load()
2025-06-08 13:40:11,431 - INFO - Read Load Query - SUCCESS
2025-06-08 13:40:13,286 - INFO - Read Extracted Data - SUCCESS
2025-06-08 13:40:13,288 - INFO - Connect to olist-dwh - SUCCESS
2025-06-08 13:40:13,480 - INFO - Truncate `public` Schema in olist-dwh - SUCCESS
2025-06-08 13:40:13,480 - INFO - ==================================STARTING LOAD DATA=======================================
2025-06-08 13:40:55,441 - INFO - LOAD All Tables To olist-dwh-public - SUCCESS
2025-06-08 13:41:02,508 - INFO - LOAD All Tables To DWH-Staging - SUCCESS
2025-06-08 13:41:02,512 - INFO - ==================================ENDING LOAD DATA=======================================
2025-06-08 13:41:02,554 - INFO - [pid 21524] Worker Worker(salt=4202338360, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=21524) done      Load()
2025-06-08 13:41:02,556 - DEBUG - 1 running tasks, waiting for next task to finish
2025-06-08 13:41:02,558 - INFO - Informed scheduler that task   Load__99914b932b   has status   DONE
2025-06-08 13:41:02,560 - DEBUG - Asking scheduler for work...
2025-06-08 13:41:02,563 - DEBUG - Done
2025-06-08 13:41:02,564 - DEBUG - There are no more tasks to run at this time
2025-06-08 13:41:02,566 - INFO - Worker Worker(salt=4202338360, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=21524) was stopped. Shutting down Keep-Alive thread
2025-06-08 13:41:02,574 - INFO - 
===== Luigi Execution Summary =====

Scheduled 2 tasks of which:
* 1 complete ones were encountered:
    - 1 Extract()
* 1 ran successfully:
    - 1 Load()

This progress looks :) because there were no failed tasks or missing dependencies

===== Luigi Execution Summary =====

2025-06-08 13:41:32,430 - INFO - logging already configured
2025-06-08 13:41:32,433 - DEBUG - Checking if Extract() is complete
2025-06-08 13:41:32,435 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2025-06-08 13:41:32,437 - DEBUG - Checking if Load() is complete
2025-06-08 13:41:32,439 - INFO - Informed scheduler that task   Load__99914b932b   has status   DONE
2025-06-08 13:41:32,441 - DEBUG - Checking if Transform() is complete
2025-06-08 13:41:32,444 - DEBUG - Checking if Load() is complete
2025-06-08 13:41:32,445 - INFO - Informed scheduler that task   Transform__99914b932b   has status   PENDING
2025-06-08 13:41:32,447 - INFO - Informed scheduler that task   Load__99914b932b   has status   DONE
2025-06-08 13:41:32,448 - INFO - Done scheduling tasks
2025-06-08 13:41:32,448 - INFO - Running Worker with 1 processes
2025-06-08 13:41:32,451 - DEBUG - Asking scheduler for work...
2025-06-08 13:41:32,452 - DEBUG - Pending tasks: 1
2025-06-08 13:41:32,453 - INFO - [pid 21524] Worker Worker(salt=8244291368, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=21524) running   Transform()
2025-06-08 13:41:32,457 - INFO - Connect to DWH - SUCCESS
2025-06-08 13:41:32,486 - INFO - Read Transform Query - SUCCESS
2025-06-08 13:41:32,486 - INFO - ==================================STARTING TRANSFROM DATA=======================================
2025-06-08 13:41:32,694 - INFO - Transform to 'dwh.dim_geolocation' - SUCCESS
2025-06-08 13:41:32,700 - INFO - Transform to 'dwh.dim_product_category' - SUCCESS
2025-06-08 13:41:32,720 - INFO - Transform to 'dwh.dim_sellers' - SUCCESS
2025-06-08 13:41:33,149 - INFO - Transform to 'dwh.dim_customers' - SUCCESS
2025-06-08 13:41:33,257 - INFO - Transform to 'dwh.dim_products' - SUCCESS
2025-06-08 13:41:33,967 - INFO - Transform to 'dwh.fact_orders_comprehensive' - SUCCESS
2025-06-08 13:41:33,979 - INFO - Transform to 'dwh.fact_reviews_sentiment' - SUCCESS
2025-06-08 13:41:33,988 - INFO - Transform to 'dwh.fact_daily_periodicals_order_trends' - SUCCESS
2025-06-08 13:42:49,410 - INFO - Transform to 'dwh.fact_accumulating_snapshot_logistic_performance' - SUCCESS
2025-06-08 13:42:49,416 - INFO - Transform to All Dimensions and Fact Tables - SUCCESS
2025-06-08 13:42:49,420 - INFO - ==================================ENDING TRANSFROM DATA=======================================
2025-06-08 13:42:49,420 - INFO - [pid 21524] Worker Worker(salt=8244291368, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=21524) done      Transform()
2025-06-08 13:42:49,422 - DEBUG - 1 running tasks, waiting for next task to finish
2025-06-08 13:42:49,424 - INFO - Informed scheduler that task   Transform__99914b932b   has status   DONE
2025-06-08 13:42:49,425 - DEBUG - Asking scheduler for work...
2025-06-08 13:42:49,426 - DEBUG - Done
2025-06-08 13:42:49,429 - DEBUG - There are no more tasks to run at this time
2025-06-08 13:42:49,430 - INFO - Worker Worker(salt=8244291368, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=21524) was stopped. Shutting down Keep-Alive thread
2025-06-08 13:42:49,436 - INFO - 
===== Luigi Execution Summary =====

Scheduled 3 tasks of which:
* 2 complete ones were encountered:
    - 1 Extract()
    - 1 Load()
* 1 ran successfully:
    - 1 Transform()

This progress looks :) because there were no failed tasks or missing dependencies

===== Luigi Execution Summary =====

2025-06-08 13:43:09,372 - INFO - logging already configured
2025-06-08 13:43:09,375 - DEBUG - Checking if Extract() is complete
2025-06-08 13:43:09,378 - INFO - Informed scheduler that task   Extract__99914b932b   has status   DONE
2025-06-08 13:43:09,380 - DEBUG - Checking if Load() is complete
2025-06-08 13:43:09,382 - INFO - Informed scheduler that task   Load__99914b932b   has status   DONE
2025-06-08 13:43:09,383 - DEBUG - Checking if Transform() is complete
2025-06-08 13:43:09,386 - INFO - Informed scheduler that task   Transform__99914b932b   has status   DONE
2025-06-08 13:43:09,386 - INFO - Done scheduling tasks
2025-06-08 13:43:09,388 - INFO - Running Worker with 1 processes
2025-06-08 13:43:09,389 - DEBUG - Asking scheduler for work...
2025-06-08 13:43:09,390 - DEBUG - Done
2025-06-08 13:43:09,393 - DEBUG - There are no more tasks to run at this time
2025-06-08 13:43:09,397 - INFO - Worker Worker(salt=559604840, workers=1, host=LAPTOP-H2OPKO7T, username=LENOVO THINKPAD, pid=21524) was stopped. Shutting down Keep-Alive thread
2025-06-08 13:43:09,405 - INFO - 
===== Luigi Execution Summary =====

Scheduled 3 tasks of which:
* 3 complete ones were encountered:
    - 1 Extract()
    - 1 Load()
    - 1 Transform()

Did not run any tasks
This progress looks :) because there were no failed tasks or missing dependencies

===== Luigi Execution Summary =====

